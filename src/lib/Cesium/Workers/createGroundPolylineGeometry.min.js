/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
/**
 * @license
 *
 * Grauw URI utilities
 *
 * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
 *
 * @author Laurens Holst (http://www.grauw.nl/)
 *
 *   Copyright 2012 Laurens Holst
 *
 *   Licensed under the Apache License, Version 2.0 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 *
 */

/**
  @license
  when.js - https://github.com/cujojs/when

  MIT License (c) copyright B Cavalier & J Hann

 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 1.7.1
 */

/**
@license
mersenne-twister.js - https://gist.github.com/banksean/300494

   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
   All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

     3. The names of its contributors may not be used to endorse or promote
        products derived from this software without specific prior written
        permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/**
@license
sprintf.js from the php.js project - https://github.com/kvz/phpjs
Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

php.js is copyright 2012 Kevin van Zonneveld.

Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
(http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
(http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
(https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
L. Rodrigues (http://www.jsfromhell.com), Ash Searle
(http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
(http://webdevhobo.blogspot.com/), marrtins, GeekFG
(http://geekfg.blogspot.com), Andrea Giammarchi
(http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
(http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
Marc Palau, Martin
(http://www.erlenwiese.de/), Breaking Par Consulting Inc
(http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
Chris, Mirek Slugen, saulius, Alfonso Jimenez
(http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
Ariede (http://caioariede.com), Robin, Kankrelune
(http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
(http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
David, Aman Gupta, Michael White, Public Domain
(http://www.json.org/json2.js), Steven Levithan
(http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
(http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
(http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
(http://javascript.crockford.com), madipta, Slawomir Kaniecki,
ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
(http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
(https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
(http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
(http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
(http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
(http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
(http://yass.meetcweb.com), Peter-Paul Koch
(http://www.quirksmode.org/js/beat.html), Olivier Louvignes
(http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
(http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
(http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
(http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
(http://www.premasolutions.com/), Philippe Jausions
(http://pear.php.net/user/jausions), Aidan Lister
(http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
strcmp, Taras Bogach, jpfle, Alexander Ermolaev
(http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
(http://www.pedrotainha.com), James, Arnout Kazemier
(http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
(http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
(http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
(http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
Russell Walker (http://www.nbill.co.uk/), Jamie Beck
(http://www.terabit.ca/), setcookie, Michael, YUI Library:
http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
http://hacks.bluesmoon.info/strftime/strftime.js, Ben
(http://benblume.co.uk/), DtTvB
(http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
(http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
Bryan

Licensed under the MIT (MIT-LICENSE.txt) license.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/

!function(){define("Core/defined",[],function(){"use strict";function e(e){return void 0!==e&&null!==e}return e}),define("Core/DeveloperError",["./defined"],function(e){"use strict";function t(e){this.name="DeveloperError",this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&(t.prototype=Object.create(Error.prototype),t.prototype.constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t.throwInstantiationError=function(){throw new t("This function defines an interface and should not be called directly.")},t}),define("ThirdParty/Uri",[],function(){function e(t){if(t instanceof e)this.scheme=t.scheme,this.authority=t.authority,this.path=t.path,this.query=t.query,this.fragment=t.fragment;else if(t){var n=r.exec(t);this.scheme=n[1],this.authority=n[2],this.path=n[3],this.query=n[4],this.fragment=n[5]}}function t(e){var t=unescape(e);return a.test(t)?t:e.toUpperCase()}function n(e,t,n,r){return(t||"")+n.toLowerCase()+(r||"")}e.prototype.scheme=null,e.prototype.authority=null,e.prototype.path="",e.prototype.query=null,e.prototype.fragment=null;var r=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");e.prototype.getScheme=function(){return this.scheme},e.prototype.getAuthority=function(){return this.authority},e.prototype.getPath=function(){return this.path},e.prototype.getQuery=function(){return this.query},e.prototype.getFragment=function(){return this.fragment},e.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},e.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},e.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},e.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(o,n).replace(i,t)),this.path&&(this.path=this.path.replace(i,t)),this.query&&(this.query=this.query.replace(i,t)),this.fragment&&(this.fragment=this.fragment.replace(i,t))};var i=/%[0-9a-z]{2}/gi,a=/[a-zA-Z0-9\-\._~]/,o=/(.*@)?([^@:]*)(:.*)?/;return e.prototype.resolve=function(t){var n=new e;return this.scheme?(n.scheme=this.scheme,n.authority=this.authority,n.path=this.path,n.query=this.query):(n.scheme=t.scheme,this.authority?(n.authority=this.authority,n.path=this.path,n.query=this.query):(n.authority=t.authority,""==this.path?(n.path=t.path,n.query=this.query||t.query):("/"==this.path.charAt(0)?(n.path=this.path,n.removeDotSegments()):(t.authority&&""==t.path?n.path="/"+this.path:n.path=t.path.substring(0,t.path.lastIndexOf("/")+1)+this.path,n.removeDotSegments()),n.query=this.query))),n.fragment=this.fragment,n},e.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),n=[],r=""==t[0];r&&t.shift();for(""==t[0]&&t.shift();t.length;)e=t.shift(),".."==e?n.pop():"."!=e&&n.push(e);"."!=e&&".."!=e||n.push(""),r&&n.unshift(""),this.path=n.join("/")},e.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},e}),define("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;return e(t)||(t=function(e){return e}),t}),define("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){return void 0!==e&&null!==e?e:t}return t.EMPTY_OBJECT=e({}),t}),define("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";function i(e,t){var n;return"undefined"!=typeof document&&(n=document),i._implementation(e,t,n)}return i._implementation=function(r,i,a){if(!n(i)){if(void 0===a)return r;i=t(a.baseURI,a.location.href)}var o=new e(i);return new e(r).resolve(o).toString()},i}),function(e){"use strict";e("ThirdParty/when",[],function(){function e(e,n,r,i){return t(e).then(n,r,i)}function t(e){var t,n;return e instanceof r?t=e:s(e)?(n=o(),e.then(function(e){n.resolve(e)},function(e){n.reject(e)},function(e){n.progress(e)}),t=n.promise):t=i(e),t}function n(t){return e(t,a)}function r(e){this.then=e}function i(e){return new r(function(n){try{return t(n?n(e):e)}catch(e){return a(e)}})}function a(e){return new r(function(n,r){try{return r?t(r(e)):a(e)}catch(e){return a(e)}})}function o(){function e(e,t,n){return d(e,t,n)}function n(e){return h(e)}function i(e){return h(a(e))}function s(e){return m(e)}var u,c,l,f,d,m,h;return c=new r(e),u={then:e,resolve:n,reject:i,progress:s,promise:c,resolver:{resolve:n,reject:i,progress:s}},l=[],f=[],d=function(e,t,n){var r,i;return r=o(),i="function"==typeof n?function(e){try{r.progress(n(e))}catch(e){r.progress(e)}}:function(e){r.progress(e)},l.push(function(n){n.then(e,t).then(r.resolve,r.reject,i)}),f.push(i),r.promise},m=function(e){return p(f,e),e},h=function(e){return e=t(e),d=e.then,h=t,m=v,p(l,e),f=l=T,e},u}function s(e){return e&&"function"==typeof e.then}function u(t,n,r,i,a){return _(2,arguments),e(t,function(t){function s(e){p(e)}function u(e){h(e)}var c,l,f,d,m,h,p,_,g,y;if(g=t.length>>>0,c=Math.max(0,Math.min(n,g)),f=[],l=g-c+1,d=[],m=o(),c)for(_=m.progress,p=function(e){d.push(e),--l||(h=p=v,m.reject(d))},h=function(e){f.push(e),--c||(h=p=v,m.resolve(f))},y=0;y<g;++y)y in t&&e(t[y],u,s,_);else m.resolve(f);return m.then(r,i,a)})}function c(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return u(e,1,i,n,r)}function l(e,t,n,r){return _(1,arguments),d(e,g).then(t,n,r)}function f(){return d(arguments,g)}function d(t,n){return e(t,function(t){var r,i,a,s,u,c;if(a=i=t.length>>>0,r=[],c=o(),a)for(s=function(t,i){e(t,n).then(function(e){r[i]=e,--a||c.resolve(r)},c.reject)},u=0;u<i;u++)u in t?s(t[u],u):--a;else c.resolve(r);return c.promise})}function m(t,n){var r=E.call(arguments,1);return e(t,function(t){var i;return i=t.length,r[0]=function(t,r,a){return e(t,function(t){return e(r,function(e){return n(t,e,a,i)})})},y.apply(t,r)})}function h(t,n,r){var i=arguments.length>2;return e(t,function(e){return e=i?r:e,n.resolve(e),e},function(e){return n.reject(e),a(e)},n.progress)}function p(e,t){for(var n,r=0;n=e[r++];)n(t)}function _(e,t){for(var n,r=t.length;r>e;)if(null!=(n=t[--r])&&"function"!=typeof n)throw new Error("arg "+r+" must be a function")}function v(){}function g(e){return e}var y,E,T;return e.defer=o,e.resolve=t,e.reject=n,e.join=f,e.all=l,e.map=d,e.reduce=m,e.any=c,e.some=u,e.chain=h,e.isPromise=s,r.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(T,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return l(t,function(t){return e.apply(T,t)})})}},E=[].slice,y=[].reduce||function(e){var t,n,r,i,a;if(a=0,t=Object(this),i=t.length>>>0,n=arguments,n.length<=1)for(;;){if(a in t){r=t[a++];break}if(++a>=i)throw new TypeError}else r=n[1];for(;a<i;++a)a in t&&(r=e(r,t[a],a,t));return r},e})}("function"==typeof define&&define.amd?define:function(e){"object"==typeof exports?module.exports=e():this.when=e()}),define("Core/appendForwardSlash",[],function(){"use strict";function e(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}return e}),define("Core/Check",["./defined","./DeveloperError"],function(e,t){"use strict";function n(e){return e+" is required, actual value was undefined"}function r(e,t,n){return"Expected "+n+" to be typeof "+t+", actual typeof was "+e}var i={};return i.typeOf={},i.defined=function(r,i){if(!e(i))throw new t(n(r))},i.typeOf.func=function(e,n){if("function"!=typeof n)throw new t(r(typeof n,"function",e))},i.typeOf.string=function(e,n){if("string"!=typeof n)throw new t(r(typeof n,"string",e))},i.typeOf.number=function(e,n){if("number"!=typeof n)throw new t(r(typeof n,"number",e))},i.typeOf.number.lessThan=function(e,n,r){if(i.typeOf.number(e,n),n>=r)throw new t("Expected "+e+" to be less than "+r+", actual value was "+n)},i.typeOf.number.lessThanOrEquals=function(e,n,r){if(i.typeOf.number(e,n),n>r)throw new t("Expected "+e+" to be less than or equal to "+r+", actual value was "+n)},i.typeOf.number.greaterThan=function(e,n,r){if(i.typeOf.number(e,n),n<=r)throw new t("Expected "+e+" to be greater than "+r+", actual value was "+n)},i.typeOf.number.greaterThanOrEquals=function(e,n,r){if(i.typeOf.number(e,n),n<r)throw new t("Expected "+e+" to be greater than or equal to"+r+", actual value was "+n)},i.typeOf.object=function(e,n){if("object"!=typeof n)throw new t(r(typeof n,"object",e))},i.typeOf.bool=function(e,n){if("boolean"!=typeof n)throw new t(r(typeof n,"boolean",e))},i.typeOf.number.equals=function(e,n,r,a){if(i.typeOf.number(e,r),i.typeOf.number(n,a),r!==a)throw new t(e+" must be equal to "+n+", the actual values are "+r+" and "+a)},i}),define("Core/clone",["./defaultValue"],function(e){"use strict";function t(n,r){if(null===n||"object"!=typeof n)return n;r=e(r,!1);var i=new n.constructor;for(var a in n)if(n.hasOwnProperty(a)){var o=n[a];r&&(o=t(o,r)),i[a]=o}return i}return t}),define("Core/combine",["./defaultValue","./defined"],function(e,t){"use strict";function n(r,i,a){a=e(a,!1);var o,s,u,c={},l=t(r),f=t(i);if(l)for(o in r)r.hasOwnProperty(o)&&(s=r[o],f&&a&&"object"==typeof s&&i.hasOwnProperty(o)?(u=i[o],c[o]="object"==typeof u?n(s,u,a):s):c[o]=s);if(f)for(o in i)i.hasOwnProperty(o)&&!c.hasOwnProperty(o)&&(u=i[o],c[o]=u);return c}return n}),define("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),n=Object.defineProperties;return t&&e(n)||(n=function(e){return e}),n}),define("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(n,r){t(i[n])||(i[n]=!0,console.warn(e(r,n)))}var i={};return r.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",r.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",r}),define("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(e,t,n){"use strict";function r(e,t){n(e,t)}return r}),define("Core/Fullscreen",["./defined","./defineProperties"],function(e,t){"use strict";var n,r={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},i={};return t(i,{element:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenElement]}},changeEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenchange}},errorEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenerror}},enabled:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenEnabled]}},fullscreen:{get:function(){if(i.supportsFullscreen())return null!==i.element}}}),i.supportsFullscreen=function(){if(e(n))return n;n=!1;var t=document.body;if("function"==typeof t.requestFullscreen)return r.requestFullscreen="requestFullscreen",r.exitFullscreen="exitFullscreen",r.fullscreenEnabled="fullscreenEnabled",r.fullscreenElement="fullscreenElement",r.fullscreenchange="fullscreenchange",r.fullscreenerror="fullscreenerror",n=!0;for(var i,a=["webkit","moz","o","ms","khtml"],o=0,s=a.length;o<s;++o){var u=a[o];i=u+"RequestFullscreen","function"==typeof t[i]?(r.requestFullscreen=i,n=!0):(i=u+"RequestFullScreen","function"==typeof t[i]&&(r.requestFullscreen=i,n=!0)),i=u+"ExitFullscreen","function"==typeof document[i]?r.exitFullscreen=i:(i=u+"CancelFullScreen","function"==typeof document[i]&&(r.exitFullscreen=i)),i=u+"FullscreenEnabled",void 0!==document[i]?r.fullscreenEnabled=i:(i=u+"FullScreenEnabled",void 0!==document[i]&&(r.fullscreenEnabled=i)),i=u+"FullscreenElement",void 0!==document[i]?r.fullscreenElement=i:(i=u+"FullScreenElement",void 0!==document[i]&&(r.fullscreenElement=i)),i=u+"fullscreenchange",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenChange"),r.fullscreenchange=i),i=u+"fullscreenerror",void 0!==document["on"+i]&&("ms"===u&&(i="MSFullscreenError"),r.fullscreenerror=i)}return n},i.requestFullscreen=function(e,t){i.supportsFullscreen()&&e[r.requestFullscreen]({vrDisplay:t})},i.exitFullscreen=function(){i.supportsFullscreen()&&document[r.exitFullscreen]()},i}),define("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,t,n){"use strict";function r(e){for(var t=e.split("."),n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}function i(){if(!t(T)&&(T=!1,!d())){var e=/ Chrome\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(T=!0,C=r(e[1]))}return T}function a(){return i()&&C}function o(){if(!t(S)&&(S=!1,!i()&&!d()&&/ Safari\/[\.0-9]+/.test(E.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(S=!0,A=r(e[1]))}return S}function s(){return o()&&A}function u(){if(!t(x)){x=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(E.userAgent);null!==e&&(x=!0,w=r(e[1]),w.isNightly=!!e[2])}return x}function c(){return u()&&w}function l(){if(!t(R)){R=!1;var e;"Microsoft Internet Explorer"===E.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(R=!0,b=r(e[1])):"Netscape"===E.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(E.userAgent))&&(R=!0,b=r(e[1]))}return R}function f(){return l()&&b}function d(){if(!t(I)){I=!1;var e=/ Edge\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(I=!0,O=r(e[1]))}return I}function m(){return d()&&O}function h(){if(!t(D)){D=!1;var e=/Firefox\/([\.0-9]+)/.exec(E.userAgent);null!==e&&(D=!0,P=r(e[1]))}return D}function p(){return t(M)||(M=/Windows/i.test(E.appVersion)),M}function _(){return h()&&P}function v(){return t(N)||(N="undefined"!=typeof PointerEvent&&(!t(E.pointerEnabled)||E.pointerEnabled)),N}function g(){if(!t(F)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var n=e.style.imageRendering;F=t(n)&&""!==n,F&&(z=n)}return F}function y(){return g()?z:void 0}var E;E="undefined"!=typeof navigator?navigator:{};var T,C,S,A,x,w,R,b,I,O,D,P,M,N,z,F,L=[];"undefined"!=typeof ArrayBuffer&&(L.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&L.push(Uint8ClampedArray),"undefined"!=typeof CanvasPixelArray&&L.push(CanvasPixelArray));var B={isChrome:i,chromeVersion:a,isSafari:o,safariVersion:s,isWebkit:u,webkitVersion:c,isInternetExplorer:l,internetExplorerVersion:f,isEdge:d,edgeVersion:m,isFirefox:h,firefoxVersion:_,isWindows:p,hardwareConcurrency:e(E.hardwareConcurrency,3),supportsPointerEvents:v,supportsImageRenderingPixelated:g,imageRenderingValue:y,typedArrayTypes:L};return B.supportsFullscreen=function(){return n.supportsFullscreen()},B.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},B.supportsWebWorkers=function(){return"undefined"!=typeof Worker},B.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly&&!B.isEdge()},B}),define("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(n,r){var i="",a=n.lastIndexOf("/");return-1!==a&&(i=n.substring(0,a+1)),r?(n=new e(n),t(n.query)&&(i+="?"+n.query),t(n.fragment)&&(i+="#"+n.fragment),i):i}return r}),define("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t){var n=new e(t);n.normalize();var r=n.path,i=r.lastIndexOf("/");return-1!==i&&(r=r.substr(i+1)),i=r.lastIndexOf("."),r=-1===i?"":r.substr(i+1)}return r}),define("Core/isBlobUri",["./Check"],function(e){"use strict";function t(e){return n.test(e)}var n=/^blob:/i;return t}),define("Core/isCrossOriginUrl",["./defined"],function(e){"use strict";function t(t){e(n)||(n=document.createElement("a")),n.href=window.location.href;var r=n.host,i=n.protocol;return n.href=t,n.href=n.href,i!==n.protocol||r!==n.host}var n;return t}),define("Core/isDataUri",["./Check"],function(e){"use strict";function t(e){return n.test(e)}var n=/^data:/i;return t}),define("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;return e(t)||(t=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t}),define("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";function r(e){var t="";for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=encodeURIComponent(r)+"=";if(n(i))for(var o=0,s=i.length;o<s;++o)t+=a+encodeURIComponent(i[o])+"&";else t+=a+encodeURIComponent(i)+"&"}return t=t.slice(0,-1)}return r}),define("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";function r(t){var r={};if(""===t)return r;for(var i=t.replace(/\+/g,"%20").split(/[&;]/),a=0,o=i.length;a<o;++a){var s=i[a].split("="),u=decodeURIComponent(s[0]),c=s[1];c=e(c)?decodeURIComponent(c):"";var l=r[u];"string"==typeof l?r[u]=[l,c]:n(l)?l.push(c):r[u]=c}return r}return r}),define("Core/RequestState",["../Core/freezeObject"],function(e){"use strict";return e({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5})}),define("Core/RequestType",["../Core/freezeObject"],function(e){"use strict";return e({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3})}),define("Core/Request",["./defaultValue","./defined","./RequestState","./RequestType"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT);var i=e(t.throttleByServer,!1),a=i||e(t.throttle,!1);this.url=t.url,this.requestFunction=t.requestFunction,this.cancelFunction=t.cancelFunction,this.priorityFunction=t.priorityFunction,this.priority=e(t.priority,0),this.throttle=a,this.throttleByServer=i,this.type=e(t.type,r.OTHER),this.serverKey=void 0,this.state=n.UNISSUED,this.deferred=void 0,this.cancelled=!1}return i.prototype.cancel=function(){this.cancelled=!0},i.prototype.clone=function(e){return t(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new i(this)},i}),define("Core/parseResponseHeaders",[],function(){"use strict";function e(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0;r<n.length;++r){var i=n[r],a=i.indexOf(": ");if(a>0){var o=i.substring(0,a),s=i.substring(a+2);t[o]=s}}return t}return e}),define("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(e,t){"use strict";function n(e,n,r){this.statusCode=e,this.response=n,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=t(this.responseHeaders))}return n.prototype.toString=function(){var t="Request has failed.";return e(this.statusCode)&&(t+=" Status Code: "+this.statusCode),t},n}),define("Core/Event",["./Check","./defined","./defineProperties"],function(e,t,n){"use strict";function r(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function i(e,t){return t-e}return n(r.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),r.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);var n=this;return function(){n.removeEventListener(e,t)}},r.prototype.removeEventListener=function(e,t){for(var n=this._listeners,r=this._scopes,i=-1,a=0;a<n.length;a++)if(n[a]===e&&r[a]===t){i=a;break}return-1!==i&&(this._insideRaiseEvent?(this._toRemove.push(i),n[i]=void 0,r[i]=void 0):(n.splice(i,1),r.splice(i,1)),!0)},r.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;var e,n=this._listeners,r=this._scopes,a=n.length;for(e=0;e<a;e++){var o=n[e];t(o)&&n[e].apply(r[e],arguments)}var s=this._toRemove;if((a=s.length)>0){for(s.sort(i),e=0;e<a;e++){var u=s[e];n.splice(u,1),r.splice(u,1)}s.length=0}this._insideRaiseEvent=!1},r}),define("Core/Heap",["./Check","./defaultValue","./defined","./defineProperties"],function(e,t,n,r){"use strict";function i(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function a(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return r(i.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),i.prototype.reserve=function(e){e=t(e,this._length),this._array.length=e},i.prototype.heapify=function(e){e=t(e,0);for(var n=this._length,r=this._comparator,i=this._array,o=-1,s=!0;s;){var u=2*(e+1),c=u-1;o=c<n&&r(i[c],i[e])<0?c:e,u<n&&r(i[u],i[o])<0&&(o=u),o!==e?(a(i,o,e),e=o):s=!1}},i.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},i.prototype.insert=function(e){var t=this._array,r=this._comparator,i=this._maximumLength,o=this._length++;for(o<t.length?t[o]=e:t.push(e);0!==o;){var s=Math.floor((o-1)/2);if(!(r(t[o],t[s])<0))break;a(t,o,s),o=s}var u;return n(i)&&this._length>i&&(u=t[i],this._length=i),u},i.prototype.pop=function(e){if(e=t(e,0),0!==this._length){var n=this._array,r=n[e];return a(n,e,--this._length),this.heapify(e),r}},i}),define("Core/RequestScheduler",["../ThirdParty/Uri","../ThirdParty/when","./Check","./defaultValue","./defined","./defineProperties","./Event","./Heap","./isBlobUri","./isDataUri","./RequestState"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e,t){return e.priority-t.priority}function d(){}function m(e){i(e.priorityFunction)&&(e.priority=e.priorityFunction())}function h(e){var t=r(d.requestsByServer[e],d.maximumRequestsPerServer);return w[e]<t}function p(e){return e.state===l.UNISSUED&&(e.state=l.ISSUED,e.deferred=t.defer()),e.deferred.promise}function _(e){return function(t){e.state!==l.CANCELLED&&(--C.numberOfActiveRequests,--w[e.serverKey],b.raiseEvent(),e.state=l.RECEIVED,e.deferred.resolve(t))}}function v(e){return function(t){e.state!==l.CANCELLED&&(++C.numberOfFailedRequests,--C.numberOfActiveRequests,--w[e.serverKey],b.raiseEvent(t),e.state=l.FAILED,e.deferred.reject(t))}}function g(e){var t=p(e);return e.state=l.ACTIVE,x.push(e),++C.numberOfActiveRequests,++C.numberOfActiveRequestsEver,++w[e.serverKey],e.requestFunction().then(_(e)).otherwise(v(e)),t}function y(e){var t=e.state===l.ACTIVE;e.state=l.CANCELLED,++C.numberOfCancelledRequests,e.deferred.reject(),t&&(--C.numberOfActiveRequests,--w[e.serverKey],++C.numberOfCancelledActiveRequests),i(e.cancelFunction)&&e.cancelFunction()}function E(){C.numberOfAttemptedRequests=0,C.numberOfCancelledRequests=0,C.numberOfCancelledActiveRequests=0}function T(){d.debugShowStatistics&&(C.numberOfAttemptedRequests>0&&console.log("Number of attempted requests: "+C.numberOfAttemptedRequests),C.numberOfActiveRequests>0&&console.log("Number of active requests: "+C.numberOfActiveRequests),C.numberOfCancelledRequests>0&&console.log("Number of cancelled requests: "+C.numberOfCancelledRequests),C.numberOfCancelledActiveRequests>0&&console.log("Number of cancelled active requests: "+C.numberOfCancelledActiveRequests),C.numberOfFailedRequests>0&&console.log("Number of failed requests: "+C.numberOfFailedRequests),E())}var C={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0},S=20,A=new s({comparator:f});A.maximumLength=S,A.reserve(S);var x=[],w={},R="undefined"!=typeof document?new e(document.location.href):new e,b=new o;return d.maximumRequests=50,d.maximumRequestsPerServer=6,d.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},d.throttleRequests=!0,d.debugShowStatistics=!1,d.requestCompletedEvent=b,a(d,{statistics:{get:function(){return C}},priorityHeapLength:{get:function(){return S},set:function(e){if(e<S)for(;A.length>e;){var t=A.pop();y(t)}S=e,A.maximumLength=e,A.reserve(e)}}}),d.update=function(){var e,t,n=0,r=x.length;for(e=0;e<r;++e)t=x[e],t.cancelled&&y(t),t.state===l.ACTIVE?n>0&&(x[e-n]=t):++n;x.length-=n;var i=A.internalArray,a=A.length;for(e=0;e<a;++e)m(i[e]);A.resort();for(var o=Math.max(d.maximumRequests-x.length,0),s=0;s<o&&A.length>0;)t=A.pop(),t.cancelled?y(t):!t.throttleByServer||h(t.serverKey)?(g(t),++s):y(t);T()},d.getServerKey=function(t){var n=new e(t).resolve(R);n.normalize();var r=n.authority;/:/.test(r)||(r=r+":"+("https"===n.scheme?"443":"80"));var a=w[r];return i(a)||(w[r]=0),r},d.request=function(e){if(c(e.url)||u(e.url))return b.raiseEvent(),e.state=l.RECEIVED,e.requestFunction();if(++C.numberOfAttemptedRequests,i(e.serverKey)||(e.serverKey=d.getServerKey(e.url)),!d.throttleRequests||!e.throttle)return g(e);if(!(x.length>=d.maximumRequests)&&(!e.throttleByServer||h(e.serverKey))){m(e);var t=A.insert(e);if(i(t)){if(t===e)return;y(t)}return p(e)}},d.clearForSpecs=function(){for(;A.length>0;){y(A.pop())}for(var e=x.length,t=0;t<e;++t)y(x[t]);x.length=0,w={},C.numberOfAttemptedRequests=0,C.numberOfActiveRequests=0,C.numberOfCancelledRequests=0,C.numberOfCancelledActiveRequests=0,C.numberOfFailedRequests=0,C.numberOfActiveRequestsEver=0},d.numberOfActiveRequestsByServer=function(e){return w[e]},d.requestHeap=A,d}),define("Core/RuntimeError",["./defined"],function(e){"use strict";function t(e){this.name="RuntimeError",this.message=e;var t;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&(t.prototype=Object.create(Error.prototype),t.prototype.constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t}),define("Core/TrustedServers",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(n){var r=new e(n);r.normalize();var i=r.getAuthority();if(t(i)){if(-1!==i.indexOf("@")){i=i.split("@")[1]}if(-1===i.indexOf(":")){var a=r.getScheme();if(t(a)||(a=window.location.protocol,a=a.substring(0,a.length-1)),"http"===a)i+=":80";else{if("https"!==a)return;i+=":443"}}return i}}var i={},a={};return i.add=function(e,n){var r=e.toLowerCase()+":"+n;t(a[r])||(a[r]=!0)},i.remove=function(e,n){var r=e.toLowerCase()+":"+n;t(a[r])&&delete a[r]},i.contains=function(e){var n=r(e);return!(!t(n)||!t(a[n]))},i.clear=function(){a={}},i}),define("Core/Resource",["../ThirdParty/Uri","../ThirdParty/when","./appendForwardSlash","./Check","./clone","./combine","./defaultValue","./defined","./defineProperties","./deprecationWarning","./DeveloperError","./FeatureDetection","./freezeObject","./getAbsoluteUri","./getBaseUri","./getExtensionFromUri","./isBlobUri","./isCrossOriginUrl","./isDataUri","./objectToQuery","./queryToObject","./Request","./RequestErrorEvent","./RequestScheduler","./RequestState","./RuntimeError","./TrustedServers"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A,x,w){"use strict";function R(e,t,n,r){var i=e.query;if(!s(i)||0===i.length)return{};var a;if(-1===i.indexOf("=")){var o={};o[i]=void 0,a=o}else a=E(i);t._queryParameters=n?D(a,t._queryParameters,r):a,e.query=void 0}function b(e,t){var n=t._queryParameters,r=Object.keys(n);1!==r.length||s(n[r[0]])?e.query=y(n):e.query=r[0]}function I(e,t){return s(e)?s(e.clone)?e.clone():i(e):t}function O(e){if(e.state===A.ISSUED||e.state===A.ACTIVE)throw new x("The Resource is already being fetched.");e.state=A.UNISSUED,e.deferred=void 0}function D(e,t,n){if(!n)return a(e,t);var r=i(e,!0);for(var o in t)if(t.hasOwnProperty(o)){var u=r[o],c=t[o];s(u)?(Array.isArray(u)||(u=r[o]=[u]),r[o]=u.concat(c)):r[o]=Array.isArray(c)?c.slice():c}return r}function P(t){t=o(t,o.EMPTY_OBJECT),"string"==typeof t&&(t={url:t}),this._url=void 0,this._templateValues=I(t.templateValues,{}),this._queryParameters=I(t.queryParameters,{}),this.headers=I(t.headers,{}),this.request=o(t.request,new T),this.proxy=t.proxy,this.retryCallback=t.retryCallback,this.retryAttempts=o(t.retryAttempts,0),this._retryCount=0;var n=new e(t.url);R(n,this,!0,!0),n.fragment=void 0,this._url=n.toString()}function M(e){var n=e.request;n.url=e.url,n.requestFunction=function(){var n=e.url,r=!1;e.isDataUri||e.isBlobUri||(r=e.isCrossOriginUrl);var i=t.defer();return P._Implementations.createImage(n,r,i),i.promise};var r=S.request(n);if(s(r))return r.otherwise(function(r){return n.state!==A.FAILED?t.reject(r):e.retryOnError(r).then(function(i){return i?(n.state=A.UNISSUED,n.deferred=void 0,M(e)):t.reject(r)})})}function N(e,n,r){var i={};i[n]=r,e.setQueryParameters(i);var a=e.request;a.url=e.url,a.requestFunction=function(){var n=t.defer();return window[r]=function(e){n.resolve(e);try{delete window[r]}catch(e){window[r]=void 0}},P._Implementations.loadAndExecuteScript(e.url,r,n),n.promise};var o=S.request(a);if(s(o))return o.otherwise(function(i){return a.state!==A.FAILED?t.reject(i):e.retryOnError(i).then(function(o){return o?(a.state=A.UNISSUED,a.deferred=void 0,N(e,n,r)):t.reject(i)})})}function z(e,t){var n=decodeURIComponent(t);return e?atob(n):n}function F(e,t){for(var n=z(e,t),r=new ArrayBuffer(n.length),i=new Uint8Array(r),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return r}function L(e,t){t=o(t,"");var n=e[1],r=!!e[2],i=e[3];switch(t){case"":case"text":return z(r,i);case"arraybuffer":return F(r,i);case"blob":var a=F(r,i);return new Blob([a],{type:n});case"document":return(new DOMParser).parseFromString(z(r,i),n);case"json":return JSON.parse(z(r,i))}}function B(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function U(e,t,n,r,i,a,o){var s=require("url").parse(e),u="https:"===s.protocol?require("https"):require("http"),c=require("zlib"),l={protocol:s.protocol,hostname:s.hostname,port:s.port,path:s.path,query:s.query,method:n,headers:i};u.request(l).on("response",function(e){if(e.statusCode<200||e.statusCode>=300)return void a.reject(new C(e.statusCode,e,e.headers));var n=[];e.on("data",function(e){n.push(e)}),e.on("end",function(){var r=Buffer.concat(n);"gzip"===e.headers["content-encoding"]?c.gunzip(r,function(e,n){e?a.reject(new x("Error decompressing response.")):a.resolve(B(n,t))}):a.resolve(B(r,t))})}).on("error",function(e){a.reject(new C)}).end()}var G=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();P.createIfNeeded=function(e){return e instanceof P?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new P({url:e})},u(P,{isBlobSupported:{get:function(){return G}}}),u(P.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(t){var n=new e(t);R(n,this,!1),n.fragment=void 0,this._url=n.toString()}},extension:{get:function(){return p(this._url)}},isDataUri:{get:function(){return g(this._url)}},isBlobUri:{get:function(){return _(this._url)}},isCrossOriginUrl:{get:function(){return v(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),P.prototype.getUrlComponent=function(t,n){if(this.isDataUri)return this._url;var r=new e(this._url);t&&b(r,this);var i=r.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),a=this._templateValues,o=Object.keys(a);if(o.length>0)for(var u=0;u<o.length;u++){var c=o[u],l=a[c];i=i.replace(new RegExp("{"+c+"}","g"),encodeURIComponent(l))}return n&&s(this.proxy)&&(i=this.proxy.getURL(i)),i},P.prototype.setQueryParameters=function(e,t){this._queryParameters=t?D(this._queryParameters,e,!1):D(e,this._queryParameters,!1)},P.prototype.addQueryParameters=function(e,t){
return c("Resource.addQueryParameters","addQueryParameters has been deprecated and will be removed 1.45. Use setQueryParameters or appendQueryParameters instead."),this.setQueryParameters(e,t)},P.prototype.appendQueryParameters=function(e){this._queryParameters=D(e,this._queryParameters,!0)},P.prototype.setTemplateValues=function(e,t){this._templateValues=t?a(this._templateValues,e):a(e,this._templateValues)},P.prototype.addTemplateValues=function(e,t){return c("Resource.addTemplateValues","addTemplateValues has been deprecated and will be removed 1.45. Use setTemplateValues."),this.setTemplateValues(e,t)},P.prototype.getDerivedResource=function(t){var n=this.clone();if(n._retryCount=0,s(t.url)){var r=new e(t.url);R(r,n,!0,o(t.preserveQueryParameters,!1)),r.fragment=void 0,n._url=r.resolve(new e(m(this._url))).toString()}return s(t.queryParameters)&&(n._queryParameters=a(t.queryParameters,n._queryParameters)),s(t.templateValues)&&(n._templateValues=a(t.templateValues,n.templateValues)),s(t.headers)&&(n.headers=a(t.headers,n.headers)),s(t.proxy)&&(n.proxy=t.proxy),s(t.request)&&(n.request=t.request),s(t.retryCallback)&&(n.retryCallback=t.retryCallback),s(t.retryAttempts)&&(n.retryAttempts=t.retryAttempts),n},P.prototype.retryOnError=function(e){var n=this.retryCallback;if("function"!=typeof n||this._retryCount>=this.retryAttempts)return t(!1);var r=this;return t(n(this,e)).then(function(e){return++r._retryCount,e})},P.prototype.clone=function(e){return s(e)||(e=new P({url:this._url})),e._url=this._url,e._queryParameters=i(this._queryParameters),e._templateValues=i(this._templateValues),e.headers=i(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},P.prototype.getBaseUri=function(e){return h(this.getUrlComponent(e),e)},P.prototype.appendForwardSlash=function(){this._url=n(this._url)},P.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},P.fetchArrayBuffer=function(e){return new P(e).fetchArrayBuffer()},P.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},P.fetchBlob=function(e){return new P(e).fetchBlob()},P.prototype.fetchImage=function(e){if(e=o(e,!1),O(this.request),!G||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!e)return M(this,!0);var n=this.fetchBlob();if(s(n)){var r,i;return n.then(function(e){if(s(e)){i=e;var t=window.URL.createObjectURL(e);return r=new P({url:t}),M(r)}}).then(function(e){if(s(e))return window.URL.revokeObjectURL(r.url),e.blob=i,e}).otherwise(function(e){return s(r)&&window.URL.revokeObjectURL(r.url),t.reject(e)})}},P.fetchImage=function(e){return new P(e).fetchImage(e.preferBlob)},P.prototype.fetchText=function(){return this.fetch({responseType:"text"})},P.fetchText=function(e){return new P(e).fetchText()},P.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(s(e))return e.then(function(e){if(s(e))return JSON.parse(e)})},P.fetchJson=function(e){return new P(e).fetchJson()},P.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},P.fetchXML=function(e){return new P(e).fetchXML()},P.prototype.fetchJsonp=function(e){e=o(e,"callback"),O(this.request);var t;do{t="loadJsonp"+Math.random().toString().substring(2,8)}while(s(window[t]));return N(this,e,t)},P.fetchJsonp=function(e){return new P(e).fetchJsonp(e.callbackParameterName)},P.prototype._makeRequest=function(e){var n=this;O(n.request);var r=n.request;r.url=n.url,r.requestFunction=function(){var i=e.responseType,o=a(e.headers,n.headers),u=e.overrideMimeType,c=e.method,l=e.data,f=t.defer(),d=P._Implementations.loadWithXhr(n.url,i,c,l,o,f,u);return s(d)&&s(d.abort)&&(r.cancelFunction=function(){d.abort()}),f.promise};var i=S.request(r);if(s(i))return i.then(function(e){return e}).otherwise(function(i){return r.state!==A.FAILED?t.reject(i):n.retryOnError(i).then(function(a){return a?(r.state=A.UNISSUED,r.deferred=void 0,n.fetch(e)):t.reject(i)})})};var V=/^data:(.*?)(;base64)?,(.*)$/;P.prototype.fetch=function(e){return e=I(e,{}),e.method="GET",this._makeRequest(e)},P.fetch=function(e){return new P(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.delete=function(e){return e=I(e,{}),e.method="DELETE",this._makeRequest(e)},P.delete=function(e){return new P(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},P.prototype.head=function(e){return e=I(e,{}),e.method="HEAD",this._makeRequest(e)},P.head=function(e){return new P(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.options=function(e){return e=I(e,{}),e.method="OPTIONS",this._makeRequest(e)},P.options=function(e){return new P(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.post=function(e,t){return r.defined("data",e),t=I(t,{}),t.method="POST",t.data=e,this._makeRequest(t)},P.post=function(e){return new P(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.put=function(e,t){return r.defined("data",e),t=I(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)},P.put=function(e){return new P(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P.prototype.patch=function(e,t){return r.defined("data",e),t=I(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)},P.patch=function(e){return new P(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},P._Implementations={},P._Implementations.createImage=function(e,t,n){var r=new Image;r.onload=function(){n.resolve(r)},r.onerror=function(e){n.reject(e)},t&&(w.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e};var k="undefined"==typeof XMLHttpRequest;return P._Implementations.loadWithXhr=function(e,t,n,r,i,a,o){var u=V.exec(e);if(null!==u)return void a.resolve(L(u,t));if(k)return void U(e,t,n,r,i,a,o);var c=new XMLHttpRequest;if(w.contains(e)&&(c.withCredentials=!0),s(o)&&s(c.overrideMimeType)&&c.overrideMimeType(o),c.open(n,e,!0),s(i))for(var l in i)i.hasOwnProperty(l)&&c.setRequestHeader(l,i[l]);s(t)&&(c.responseType=t);var f=!1;return"string"==typeof e&&(f=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),c.onload=function(){if((c.status<200||c.status>=300)&&(!f||0!==c.status))return void a.reject(new C(c.status,c.response,c.getAllResponseHeaders()));var e=c.response,r=c.responseType;if("HEAD"===n||"OPTIONS"===n){var i=c.getAllResponseHeaders(),o=i.trim().split(/[\r\n]+/),u={};return o.forEach(function(e){var t=e.split(": "),n=t.shift();u[n]=t.join(": ")}),void a.resolve(u)}if(204===c.status)a.resolve();else if(!s(e)||s(t)&&r!==t)if("json"===t&&"string"==typeof e)try{a.resolve(JSON.parse(e))}catch(e){a.reject(e)}else(""===r||"document"===r)&&s(c.responseXML)&&c.responseXML.hasChildNodes()?a.resolve(c.responseXML):""!==r&&"text"!==r||!s(c.responseText)?a.reject(new x("Invalid XMLHttpRequest response type.")):a.resolve(c.responseText);else a.resolve(e)},c.onerror=function(e){a.reject(new C)},c.send(r),c},P._Implementations.loadAndExecuteScript=function(e,t,n){var r=document.createElement("script");r.async=!0,r.src=e;var i=document.getElementsByTagName("head")[0];r.onload=function(){r.onload=void 0,i.removeChild(r)},r.onerror=function(e){n.reject(e)},i.appendChild(r)},P._DefaultImplementations={},P._DefaultImplementations.createImage=P._Implementations.createImage,P._DefaultImplementations.loadWithXhr=P._Implementations.loadWithXhr,P._DefaultImplementations.loadAndExecuteScript=P._Implementations.loadAndExecuteScript,P.DEFAULT=d(new P({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),P}),define("Core/buildModuleUrl",["./defined","./DeveloperError","./getAbsoluteUri","./Resource","require"],function(e,t,n,r,i){"use strict";function a(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;++t){var r=e[t].getAttribute("src"),i=h.exec(r);if(null!==i)return i[1]}}function o(t){return"undefined"==typeof document?t:(e(f)||(f=document.createElement("a")),f.href=t,f.href=f.href,f.href)}function s(){if(e(d))return d;var t;return t="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:e(define.amd)&&!define.amd.toUrlUndefined&&e(i.toUrl)?n("..",l("Core/buildModuleUrl.js")):a(),d=new r({url:o(t)}),d.appendForwardSlash(),d}function u(e){return o(i.toUrl("../"+e))}function c(e){return s().getDerivedResource({url:e}).url}function l(t){return e(m)||(m=e(define.amd)&&!define.amd.toUrlUndefined&&e(i.toUrl)?u:c),m(t)}var f,d,m,h=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;return l._cesiumScriptRegex=h,l._buildModuleUrlFromBaseUrl=c,l._clearBaseResource=function(){d=void 0},l.setBaseUrl=function(e){d=r.DEFAULT.getDerivedResource({url:e})},l.getCesiumBaseUrl=s,l}),define("ThirdParty/mersenne-twister",[],function(){var e=function(e){void 0==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};return e.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){var e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},e.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_genrand(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},e}),define("Core/Math",["../ThirdParty/mersenne-twister","./Check","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r,i){"use strict";var a={};a.EPSILON1=.1,a.EPSILON2=.01,a.EPSILON3=.001,a.EPSILON4=1e-4,a.EPSILON5=1e-5,a.EPSILON6=1e-6,a.EPSILON7=1e-7,a.EPSILON8=1e-8,a.EPSILON9=1e-9,a.EPSILON10=1e-10,a.EPSILON11=1e-11,a.EPSILON12=1e-12,a.EPSILON13=1e-13,a.EPSILON14=1e-14,a.EPSILON15=1e-15,a.EPSILON16=1e-16,a.EPSILON17=1e-17,a.EPSILON18=1e-18,a.EPSILON19=1e-19,a.EPSILON20=1e-20,a.GRAVITATIONALPARAMETER=3986004418e5,a.SOLAR_RADIUS=6955e5,a.LUNAR_RADIUS=1737400,a.SIXTY_FOUR_KILOBYTES=65536,a.sign=n(Math.sign,function(e){return e=+e,0===e||e!==e?e:e>0?1:-1}),a.signNotZero=function(e){return e<0?-1:1},a.toSNorm=function(e,t){return t=n(t,255),Math.round((.5*a.clamp(e,-1,1)+.5)*t)},a.fromSNorm=function(e,t){return t=n(t,255),a.clamp(e,0,t)/t*2-1},a.sinh=n(Math.sinh,function(e){return(Math.exp(e)-Math.exp(-e))/2}),a.cosh=n(Math.cosh,function(e){return(Math.exp(e)+Math.exp(-e))/2}),a.lerp=function(e,t,n){return(1-n)*e+n*t},a.PI=Math.PI,a.ONE_OVER_PI=1/Math.PI,a.PI_OVER_TWO=Math.PI/2,a.PI_OVER_THREE=Math.PI/3,a.PI_OVER_FOUR=Math.PI/4,a.PI_OVER_SIX=Math.PI/6,a.THREE_PI_OVER_TWO=3*Math.PI/2,a.TWO_PI=2*Math.PI,a.ONE_OVER_TWO_PI=1/(2*Math.PI),a.RADIANS_PER_DEGREE=Math.PI/180,a.DEGREES_PER_RADIAN=180/Math.PI,a.RADIANS_PER_ARCSECOND=a.RADIANS_PER_DEGREE/3600,a.toRadians=function(e){return e*a.RADIANS_PER_DEGREE},a.toDegrees=function(e){return e*a.DEGREES_PER_RADIAN},a.convertLongitudeRange=function(e){var t=a.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},a.clampToLatitudeRange=function(e){return a.clamp(e,-1*a.PI_OVER_TWO,a.PI_OVER_TWO)},a.negativePiToPi=function(e){return a.zeroToTwoPi(e+a.PI)-a.PI},a.zeroToTwoPi=function(e){var t=a.mod(e,a.TWO_PI);return Math.abs(t)<a.EPSILON14&&Math.abs(e)>a.EPSILON14?a.TWO_PI:t},a.mod=function(e,t){return(e%t+t)%t},a.equalsEpsilon=function(e,t,r,i){i=n(i,r);var a=Math.abs(e-t);return a<=i||a<=r*Math.max(Math.abs(e),Math.abs(t))};var o=[1];a.factorial=function(e){var t=o.length;if(e>=t)for(var n=o[t-1],r=t;r<=e;r++)o.push(n*r);return o[e]},a.incrementWrap=function(e,t,r){return r=n(r,0),++e,e>t&&(e=r),e},a.isPowerOfTwo=function(e){return 0!==e&&0==(e&e-1)},a.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},a.clamp=function(e,t,n){return e<t?t:e>n?n:e};var s=new e;return a.setRandomNumberSeed=function(t){s=new e(t)},a.nextRandomNumber=function(){return s.random()},a.randomBetween=function(e,t){return a.nextRandomNumber()*(t-e)+e},a.acosClamped=function(e){return Math.acos(a.clamp(e,-1,1))},a.asinClamped=function(e){return Math.asin(a.clamp(e,-1,1))},a.chordLength=function(e,t){return 2*t*Math.sin(.5*e)},a.logBase=function(e,t){return Math.log(e)/Math.log(t)},a.cbrt=n(Math.cbrt,function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}),a.log2=n(Math.log2,function(e){return Math.log(e)*Math.LOG2E}),a.fog=function(e,t){var n=e*t;return 1-Math.exp(-n*n)},a.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},a.fastApproximateAtan2=function(e,t){var n,r,i=Math.abs(e);n=Math.abs(t),r=Math.max(i,n),n=Math.min(i,n);var o=n/r;return i=a.fastApproximateAtan(o),i=Math.abs(t)>Math.abs(e)?a.PI_OVER_TWO-i:i,i=e<0?a.PI-i:i,i=t<0?-i:i},a}),define("Core/Cartesian3",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n,r){this.x=t(e,0),this.y=t(n,0),this.z=t(r,0)}o.fromSpherical=function(e,r){n(r)||(r=new o);var i=e.clock,a=e.cone,s=t(e.magnitude,1),u=s*Math.sin(a);return r.x=u*Math.cos(i),r.y=u*Math.sin(i),r.z=s*Math.cos(a),r},o.fromElements=function(e,t,r,i){return n(i)?(i.x=e,i.y=t,i.z=r,i):new o(e,t,r)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new o(e.x,e.y,e.z)},o.fromCartesian4=o.clone,o.packedLength=3,o.pack=function(e,n,r){return r=t(r,0),n[r++]=e.x,n[r++]=e.y,n[r]=e.z,n},o.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new o),i.x=e[r++],i.y=e[r++],i.z=e[r],i},o.packArray=function(e,t){var r=e.length;n(t)?t.length=3*r:t=new Array(3*r);for(var i=0;i<r;++i)o.pack(e[i],t,3*i);return t},o.unpackArray=function(e,t){var r=e.length;n(t)?t.length=r/3:t=new Array(r/3);for(var i=0;i<r;i+=3){var a=i/3;t[a]=o.unpack(e,i,t[a])}return t},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)},o.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(e,t){return o.subtract(e,t,s),o.magnitude(s)},o.distanceSquared=function(e,t){return o.subtract(e,t,s),o.magnitudeSquared(s)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},o.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var u=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,u),r=o.multiplyByScalar(e,1-n,r),o.add(u,r,r)};var c=new o,l=new o;o.angleBetween=function(e,t){o.normalize(e,c),o.normalize(t,l);var n=o.dot(c,l),r=o.magnitude(o.cross(c,l,c));return Math.atan2(r,n)};var f=new o;o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,f);return o.abs(n,n),t=n.x<=n.y?n.x<=n.z?o.clone(o.UNIT_X,t):o.clone(o.UNIT_Z,t):n.y<=n.z?o.clone(o.UNIT_Y,t):o.clone(o.UNIT_Z,t)},o.projectVector=function(e,t,n){var r=o.dot(e,t)/o.dot(t,t);return o.multiplyByScalar(t,r,n)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)&&a.equalsEpsilon(e.z,t.z,r,i)},o.cross=function(e,t,n){var r=e.x,i=e.y,a=e.z,o=t.x,s=t.y,u=t.z,c=i*u-a*s,l=a*o-r*u,f=r*s-i*o;return n.x=c,n.y=l,n.z=f,n},o.midpoint=function(e,t,n){return n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z),n},o.fromDegrees=function(e,t,n,r,i){return e=a.toRadians(e),t=a.toRadians(t),o.fromRadians(e,t,n,r,i)};var d=new o,m=new o,h=new o(40680631590769,40680631590769,40408299984661.445);return o.fromRadians=function(e,r,i,a,s){i=t(i,0);var u=n(a)?a.radiiSquared:h,c=Math.cos(r);d.x=c*Math.cos(e),d.y=c*Math.sin(e),d.z=Math.sin(r),d=o.normalize(d,d),o.multiplyComponents(u,d,m);var l=Math.sqrt(o.dot(d,m));return m=o.divideByScalar(m,l,m),d=o.multiplyByScalar(d,i,d),n(s)||(s=new o),o.add(m,d,s)},o.fromDegreesArray=function(e,t,r){var i=e.length;n(r)?r.length=i/2:r=new Array(i/2);for(var a=0;a<i;a+=2){var s=e[a],u=e[a+1],c=a/2;r[c]=o.fromDegrees(s,u,0,t,r[c])}return r},o.fromRadiansArray=function(e,t,r){var i=e.length;n(r)?r.length=i/2:r=new Array(i/2);for(var a=0;a<i;a+=2){var s=e[a],u=e[a+1],c=a/2;r[c]=o.fromRadians(s,u,0,t,r[c])}return r},o.fromDegreesArrayHeights=function(e,t,r){var i=e.length;n(r)?r.length=i/3:r=new Array(i/3);for(var a=0;a<i;a+=3){var s=e[a],u=e[a+1],c=e[a+2],l=a/3;r[l]=o.fromDegrees(s,u,c,t,r[l])}return r},o.fromRadiansArrayHeights=function(e,t,r){var i=e.length;n(r)?r.length=i/3:r=new Array(i/3);for(var a=0;a<i;a+=3){var s=e[a],u=e[a+1],c=e[a+2],l=a/3;r[l]=o.fromRadians(s,u,c,t,r[l])}return r},o.ZERO=i(new o(0,0,0)),o.UNIT_X=i(new o(1,0,0)),o.UNIT_Y=i(new o(0,1,0)),o.UNIT_Z=i(new o(0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},o}),define("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";function i(n,i,s,u,c){var l=n.x,f=n.y,d=n.z,m=i.x,h=i.y,p=i.z,_=l*l*m*m,v=f*f*h*h,g=d*d*p*p,y=_+v+g,E=Math.sqrt(1/y),T=e.multiplyByScalar(n,E,a);if(y<u)return isFinite(E)?e.clone(T,c):void 0;var C=s.x,S=s.y,A=s.z,x=o;x.x=T.x*C*2,x.y=T.y*S*2,x.z=T.z*A*2;var w,R,b,I,O,D,P,M,N,z,F,L=(1-E)*e.magnitude(n)/(.5*e.magnitude(x)),B=0;do{L-=B,b=1/(1+L*C),I=1/(1+L*S),O=1/(1+L*A),D=b*b,P=I*I,M=O*O,N=D*b,z=P*I,F=M*O,w=_*D+v*P+g*M-1,R=_*N*C+v*z*S+g*F*A;B=w/(-2*R)}while(Math.abs(w)>r.EPSILON12);return t(c)?(c.x=l*b,c.y=f*I,c.z=d*O,c):new e(l*b,f*I,d*O)}var a=new e,o=new e;return i}),define("Core/Cartographic",["./Cartesian3","./Check","./defaultValue","./defined","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,a,o){"use strict";function s(e,t,r){this.longitude=n(e,0),this.latitude=n(t,0),this.height=n(r,0)}s.fromRadians=function(e,t,i,a){return i=n(i,0),r(a)?(a.longitude=e,a.latitude=t,a.height=i,a):new s(e,t,i)},s.fromDegrees=function(e,t,n,r){return e=a.toRadians(e),t=a.toRadians(t),s.fromRadians(e,t,n,r)};var u=new e,c=new e,l=new e,f=new e(1/6378137,1/6378137,1/6356752.314245179),d=new e(1/40680631590769,1/40680631590769,1/40408299984661.445),m=a.EPSILON1;return s.fromCartesian=function(t,n,i){var h=r(n)?n.oneOverRadii:f,p=r(n)?n.oneOverRadiiSquared:d,_=r(n)?n._centerToleranceSquared:m,v=o(t,h,p,_,c);if(r(v)){var g=e.multiplyComponents(v,p,u);g=e.normalize(g,g);var y=e.subtract(t,v,l),E=Math.atan2(g.y,g.x),T=Math.asin(g.z),C=a.sign(e.dot(y,t))*e.magnitude(y);return r(i)?(i.longitude=E,i.latitude=T,i.height=C,i):new s(E,T,C)}},s.toCartesian=function(t,n,r){return e.fromRadians(t.longitude,t.latitude,t.height,n,r)},s.clone=function(e,t){if(r(e))return r(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new s(e.longitude,e.latitude,e.height)},s.equals=function(e,t){return e===t||r(e)&&r(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},s.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n},s.ZERO=i(new s(0,0,0)),s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)},s.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},s}),define("Core/Ellipsoid",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(t,n,i,a){n=r(n,0),i=r(i,0),a=r(a,0),t._radii=new e(n,i,a),t._radiiSquared=new e(n*n,i*i,a*a),t._radiiToTheFourth=new e(n*n*n*n,i*i*i*i,a*a*a*a),t._oneOverRadii=new e(0===n?0:1/n,0===i?0:1/i,0===a?0:1/a),t._oneOverRadiiSquared=new e(0===n?0:1/(n*n),0===i?0:1/(i*i),0===a?0:1/(a*a)),t._minimumRadius=Math.min(n,i,a),t._maximumRadius=Math.max(n,i,a),t._centerToleranceSquared=u.EPSILON1,0!==t._radiiSquared.z&&(t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z)}function f(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,l(this,e,t,n)}a(f.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),f.clone=function(t,n){if(i(t)){var r=t._radii;return i(n)?(e.clone(r,n._radii),e.clone(t._radiiSquared,n._radiiSquared),e.clone(t._radiiToTheFourth,n._radiiToTheFourth),e.clone(t._oneOverRadii,n._oneOverRadii),e.clone(t._oneOverRadiiSquared,n._oneOverRadiiSquared),n._minimumRadius=t._minimumRadius,n._maximumRadius=t._maximumRadius,n._centerToleranceSquared=t._centerToleranceSquared,n):new f(r.x,r.y,r.z)}},f.fromCartesian3=function(e,t){return i(t)||(t=new f),i(e)?(l(t,e.x,e.y,e.z),t):t},f.WGS84=s(new f(6378137,6378137,6356752.314245179)),f.UNIT_SPHERE=s(new f(1,1,1)),f.MOON=s(new f(u.LUNAR_RADIUS,u.LUNAR_RADIUS,u.LUNAR_RADIUS)),f.prototype.clone=function(e){return f.clone(this,e)},f.packedLength=e.packedLength,f.pack=function(t,n,i){return i=r(i,0),e.pack(t._radii,n,i),n},f.unpack=function(t,n,i){n=r(n,0);var a=e.unpack(t,n);return f.fromCartesian3(a,i)},f.prototype.geocentricSurfaceNormal=e.normalize,f.prototype.geodeticSurfaceNormalCartographic=function(t,n){var r=t.longitude,a=t.latitude,o=Math.cos(a),s=o*Math.cos(r),u=o*Math.sin(r),c=Math.sin(a);return i(n)||(n=new e),n.x=s,n.y=u,n.z=c,e.normalize(n,n)},f.prototype.geodeticSurfaceNormal=function(t,n){return i(n)||(n=new e),n=e.multiplyComponents(t,this._oneOverRadiiSquared,n),e.normalize(n,n)};var d=new e,m=new e;f.prototype.cartographicToCartesian=function(t,n){var r=d,a=m;this.geodeticSurfaceNormalCartographic(t,r),e.multiplyComponents(this._radiiSquared,r,a);var o=Math.sqrt(e.dot(r,a));return e.divideByScalar(a,o,a),e.multiplyByScalar(r,t.height,r),i(n)||(n=new e),e.add(a,r,n)},f.prototype.cartographicArrayToCartesianArray=function(e,t){var n=e.length;i(t)?t.length=n:t=new Array(n);for(var r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};var h=new e,p=new e,_=new e;return f.prototype.cartesianToCartographic=function(n,r){var a=this.scaleToGeodeticSurface(n,p);if(i(a)){var o=this.geodeticSurfaceNormal(a,h),s=e.subtract(n,a,_),c=Math.atan2(o.y,o.x),l=Math.asin(o.z),f=u.sign(e.dot(s,n))*e.magnitude(s);return i(r)?(r.longitude=c,r.latitude=l,r.height=f,r):new t(c,l,f)}},f.prototype.cartesianArrayToCartographicArray=function(e,t){var n=e.length;i(t)?t.length=n:t=new Array(n);for(var r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t},f.prototype.scaleToGeodeticSurface=function(e,t){return c(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},f.prototype.scaleToGeocentricSurface=function(t,n){i(n)||(n=new e);var r=t.x,a=t.y,o=t.z,s=this._oneOverRadiiSquared,u=1/Math.sqrt(r*r*s.x+a*a*s.y+o*o*s.z);return e.multiplyByScalar(t,u,n)},f.prototype.transformPositionToScaledSpace=function(t,n){return i(n)||(n=new e),e.multiplyComponents(t,this._oneOverRadii,n)},f.prototype.transformPositionFromScaledSpace=function(t,n){return i(n)||(n=new e),e.multiplyComponents(t,this._radii,n)},f.prototype.equals=function(t){return this===t||i(t)&&e.equals(this._radii,t._radii)},f.prototype.toString=function(){return this._radii.toString()},f.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,n,a){n=r(n,0);var o=this._squaredXOverSquaredZ;if(i(a)||(a=new e),a.x=0,a.y=0,a.z=t.z*(1-o),!(Math.abs(a.z)>=this._radii.z-n))return a},f}),define("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(e,t,n,r,i,a,o){"use strict";function s(e){this._ellipsoid=n(e,o.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),s.prototype.project=function(t,n){var i=this._semimajorAxis,a=t.longitude*i,o=t.latitude*i,s=t.height;return r(n)?(n.x=a,n.y=o,n.z=s,n):new e(a,o,s)},s.prototype.unproject=function(e,n){var i=this._oneOverSemimajorAxis,a=e.x*i,o=e.y*i,s=e.z;return r(n)?(n.longitude=a,n.latitude=o,n.height=s,n):new t(a,o,s)},s}),define("Core/Intersect",["./freezeObject"],function(e){"use strict";return e({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})}),define("Core/Interval",["./defaultValue"],function(e){"use strict";function t(t,n){this.start=e(t,0),this.stop=e(n,0)}return t}),define("Core/Matrix3",["./Cartesian3","./Check","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i,a,o,s,u,c){this[0]=n(e,0),this[1]=n(i,0),this[2]=n(s,0),this[3]=n(t,0),this[4]=n(a,0),this[5]=n(u,0),this[6]=n(r,0),this[7]=n(o,0),this[8]=n(c,0)}function c(e){for(var t=0,n=0;n<9;++n){var r=e[n];t+=r*r}return Math.sqrt(t)}function l(e){for(var t=0,n=0;n<3;++n){var r=e[u.getElementIndex(p[n],h[n])];t+=2*r*r}return Math.sqrt(t)}function f(e,t){for(var n=s.EPSILON15,r=0,i=1,a=0;a<3;++a){var o=Math.abs(e[u.getElementIndex(p[a],h[a])]);o>r&&(i=a,r=o)}var c=1,l=0,f=h[i],d=p[i];if(Math.abs(e[u.getElementIndex(d,f)])>n){var m,_=e[u.getElementIndex(d,d)],v=e[u.getElementIndex(f,f)],g=e[u.getElementIndex(d,f)],y=(_-v)/2/g;m=y<0?-1/(-y+Math.sqrt(1+y*y)):1/(y+Math.sqrt(1+y*y)),c=1/Math.sqrt(1+m*m),l=m*c}return t=u.clone(u.IDENTITY,t),t[u.getElementIndex(f,f)]=t[u.getElementIndex(d,d)]=c,t[u.getElementIndex(d,f)]=l,t[u.getElementIndex(f,d)]=-l,t}u.packedLength=9,u.pack=function(e,t,r){return r=n(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t},u.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new u),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i},u.clone=function(e,t){if(r(e))return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new u(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},u.fromArray=function(e,t,i){return t=n(t,0),r(i)||(i=new u),i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],i[4]=e[t+4],i[5]=e[t+5],i[6]=e[t+6],i[7]=e[t+7],i[8]=e[t+8],i},u.fromColumnMajorArray=function(e,t){return u.clone(e,t)},u.fromRowMajorArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new u(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},u.fromQuaternion=function(e,t){var n=e.x*e.x,i=e.x*e.y,a=e.x*e.z,o=e.x*e.w,s=e.y*e.y,c=e.y*e.z,l=e.y*e.w,f=e.z*e.z,d=e.z*e.w,m=e.w*e.w,h=n-s-f+m,p=2*(i-d),_=2*(a+l),v=2*(i+d),g=-n+s-f+m,y=2*(c-o),E=2*(a-l),T=2*(c+o),C=-n-s+f+m;return r(t)?(t[0]=h,t[1]=v,t[2]=E,t[3]=p,t[4]=g,t[5]=T,t[6]=_,t[7]=y,t[8]=C,t):new u(h,p,_,v,g,y,E,T,C)},u.fromHeadingPitchRoll=function(e,t){var n=Math.cos(-e.pitch),i=Math.cos(-e.heading),a=Math.cos(e.roll),o=Math.sin(-e.pitch),s=Math.sin(-e.heading),c=Math.sin(e.roll),l=n*i,f=-a*s+c*o*i,d=c*s+a*o*i,m=n*s,h=a*i+c*o*s,p=-c*i+a*o*s,_=-o,v=c*n,g=a*n;return r(t)?(t[0]=l,t[1]=m,t[2]=_,t[3]=f,t[4]=h,t[5]=v,t[6]=d,t[7]=p,t[8]=g,t):new u(l,f,d,m,h,p,_,v,g)},u.fromScale=function(e,t){return r(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new u(e.x,0,0,0,e.y,0,0,0,e.z)},u.fromUniformScale=function(e,t){return r(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new u(e,0,0,0,e,0,0,0,e)},u.fromCrossProduct=function(e,t){return r(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new u(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},u.fromRotationX=function(e,t){var n=Math.cos(e),i=Math.sin(e);return r(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=i,t[6]=0,t[7]=-i,t[8]=n,t):new u(1,0,0,0,n,-i,0,i,n)},u.fromRotationY=function(e,t){var n=Math.cos(e),i=Math.sin(e);return r(t)?(t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=1,t[5]=0,t[6]=i,t[7]=0,t[8]=n,t):new u(n,0,i,0,1,0,-i,0,n)},u.fromRotationZ=function(e,t){var n=Math.cos(e),i=Math.sin(e);return r(t)?(t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new u(n,-i,0,i,n,0,0,0,1)},u.toArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},u.getElementIndex=function(e,t){return 3*e+t},u.getColumn=function(e,t,n){var r=3*t,i=e[r],a=e[r+1],o=e[r+2];return n.x=i,n.y=a,n.z=o,n},u.setColumn=function(e,t,n,r){r=u.clone(e,r);var i=3*t;return r[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r},u.getRow=function(e,t,n){var r=e[t],i=e[t+3],a=e[t+6];return n.x=r,n.y=i,n.z=a,n},u.setRow=function(e,t,n,r){return r=u.clone(e,r),r[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};var d=new e;u.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],t[2],d)),n.y=e.magnitude(e.fromElements(t[3],t[4],t[5],d)),n.z=e.magnitude(e.fromElements(t[6],t[7],t[8],d)),n};var m=new e;u.getMaximumScale=function(t){return u.getScale(t,m),e.maximumComponent(m)},u.multiply=function(e,t,n){var r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],i=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],a=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],o=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],s=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],u=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],l=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],f=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=i,n[2]=a,n[3]=o,n[4]=s,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n},u.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n},u.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n},u.multiplyByVector=function(e,t,n){var r=t.x,i=t.y,a=t.z,o=e[0]*r+e[3]*i+e[6]*a,s=e[1]*r+e[4]*i+e[7]*a,u=e[2]*r+e[5]*i+e[8]*a;return n.x=o,n.y=s,n.z=u,n},
u.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},u.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n},u.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},u.transpose=function(e,t){var n=e[0],r=e[3],i=e[6],a=e[1],o=e[4],s=e[7],u=e[2],c=e[5],l=e[8];return t[0]=n,t[1]=r,t[2]=i,t[3]=a,t[4]=o,t[5]=s,t[6]=u,t[7]=c,t[8]=l,t};var h=[1,0,0],p=[2,2,1],_=new u,v=new u;return u.computeEigenDecomposition=function(e,t){var n=s.EPSILON20,i=0,a=0;r(t)||(t={});for(var o=t.unitary=u.clone(u.IDENTITY,t.unitary),d=t.diagonal=u.clone(e,t.diagonal),m=n*c(d);a<10&&l(d)>m;)f(d,_),u.transpose(_,v),u.multiply(d,_,d),u.multiply(v,d,d),u.multiply(o,_,o),++i>2&&(++a,i=0);return t},u.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},u.determinant=function(e){var t=e[0],n=e[3],r=e[6],i=e[1],a=e[4],o=e[7],s=e[2],u=e[5],c=e[8];return t*(a*c-u*o)+i*(u*r-n*c)+s*(n*o-a*r)},u.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],f=e[8],d=u.determinant(e);t[0]=o*f-l*s,t[1]=l*i-r*f,t[2]=r*s-o*i,t[3]=c*s-a*f,t[4]=n*f-c*i,t[5]=a*i-n*s,t[6]=a*l-c*o,t[7]=c*r-n*l,t[8]=n*o-a*r;var m=1/d;return u.multiplyByScalar(t,m,t)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},u.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n},u.IDENTITY=o(new u(1,0,0,0,1,0,0,0,1)),u.ZERO=o(new u(0,0,0,0,0,0,0,0,0)),u.COLUMN0ROW0=0,u.COLUMN0ROW1=1,u.COLUMN0ROW2=2,u.COLUMN1ROW0=3,u.COLUMN1ROW1=4,u.COLUMN1ROW2=5,u.COLUMN2ROW0=6,u.COLUMN2ROW1=7,u.COLUMN2ROW2=8,i(u.prototype,{length:{get:function(){return u.packedLength}}}),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"},u}),define("Core/Cartesian4",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n,r,i){this.x=t(e,0),this.y=t(n,0),this.z=t(r,0),this.w=t(i,0)}o.fromElements=function(e,t,r,i,a){return n(a)?(a.x=e,a.y=t,a.z=r,a.w=i,a):new o(e,t,r,i)},o.fromColor=function(e,t){return n(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new o(e.red,e.green,e.blue,e.alpha)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new o(e.x,e.y,e.z,e.w)},o.packedLength=4,o.pack=function(e,n,r){return r=t(r,0),n[r++]=e.x,n[r++]=e.y,n[r++]=e.z,n[r]=e.w,n},o.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new o),i.x=e[r++],i.y=e[r++],i.z=e[r++],i.w=e[r],i},o.packArray=function(e,t){var r=e.length;n(t)?t.length=4*r:t=new Array(4*r);for(var i=0;i<r;++i)o.pack(e[i],t,4*i);return t},o.unpackArray=function(e,t){var r=e.length;n(t)?t.length=r/4:t=new Array(r/4);for(var i=0;i<r;i+=4){var a=i/4;t[a]=o.unpack(e,i,t[a])}return t},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)},o.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(e,t){return o.subtract(e,t,s),o.magnitude(s)},o.distanceSquared=function(e,t){return o.subtract(e,t,s),o.magnitudeSquared(s)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},o.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var u=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,u),r=o.multiplyByScalar(e,1-n,r),o.add(u,r,r)};var c=new o;o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,c);return o.abs(n,n),t=n.x<=n.y?n.x<=n.z?n.x<=n.w?o.clone(o.UNIT_X,t):o.clone(o.UNIT_W,t):n.z<=n.w?o.clone(o.UNIT_Z,t):o.clone(o.UNIT_W,t):n.y<=n.z?n.y<=n.w?o.clone(o.UNIT_Y,t):o.clone(o.UNIT_W,t):n.z<=n.w?o.clone(o.UNIT_Z,t):o.clone(o.UNIT_W,t)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)&&a.equalsEpsilon(e.z,t.z,r,i)&&a.equalsEpsilon(e.w,t.w,r,i)},o.ZERO=i(new o(0,0,0,0)),o.UNIT_X=i(new o(1,0,0,0)),o.UNIT_Y=i(new o(0,1,0,0)),o.UNIT_Z=i(new o(0,0,1,0)),o.UNIT_W=i(new o(0,0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var l=new Float32Array(1);return o.packFloat=function(e,t){if(n(t)||(t=new o),l[0]=e,0===(e=l[0]))return o.clone(o.ZERO,t);var r,i=e<0?1:0;isFinite(e)?(e=Math.abs(e),r=Math.floor(a.logBase(e,10))+1,e/=Math.pow(10,r)):(e=.1,r=38);var s=256*e;return t.x=Math.floor(s),s=256*(s-t.x),t.y=Math.floor(s),s=256*(s-t.y),t.z=Math.floor(s),t.w=2*(r+38)+i,t},o.unpackFloat=function(e){var t=e.w/2,n=Math.floor(t),r=2*(t-n);if(n-=38,r=2*r-1,r=-r,n>=38)return r<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var i=r*e.x*(1/256);return i+=r*e.y*(1/65536),(i+=r*e.z*(1/16777216))*Math.pow(10,n)},o}),define("Core/Matrix4",["./Cartesian3","./Cartesian4","./Check","./defaultValue","./defined","./defineProperties","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t,n,i,a,o,s,u,c,l,f,d,m,h,p,_){this[0]=r(e,0),this[1]=r(a,0),this[2]=r(c,0),this[3]=r(m,0),this[4]=r(t,0),this[5]=r(o,0),this[6]=r(l,0),this[7]=r(h,0),this[8]=r(n,0),this[9]=r(s,0),this[10]=r(f,0),this[11]=r(p,0),this[12]=r(i,0),this[13]=r(u,0),this[14]=r(d,0),this[15]=r(_,0)}l.packedLength=16,l.pack=function(e,t,n){return n=r(n,0),t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t},l.unpack=function(e,t,n){return t=r(t,0),i(n)||(n=new l),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n},l.clone=function(e,t){if(i(e))return i(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new l(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},l.fromArray=l.unpack,l.fromColumnMajorArray=function(e,t){return l.clone(e,t)},l.fromRowMajorArray=function(e,t){return i(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new l(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},l.fromRotationTranslation=function(t,n,a){return n=r(n,e.ZERO),i(a)?(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=0,a[4]=t[3],a[5]=t[4],a[6]=t[5],a[7]=0,a[8]=t[6],a[9]=t[7],a[10]=t[8],a[11]=0,a[12]=n.x,a[13]=n.y,a[14]=n.z,a[15]=1,a):new l(t[0],t[3],t[6],n.x,t[1],t[4],t[7],n.y,t[2],t[5],t[8],n.z,0,0,0,1)},l.fromTranslationQuaternionRotationScale=function(e,t,n,r){i(r)||(r=new l);var a=n.x,o=n.y,s=n.z,u=t.x*t.x,c=t.x*t.y,f=t.x*t.z,d=t.x*t.w,m=t.y*t.y,h=t.y*t.z,p=t.y*t.w,_=t.z*t.z,v=t.z*t.w,g=t.w*t.w,y=u-m-_+g,E=2*(c-v),T=2*(f+p),C=2*(c+v),S=-u+m-_+g,A=2*(h-d),x=2*(f-p),w=2*(h+d),R=-u-m+_+g;return r[0]=y*a,r[1]=C*a,r[2]=x*a,r[3]=0,r[4]=E*o,r[5]=S*o,r[6]=w*o,r[7]=0,r[8]=T*s,r[9]=A*s,r[10]=R*s,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r},l.fromTranslationRotationScale=function(e,t){return l.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},l.fromTranslation=function(e,t){return l.fromRotationTranslation(u.IDENTITY,e,t)},l.fromScale=function(e,t){return i(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new l(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},l.fromUniformScale=function(e,t){return i(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new l(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var f=new e,d=new e,m=new e;l.fromCamera=function(t,n){var r=t.position,a=t.direction,o=t.up;e.normalize(a,f),e.normalize(e.cross(f,o,d),d),e.normalize(e.cross(d,f,m),m);var s=d.x,u=d.y,c=d.z,h=f.x,p=f.y,_=f.z,v=m.x,g=m.y,y=m.z,E=r.x,T=r.y,C=r.z,S=s*-E+u*-T+c*-C,A=v*-E+g*-T+y*-C,x=h*E+p*T+_*C;return i(n)?(n[0]=s,n[1]=v,n[2]=-h,n[3]=0,n[4]=u,n[5]=g,n[6]=-p,n[7]=0,n[8]=c,n[9]=y,n[10]=-_,n[11]=0,n[12]=S,n[13]=A,n[14]=x,n[15]=1,n):new l(s,u,c,S,v,g,y,A,-h,-p,-_,x,0,0,0,1)},l.computePerspectiveFieldOfView=function(e,t,n,r,i){var a=Math.tan(.5*e),o=1/a,s=o/t,u=(r+n)/(n-r),c=2*r*n/(n-r);return i[0]=s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=u,i[11]=-1,i[12]=0,i[13]=0,i[14]=c,i[15]=0,i},l.computeOrthographicOffCenter=function(e,t,n,r,i,a,o){var s=1/(t-e),u=1/(r-n),c=1/(a-i),l=-(t+e)*s,f=-(r+n)*u,d=-(a+i)*c;return s*=2,u*=2,c*=-2,o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=u,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=c,o[11]=0,o[12]=l,o[13]=f,o[14]=d,o[15]=1,o},l.computePerspectiveOffCenter=function(e,t,n,r,i,a,o){var s=2*i/(t-e),u=2*i/(r-n),c=(t+e)/(t-e),l=(r+n)/(r-n),f=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=u,o[6]=0,o[7]=0,o[8]=c,o[9]=l,o[10]=f,o[11]=-1,o[12]=0,o[13]=0,o[14]=d,o[15]=0,o},l.computeInfinitePerspectiveOffCenter=function(e,t,n,r,i,a){var o=2*i/(t-e),s=2*i/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),l=-2*i;return a[0]=o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=u,a[9]=c,a[10]=-1,a[11]=-1,a[12]=0,a[13]=0,a[14]=l,a[15]=0,a},l.computeViewportTransformation=function(e,t,n,i){e=r(e,r.EMPTY_OBJECT);var a=r(e.x,0),o=r(e.y,0),s=r(e.width,0),u=r(e.height,0);t=r(t,0),n=r(n,1);var c=.5*s,l=.5*u,f=.5*(n-t),d=c,m=l,h=f,p=a+c,_=o+l,v=t+f;return i[0]=d,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=h,i[11]=0,i[12]=p,i[13]=_,i[14]=v,i[15]=1,i},l.computeView=function(t,n,r,i,a){return a[0]=i.x,a[1]=r.x,a[2]=-n.x,a[3]=0,a[4]=i.y,a[5]=r.y,a[6]=-n.y,a[7]=0,a[8]=i.z,a[9]=r.z,a[10]=-n.z,a[11]=0,a[12]=-e.dot(i,t),a[13]=-e.dot(r,t),a[14]=e.dot(n,t),a[15]=1,a},l.toArray=function(e,t){return i(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},l.getElementIndex=function(e,t){return 4*e+t},l.getColumn=function(e,t,n){var r=4*t,i=e[r],a=e[r+1],o=e[r+2],s=e[r+3];return n.x=i,n.y=a,n.z=o,n.w=s,n},l.setColumn=function(e,t,n,r){r=l.clone(e,r);var i=4*t;return r[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r[i+3]=n.w,r},l.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n},l.getRow=function(e,t,n){var r=e[t],i=e[t+4],a=e[t+8],o=e[t+12];return n.x=r,n.y=i,n.z=a,n.w=o,n},l.setRow=function(e,t,n,r){return r=l.clone(e,r),r[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r};var h=new e;l.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],t[2],h)),n.y=e.magnitude(e.fromElements(t[4],t[5],t[6],h)),n.z=e.magnitude(e.fromElements(t[8],t[9],t[10],h)),n};var p=new e;l.getMaximumScale=function(t){return l.getScale(t,p),e.maximumComponent(p)},l.multiply=function(e,t,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],d=e[9],m=e[10],h=e[11],p=e[12],_=e[13],v=e[14],g=e[15],y=t[0],E=t[1],T=t[2],C=t[3],S=t[4],A=t[5],x=t[6],w=t[7],R=t[8],b=t[9],I=t[10],O=t[11],D=t[12],P=t[13],M=t[14],N=t[15],z=r*y+s*E+f*T+p*C,F=i*y+u*E+d*T+_*C,L=a*y+c*E+m*T+v*C,B=o*y+l*E+h*T+g*C,U=r*S+s*A+f*x+p*w,G=i*S+u*A+d*x+_*w,V=a*S+c*A+m*x+v*w,k=o*S+l*A+h*x+g*w,q=r*R+s*b+f*I+p*O,H=i*R+u*b+d*I+_*O,W=a*R+c*b+m*I+v*O,Y=o*R+l*b+h*I+g*O,X=r*D+s*P+f*M+p*N,j=i*D+u*P+d*M+_*N,Z=a*D+c*P+m*M+v*N,K=o*D+l*P+h*M+g*N;return n[0]=z,n[1]=F,n[2]=L,n[3]=B,n[4]=U,n[5]=G,n[6]=V,n[7]=k,n[8]=q,n[9]=H,n[10]=W,n[11]=Y,n[12]=X,n[13]=j,n[14]=Z,n[15]=K,n},l.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n},l.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n},l.multiplyTransformation=function(e,t,n){var r=e[0],i=e[1],a=e[2],o=e[4],s=e[5],u=e[6],c=e[8],l=e[9],f=e[10],d=e[12],m=e[13],h=e[14],p=t[0],_=t[1],v=t[2],g=t[4],y=t[5],E=t[6],T=t[8],C=t[9],S=t[10],A=t[12],x=t[13],w=t[14],R=r*p+o*_+c*v,b=i*p+s*_+l*v,I=a*p+u*_+f*v,O=r*g+o*y+c*E,D=i*g+s*y+l*E,P=a*g+u*y+f*E,M=r*T+o*C+c*S,N=i*T+s*C+l*S,z=a*T+u*C+f*S,F=r*A+o*x+c*w+d,L=i*A+s*x+l*w+m,B=a*A+u*x+f*w+h;return n[0]=R,n[1]=b,n[2]=I,n[3]=0,n[4]=O,n[5]=D,n[6]=P,n[7]=0,n[8]=M,n[9]=N,n[10]=z,n[11]=0,n[12]=F,n[13]=L,n[14]=B,n[15]=1,n},l.multiplyByMatrix3=function(e,t,n){var r=e[0],i=e[1],a=e[2],o=e[4],s=e[5],u=e[6],c=e[8],l=e[9],f=e[10],d=t[0],m=t[1],h=t[2],p=t[3],_=t[4],v=t[5],g=t[6],y=t[7],E=t[8],T=r*d+o*m+c*h,C=i*d+s*m+l*h,S=a*d+u*m+f*h,A=r*p+o*_+c*v,x=i*p+s*_+l*v,w=a*p+u*_+f*v,R=r*g+o*y+c*E,b=i*g+s*y+l*E,I=a*g+u*y+f*E;return n[0]=T,n[1]=C,n[2]=S,n[3]=0,n[4]=A,n[5]=x,n[6]=w,n[7]=0,n[8]=R,n[9]=b,n[10]=I,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},l.multiplyByTranslation=function(e,t,n){var r=t.x,i=t.y,a=t.z,o=r*e[0]+i*e[4]+a*e[8]+e[12],s=r*e[1]+i*e[5]+a*e[9]+e[13],u=r*e[2]+i*e[6]+a*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=o,n[13]=s,n[14]=u,n[15]=e[15],n};var _=new e;l.multiplyByUniformScale=function(e,t,n){return _.x=t,_.y=t,_.z=t,l.multiplyByScale(e,_,n)},l.multiplyByScale=function(e,t,n){var r=t.x,i=t.y,a=t.z;return 1===r&&1===i&&1===a?l.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=0,n[4]=i*e[4],n[5]=i*e[5],n[6]=i*e[6],n[7]=0,n[8]=a*e[8],n[9]=a*e[9],n[10]=a*e[10],n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=1,n)},l.multiplyByVector=function(e,t,n){var r=t.x,i=t.y,a=t.z,o=t.w,s=e[0]*r+e[4]*i+e[8]*a+e[12]*o,u=e[1]*r+e[5]*i+e[9]*a+e[13]*o,c=e[2]*r+e[6]*i+e[10]*a+e[14]*o,l=e[3]*r+e[7]*i+e[11]*a+e[15]*o;return n.x=s,n.y=u,n.z=c,n.w=l,n},l.multiplyByPointAsVector=function(e,t,n){var r=t.x,i=t.y,a=t.z,o=e[0]*r+e[4]*i+e[8]*a,s=e[1]*r+e[5]*i+e[9]*a,u=e[2]*r+e[6]*i+e[10]*a;return n.x=o,n.y=s,n.z=u,n},l.multiplyByPoint=function(e,t,n){var r=t.x,i=t.y,a=t.z,o=e[0]*r+e[4]*i+e[8]*a+e[12],s=e[1]*r+e[5]*i+e[9]*a+e[13],u=e[2]*r+e[6]*i+e[10]*a+e[14];return n.x=o,n.y=s,n.z=u,n},l.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n},l.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},l.transpose=function(e,t){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[10]=e[10],t[11]=e[14],t[12]=i,t[13]=o,t[14]=s,t[15]=e[15],t},l.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},l.equals=function(e,t){return e===t||i(e)&&i(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},l.equalsEpsilon=function(e,t,n){return e===t||i(e)&&i(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n},l.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t},l.getRotation=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var v=new u,g=new u,y=new t,E=new t(0,0,0,1);return l.inverse=function(e,n){if(u.equalsEpsilon(l.getRotation(e,v),g,s.EPSILON7)&&t.equals(l.getRow(e,3,y),E))return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=-e[12],n[13]=-e[13],n[14]=-e[14],n[15]=1,n;var r=e[0],i=e[4],a=e[8],o=e[12],f=e[1],d=e[5],m=e[9],h=e[13],p=e[2],_=e[6],T=e[10],C=e[14],S=e[3],A=e[7],x=e[11],w=e[15],R=T*w,b=C*x,I=_*w,O=C*A,D=_*x,P=T*A,M=p*w,N=C*S,z=p*x,F=T*S,L=p*A,B=_*S,U=R*d+O*m+D*h-(b*d+I*m+P*h),G=b*f+M*m+F*h-(R*f+N*m+z*h),V=I*f+N*d+L*h-(O*f+M*d+B*h),k=P*f+z*d+B*m-(D*f+F*d+L*m),q=b*i+I*a+P*o-(R*i+O*a+D*o),H=R*r+N*a+z*o-(b*r+M*a+F*o),W=O*r+M*i+B*o-(I*r+N*i+L*o),Y=D*r+F*i+L*a-(P*r+z*i+B*a);R=a*h,b=o*m,I=i*h,O=o*d,D=i*m,P=a*d,M=r*h,N=o*f,z=r*m,F=a*f,L=r*d,B=i*f;var X=R*A+O*x+D*w-(b*A+I*x+P*w),j=b*S+M*x+F*w-(R*S+N*x+z*w),Z=I*S+N*A+L*w-(O*S+M*A+B*w),K=P*S+z*A+B*x-(D*S+F*A+L*x),J=I*T+P*C+b*_-(D*C+R*_+O*T),Q=z*C+R*p+N*T-(M*T+F*C+b*p),$=M*_+B*C+O*p-(L*C+I*p+N*_),ee=L*T+D*p+F*_-(z*_+B*T+P*p),te=r*U+i*G+a*V+o*k;if(Math.abs(te)<s.EPSILON20)throw new c("matrix is not invertible because its determinate is zero.");return te=1/te,n[0]=U*te,n[1]=G*te,n[2]=V*te,n[3]=k*te,n[4]=q*te,n[5]=H*te,n[6]=W*te,n[7]=Y*te,n[8]=X*te,n[9]=j*te,n[10]=Z*te,n[11]=K*te,n[12]=J*te,n[13]=Q*te,n[14]=$*te,n[15]=ee*te,n},l.inverseTransformation=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],l=e[10],f=e[12],d=e[13],m=e[14],h=-n*f-r*d-i*m,p=-a*f-o*d-s*m,_=-u*f-c*d-l*m;return t[0]=n,t[1]=a,t[2]=u,t[3]=0,t[4]=r,t[5]=o,t[6]=c,t[7]=0,t[8]=i,t[9]=s,t[10]=l,t[11]=0,t[12]=h,t[13]=p,t[14]=_,t[15]=1,t},l.IDENTITY=o(new l(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),l.ZERO=o(new l(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),l.COLUMN0ROW0=0,l.COLUMN0ROW1=1,l.COLUMN0ROW2=2,l.COLUMN0ROW3=3,l.COLUMN1ROW0=4,l.COLUMN1ROW1=5,l.COLUMN1ROW2=6,l.COLUMN1ROW3=7,l.COLUMN2ROW0=8,l.COLUMN2ROW1=9,l.COLUMN2ROW2=10,l.COLUMN2ROW3=11,l.COLUMN3ROW0=12,l.COLUMN3ROW1=13,l.COLUMN3ROW2=14,l.COLUMN3ROW3=15,a(l.prototype,{length:{get:function(){return l.packedLength}}}),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)},l.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"},l}),define("Core/Rectangle",["./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./freezeObject","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i){this.west=n(e,0),this.south=n(t,0),this.east=n(r,0),this.north=n(i,0)}i(u.prototype,{width:{get:function(){return u.computeWidth(this)}},height:{get:function(){return u.computeHeight(this)}}}),u.packedLength=4,u.pack=function(e,t,r){return r=n(r,0),t[r++]=e.west,t[r++]=e.south,t[r++]=e.east,t[r]=e.north,t},u.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new u),i.west=e[t++],i.south=e[t++],i.east=e[t++],i.north=e[t],i},u.computeWidth=function(e){var t=e.east,n=e.west;return t<n&&(t+=s.TWO_PI),t-n},u.computeHeight=function(e){return e.north-e.south},u.fromDegrees=function(e,t,i,a,o){return e=s.toRadians(n(e,0)),t=s.toRadians(n(t,0)),i=s.toRadians(n(i,0)),a=s.toRadians(n(a,0)),r(o)?(o.west=e,o.south=t,o.east=i,o.north=a,o):new u(e,t,i,a)},u.fromRadians=function(e,t,i,a,o){return r(o)?(o.west=n(e,0),o.south=n(t,0),o.east=n(i,0),o.north=n(a,0),o):new u(e,t,i,a)},u.fromCartographicArray=function(e,t){for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,a=Number.MAX_VALUE,o=-Number.MAX_VALUE,c=Number.MAX_VALUE,l=-Number.MAX_VALUE,f=0,d=e.length;f<d;f++){var m=e[f];n=Math.min(n,m.longitude),i=Math.max(i,m.longitude),c=Math.min(c,m.latitude),l=Math.max(l,m.latitude);var h=m.longitude>=0?m.longitude:m.longitude+s.TWO_PI;a=Math.min(a,h),o=Math.max(o,h)}return i-n>o-a&&(n=a,i=o,i>s.PI&&(i-=s.TWO_PI),n>s.PI&&(n-=s.TWO_PI)),r(t)?(t.west=n,t.south=c,t.east=i,t.north=l,t):new u(n,c,i,l)},u.fromCartesianArray=function(e,t,i){t=n(t,a.WGS84);for(var o=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=Number.MAX_VALUE,f=-Number.MAX_VALUE,d=Number.MAX_VALUE,m=-Number.MAX_VALUE,h=0,p=e.length;h<p;h++){var _=t.cartesianToCartographic(e[h]);o=Math.min(o,_.longitude),c=Math.max(c,_.longitude),d=Math.min(d,_.latitude),m=Math.max(m,_.latitude);var v=_.longitude>=0?_.longitude:_.longitude+s.TWO_PI;l=Math.min(l,v),f=Math.max(f,v)}return c-o>f-l&&(o=l,c=f,c>s.PI&&(c-=s.TWO_PI),o>s.PI&&(o-=s.TWO_PI)),r(i)?(i.west=o,i.south=d,i.east=c,i.north=m,i):new u(o,d,c,m)},u.clone=function(e,t){if(r(e))return r(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new u(e.west,e.south,e.east,e.north)},u.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n},u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.validate=function(e){},u.southwest=function(t,n){return r(n)?(n.longitude=t.west,n.latitude=t.south,n.height=0,n):new e(t.west,t.south)},u.northwest=function(t,n){return r(n)?(n.longitude=t.west,n.latitude=t.north,n.height=0,n):new e(t.west,t.north)},u.northeast=function(t,n){return r(n)?(n.longitude=t.east,n.latitude=t.north,n.height=0,n):new e(t.east,t.north)},u.southeast=function(t,n){return r(n)?(n.longitude=t.east,n.latitude=t.south,n.height=0,n):new e(t.east,t.south)},u.center=function(t,n){var i=t.east,a=t.west;i<a&&(i+=s.TWO_PI);var o=s.negativePiToPi(.5*(a+i)),u=.5*(t.south+t.north);return r(n)?(n.longitude=o,n.latitude=u,n.height=0,n):new e(o,u)},u.intersection=function(e,t,n){var i=e.east,a=e.west,o=t.east,c=t.west;i<a&&o>0?i+=s.TWO_PI:o<c&&i>0&&(o+=s.TWO_PI),i<a&&c<0?c+=s.TWO_PI:o<c&&a<0&&(a+=s.TWO_PI);var l=s.negativePiToPi(Math.max(a,c)),f=s.negativePiToPi(Math.min(i,o));if(!((e.west<e.east||t.west<t.east)&&f<=l)){var d=Math.max(e.south,t.south),m=Math.min(e.north,t.north);if(!(d>=m))return r(n)?(n.west=l,n.south=d,n.east=f,n.north=m,n):new u(l,d,f,m)}},u.simpleIntersection=function(e,t,n){var i=Math.max(e.west,t.west),a=Math.max(e.south,t.south),o=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(a>=s||i>=o))return r(n)?(n.west=i,n.south=a,n.east=o,n.north=s,n):new u(i,a,o,s)},u.union=function(e,t,n){r(n)||(n=new u);var i=e.east,a=e.west,o=t.east,c=t.west;i<a&&o>0?i+=s.TWO_PI:o<c&&i>0&&(o+=s.TWO_PI),i<a&&c<0?c+=s.TWO_PI:o<c&&a<0&&(a+=s.TWO_PI);var l=s.convertLongitudeRange(Math.min(a,c)),f=s.convertLongitudeRange(Math.max(i,o));return n.west=l,n.south=Math.min(e.south,t.south),n.east=f,n.north=Math.max(e.north,t.north),n},u.expand=function(e,t,n){return r(n)||(n=new u),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n},u.contains=function(e,t){var n=t.longitude,r=t.latitude,i=e.west,a=e.east;return a<i&&(a+=s.TWO_PI,n<0&&(n+=s.TWO_PI)),(n>i||s.equalsEpsilon(n,i,s.EPSILON14))&&(n<a||s.equalsEpsilon(n,a,s.EPSILON14))&&r>=e.south&&r<=e.north};var c=new e;return u.subsample=function(e,t,i,o){t=n(t,a.WGS84),i=n(i,0),r(o)||(o=[]);var l=0,f=e.north,d=e.south,m=e.east,h=e.west,p=c;p.height=i,p.longitude=h,p.latitude=f,o[l]=t.cartographicToCartesian(p,o[l]),l++,p.longitude=m,o[l]=t.cartographicToCartesian(p,o[l]),l++,p.latitude=d,o[l]=t.cartographicToCartesian(p,o[l]),l++,p.longitude=h,o[l]=t.cartographicToCartesian(p,o[l]),l++,p.latitude=f<0?f:d>0?d:0;for(var _=1;_<8;++_)p.longitude=-Math.PI+_*s.PI_OVER_TWO,u.contains(e,p)&&(o[l]=t.cartographicToCartesian(p,o[l]),l++);return 0===p.latitude&&(p.longitude=h,o[l]=t.cartographicToCartesian(p,o[l]),l++,p.longitude=m,o[l]=t.cartographicToCartesian(p,o[l]),l++),o.length=l,o},u.MAX_VALUE=o(new u(-Math.PI,-s.PI_OVER_TWO,Math.PI,s.PI_OVER_TWO)),u}),define("Core/BoundingSphere",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Math","./Matrix3","./Matrix4","./Rectangle"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function m(t,n){this.center=e.clone(r(t,e.ZERO)),this.radius=r(n,0)}var h=new e,p=new e,_=new e,v=new e,g=new e,y=new e,E=new e,T=new e,C=new e,S=new e,A=new e,x=new e,w=4/3*c.PI;m.fromPoints=function(t,n){if(i(n)||(n=new m),!i(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;var r,a=e.clone(t[0],E),o=e.clone(a,h),s=e.clone(a,p),u=e.clone(a,_),c=e.clone(a,v),l=e.clone(a,g),f=e.clone(a,y),d=t.length;for(r=1;r<d;r++){e.clone(t[r],a);var w=a.x,R=a.y,b=a.z;w<o.x&&e.clone(a,o),w>c.x&&e.clone(a,c),R<s.y&&e.clone(a,s),R>l.y&&e.clone(a,l),b<u.z&&e.clone(a,u),b>f.z&&e.clone(a,f)}var I=e.magnitudeSquared(e.subtract(c,o,T)),O=e.magnitudeSquared(e.subtract(l,s,T)),D=e.magnitudeSquared(e.subtract(f,u,T)),P=o,M=c,N=I;O>N&&(N=O,P=s,M=l),D>N&&(N=D,P=u,M=f);var z=C;z.x=.5*(P.x+M.x),z.y=.5*(P.y+M.y),z.z=.5*(P.z+M.z);var F=e.magnitudeSquared(e.subtract(M,z,T)),L=Math.sqrt(F),B=S;B.x=o.x,B.y=s.y,B.z=u.z;var U=A;U.x=c.x,U.y=l.y,U.z=f.z;var G=e.midpoint(B,U,x),V=0;for(r=0;r<d;r++){e.clone(t[r],a);var k=e.magnitude(e.subtract(a,G,T));k>V&&(V=k);var q=e.magnitudeSquared(e.subtract(a,z,T));if(q>F){var H=Math.sqrt(q);L=.5*(L+H),F=L*L;var W=H-L;z.x=(L*z.x+W*a.x)/H,z.y=(L*z.y+W*a.y)/H,z.z=(L*z.z+W*a.z)/H}}return L<V?(e.clone(z,n.center),n.radius=L):(e.clone(G,n.center),n.radius=V),n};var R=new o,b=new e,I=new e,O=new t,D=new t;m.fromRectangle2D=function(e,t,n){return m.fromRectangleWithHeights2D(e,t,0,0,n)},m.fromRectangleWithHeights2D=function(t,n,a,o,s){if(i(s)||(s=new m),!i(t))return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;n=r(n,R),d.southwest(t,O),O.height=a,d.northeast(t,D),D.height=o;var u=n.project(O,b),c=n.project(D,I),l=c.x-u.x,f=c.y-u.y,h=c.z-u.z;s.radius=.5*Math.sqrt(l*l+f*f+h*h);var p=s.center;return p.x=u.x+.5*l,p.y=u.y+.5*f,p.z=u.z+.5*h,s};var P=[];m.fromRectangle3D=function(t,n,o,s){if(n=r(n,a.WGS84),o=r(o,0),i(s)||(s=new m),!i(t))return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;var u=d.subsample(t,n,o,P);return m.fromPoints(u,s)},m.fromVertices=function(t,n,a,o){if(i(o)||(o=new m),!i(t)||0===t.length)return o.center=e.clone(e.ZERO,o.center),o.radius=0,o;n=r(n,e.ZERO),a=r(a,3);var s=E;s.x=t[0]+n.x,s.y=t[1]+n.y,s.z=t[2]+n.z;var u,c=e.clone(s,h),l=e.clone(s,p),f=e.clone(s,_),d=e.clone(s,v),w=e.clone(s,g),R=e.clone(s,y),b=t.length;for(u=0;u<b;u+=a){var I=t[u]+n.x,O=t[u+1]+n.y,D=t[u+2]+n.z;s.x=I,s.y=O,s.z=D,I<c.x&&e.clone(s,c),I>d.x&&e.clone(s,d),O<l.y&&e.clone(s,l),O>w.y&&e.clone(s,w),D<f.z&&e.clone(s,f),D>R.z&&e.clone(s,R)}var P=e.magnitudeSquared(e.subtract(d,c,T)),M=e.magnitudeSquared(e.subtract(w,l,T)),N=e.magnitudeSquared(e.subtract(R,f,T)),z=c,F=d,L=P;M>L&&(L=M,z=l,F=w),N>L&&(L=N,z=f,F=R);var B=C;B.x=.5*(z.x+F.x),B.y=.5*(z.y+F.y),B.z=.5*(z.z+F.z);var U=e.magnitudeSquared(e.subtract(F,B,T)),G=Math.sqrt(U),V=S;V.x=c.x,V.y=l.y,V.z=f.z;var k=A;k.x=d.x,k.y=w.y,k.z=R.z;var q=e.midpoint(V,k,x),H=0;for(u=0;u<b;u+=a){s.x=t[u]+n.x,s.y=t[u+1]+n.y,s.z=t[u+2]+n.z;var W=e.magnitude(e.subtract(s,q,T));W>H&&(H=W);var Y=e.magnitudeSquared(e.subtract(s,B,T));if(Y>U){var X=Math.sqrt(Y);G=.5*(G+X),U=G*G;var j=X-G;B.x=(G*B.x+j*s.x)/X,B.y=(G*B.y+j*s.y)/X,B.z=(G*B.z+j*s.z)/X}}return G<H?(e.clone(B,o.center),o.radius=G):(e.clone(q,o.center),o.radius=H),o},m.fromEncodedCartesianVertices=function(t,n,r){if(i(r)||(r=new m),!i(t)||!i(n)||t.length!==n.length||0===t.length)return r.center=e.clone(e.ZERO,r.center),r.radius=0,r;var a=E;a.x=t[0]+n[0],a.y=t[1]+n[1],a.z=t[2]+n[2];var o,s=e.clone(a,h),u=e.clone(a,p),c=e.clone(a,_),l=e.clone(a,v),f=e.clone(a,g),d=e.clone(a,y),w=t.length;for(o=0;o<w;o+=3){var R=t[o]+n[o],b=t[o+1]+n[o+1],I=t[o+2]+n[o+2];a.x=R,a.y=b,a.z=I,R<s.x&&e.clone(a,s),R>l.x&&e.clone(a,l),b<u.y&&e.clone(a,u),b>f.y&&e.clone(a,f),I<c.z&&e.clone(a,c),I>d.z&&e.clone(a,d)}var O=e.magnitudeSquared(e.subtract(l,s,T)),D=e.magnitudeSquared(e.subtract(f,u,T)),P=e.magnitudeSquared(e.subtract(d,c,T)),M=s,N=l,z=O;D>z&&(z=D,M=u,N=f),P>z&&(z=P,M=c,N=d);var F=C;F.x=.5*(M.x+N.x),F.y=.5*(M.y+N.y),F.z=.5*(M.z+N.z);var L=e.magnitudeSquared(e.subtract(N,F,T)),B=Math.sqrt(L),U=S;U.x=s.x,U.y=u.y,U.z=c.z;var G=A;G.x=l.x,G.y=f.y,G.z=d.z;var V=e.midpoint(U,G,x),k=0;for(o=0;o<w;o+=3){a.x=t[o]+n[o],a.y=t[o+1]+n[o+1],a.z=t[o+2]+n[o+2];var q=e.magnitude(e.subtract(a,V,T));q>k&&(k=q)
;var H=e.magnitudeSquared(e.subtract(a,F,T));if(H>L){var W=Math.sqrt(H);B=.5*(B+W),L=B*B;var Y=W-B;F.x=(B*F.x+Y*a.x)/W,F.y=(B*F.y+Y*a.y)/W,F.z=(B*F.z+Y*a.z)/W}}return B<k?(e.clone(F,r.center),r.radius=B):(e.clone(V,r.center),r.radius=k),r},m.fromCornerPoints=function(t,n,r){i(r)||(r=new m);var a=e.midpoint(t,n,r.center);return r.radius=e.distance(a,n),r},m.fromEllipsoid=function(t,n){return i(n)||(n=new m),e.clone(e.ZERO,n.center),n.radius=t.maximumRadius,n};var M=new e;m.fromBoundingSpheres=function(t,n){if(i(n)||(n=new m),!i(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;var r=t.length;if(1===r)return m.clone(t[0],n);if(2===r)return m.union(t[0],t[1],n);var a,o=[];for(a=0;a<r;a++)o.push(t[a].center);n=m.fromPoints(o,n);var s=n.center,u=n.radius;for(a=0;a<r;a++){var c=t[a];u=Math.max(u,e.distance(s,c.center,M)+c.radius)}return n.radius=u,n};var N=new e,z=new e,F=new e;m.fromOrientedBoundingBox=function(t,n){i(n)||(n=new m);var r=t.halfAxes,a=l.getColumn(r,0,N),o=l.getColumn(r,1,z),s=l.getColumn(r,2,F);return e.add(a,o,a),e.add(a,s,a),n.center=e.clone(t.center,n.center),n.radius=e.magnitude(a),n},m.clone=function(t,n){if(i(t))return i(n)?(n.center=e.clone(t.center,n.center),n.radius=t.radius,n):new m(t.center,t.radius)},m.packedLength=4,m.pack=function(e,t,n){n=r(n,0);var i=e.center;return t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n]=e.radius,t},m.unpack=function(e,t,n){t=r(t,0),i(n)||(n=new m);var a=n.center;return a.x=e[t++],a.y=e[t++],a.z=e[t++],n.radius=e[t],n};var L=new e,B=new e;m.union=function(t,n,r){i(r)||(r=new m);var a=t.center,o=t.radius,s=n.center,u=n.radius,c=e.subtract(s,a,L),l=e.magnitude(c);if(o>=l+u)return t.clone(r),r;if(u>=l+o)return n.clone(r),r;var f=.5*(o+l+u),d=e.multiplyByScalar(c,(-o+f)/l,B);return e.add(d,a,d),e.clone(d,r.center),r.radius=f,r};var U=new e;m.expand=function(t,n,r){r=m.clone(t,r);var i=e.magnitude(e.subtract(n,r.center,U));return i>r.radius&&(r.radius=i),r},m.intersectPlane=function(t,n){var r=t.center,i=t.radius,a=n.normal,o=e.dot(a,r)+n.distance;return o<-i?s.OUTSIDE:o<i?s.INTERSECTING:s.INSIDE},m.transform=function(e,t,n){return i(n)||(n=new m),n.center=f.multiplyByPoint(t,e.center,n.center),n.radius=f.getMaximumScale(t)*e.radius,n};var G=new e;m.distanceSquaredTo=function(t,n){var r=e.subtract(t.center,n,G);return e.magnitudeSquared(r)-t.radius*t.radius},m.transformWithoutScale=function(e,t,n){return i(n)||(n=new m),n.center=f.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var V=new e;m.computePlaneDistances=function(t,n,r,a){i(a)||(a=new u);var o=e.subtract(t.center,n,V),s=e.dot(r,o);return a.start=s-t.radius,a.stop=s+t.radius,a};for(var k=new e,q=new e,H=new e,W=new e,Y=new e,X=new t,j=new Array(8),Z=0;Z<8;++Z)j[Z]=new e;var K=new o;return m.projectTo2D=function(t,n,i){n=r(n,K);var a=n.ellipsoid,o=t.center,s=t.radius,u=a.geodeticSurfaceNormal(o,k),c=e.cross(e.UNIT_Z,u,q);e.normalize(c,c);var l=e.cross(u,c,H);e.normalize(l,l),e.multiplyByScalar(u,s,u),e.multiplyByScalar(l,s,l),e.multiplyByScalar(c,s,c);var f=e.negate(l,Y),d=e.negate(c,W),h=j,p=h[0];e.add(u,l,p),e.add(p,c,p),p=h[1],e.add(u,l,p),e.add(p,d,p),p=h[2],e.add(u,f,p),e.add(p,d,p),p=h[3],e.add(u,f,p),e.add(p,c,p),e.negate(u,u),p=h[4],e.add(u,l,p),e.add(p,c,p),p=h[5],e.add(u,l,p),e.add(p,d,p),p=h[6],e.add(u,f,p),e.add(p,d,p),p=h[7],e.add(u,f,p),e.add(p,c,p);for(var _=h.length,v=0;v<_;++v){var g=h[v];e.add(o,g,g);var y=a.cartesianToCartographic(g,X);n.project(y,g)}i=m.fromPoints(h,i),o=i.center;var E=o.x,T=o.y,C=o.z;return o.x=C,o.y=E,o.z=T,i},m.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)},m.equals=function(t,n){return t===n||i(t)&&i(n)&&e.equals(t.center,n.center)&&t.radius===n.radius},m.prototype.intersectPlane=function(e){return m.intersectPlane(this,e)},m.prototype.distanceSquaredTo=function(e){return m.distanceSquaredTo(this,e)},m.prototype.computePlaneDistances=function(e,t,n){return m.computePlaneDistances(this,e,t,n)},m.prototype.isOccluded=function(e){return m.isOccluded(this,e)},m.prototype.equals=function(e){return m.equals(this,e)},m.prototype.clone=function(e){return m.clone(this,e)},m.prototype.volume=function(){var e=this.radius;return w*e*e*e},m}),define("Core/Cartesian2",["./Check","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,n){this.x=t(e,0),this.y=t(n,0)}o.fromElements=function(e,t,r){return n(r)?(r.x=e,r.y=t,r):new o(e,t)},o.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t):new o(e.x,e.y)},o.fromCartesian3=o.clone,o.fromCartesian4=o.clone,o.packedLength=2,o.pack=function(e,n,r){return r=t(r,0),n[r++]=e.x,n[r]=e.y,n},o.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new o),i.x=e[r++],i.y=e[r],i},o.packArray=function(e,t){var r=e.length;n(t)?t.length=2*r:t=new Array(2*r);for(var i=0;i<r;++i)o.pack(e[i],t,2*i);return t},o.unpackArray=function(e,t){var r=e.length;n(t)?t.length=r/2:t=new Array(r/2);for(var i=0;i<r;i+=2){var a=i/2;t[a]=o.unpack(e,i,t[a])}return t},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y)},o.minimumComponent=function(e){return Math.min(e.x,e.y)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var s=new o;o.distance=function(e,t){return o.subtract(e,t,s),o.magnitude(s)},o.distanceSquared=function(e,t){return o.subtract(e,t,s),o.magnitudeSquared(s)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n},o.divideComponents=function(e,t,n){return n.x=e.x/t.x,n.y=e.y/t.y,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var u=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,u),r=o.multiplyByScalar(e,1-n,r),o.add(u,r,r)};var c=new o,l=new o;o.angleBetween=function(e,t){return o.normalize(e,c),o.normalize(t,l),a.acosClamped(o.dot(c,l))};var f=new o;return o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,f);return o.abs(n,n),t=n.x<=n.y?o.clone(o.UNIT_X,t):o.clone(o.UNIT_Y,t)},o.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},o.equalsEpsilon=function(e,t,r,i){return e===t||n(e)&&n(t)&&a.equalsEpsilon(e.x,t.x,r,i)&&a.equalsEpsilon(e.y,t.y,r,i)},o.ZERO=i(new o(0,0)),o.UNIT_X=i(new o(1,0)),o.UNIT_Y=i(new o(0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+")"},o}),define("Core/GeographicTilingScheme",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(e){e=n(e,{}),this._ellipsoid=n(e.ellipsoid,a.WGS84),this._rectangle=n(e.rectangle,u.MAX_VALUE),this._projection=new o(this._ellipsoid),this._numberOfLevelZeroTilesX=n(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=n(e.numberOfLevelZeroTilesY,1)}return i(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),c.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},c.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},c.prototype.rectangleToNativeRectangle=function(e,t){var n=s.toDegrees(e.west),i=s.toDegrees(e.south),a=s.toDegrees(e.east),o=s.toDegrees(e.north);return r(t)?(t.west=n,t.south=i,t.east=a,t.north=o,t):new u(n,i,a,o)},c.prototype.tileXYToNativeRectangle=function(e,t,n,r){var i=this.tileXYToRectangle(e,t,n,r);return i.west=s.toDegrees(i.west),i.south=s.toDegrees(i.south),i.east=s.toDegrees(i.east),i.north=s.toDegrees(i.north),i},c.prototype.tileXYToRectangle=function(e,t,n,i){var a=this._rectangle,o=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),c=a.width/o,l=e*c+a.west,f=(e+1)*c+a.west,d=a.height/s,m=a.north-t*d,h=a.north-(t+1)*d;return r(i)||(i=new u(l,h,f,m)),i.west=l,i.south=h,i.east=f,i.north=m,i},c.prototype.positionToTileXY=function(t,n,i){var a=this._rectangle;if(u.contains(a,t)){var o=this.getNumberOfXTilesAtLevel(n),c=this.getNumberOfYTilesAtLevel(n),l=a.width/o,f=a.height/c,d=t.longitude;a.east<a.west&&(d+=s.TWO_PI);var m=(d-a.west)/l|0;m>=o&&(m=o-1);var h=(a.north-t.latitude)/f|0;return h>=c&&(h=c-1),r(i)?(i.x=m,i.y=h,i):new e(m,h)}},c}),define("Core/ApproximateTerrainHeights",["./buildModuleUrl","./defaultValue","./defined","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./Check","./DeveloperError","./Ellipsoid","./GeographicTilingScheme","./Rectangle","./Resource"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function m(e){o.fromRadians(e.east,e.north,0,T[0]),o.fromRadians(e.west,e.north,0,T[1]),o.fromRadians(e.east,e.south,0,T[2]),o.fromRadians(e.west,e.south,0,T[3]);var t,n=0,r=0,i=0,a=0,s=S._terrainHeightsMaxLevel;for(t=0;t<=s;++t){for(var u=!1,c=0;c<4;++c){var l=T[c];if(E.positionToTileXY(l,t,C),0===c)i=C.x,a=C.y;else if(i!==C.x||a!==C.y){u=!0;break}}if(u)break;n=i,r=a}if(0!==t)return{x:n,y:r,level:t>s?s:t-1}}var h=new a,p=new a,_=new o,v=new a,g=new a,y=new r,E=new l,T=[new o,new o,new o,new o],C=new i,S={};return S.initialize=function(){var t=S._initPromise;return n(t)?t:(t=d.fetchJson(e("Assets/approximateTerrainHeights.json")).then(function(e){S._terrainHeights=e}),S._initPromise=t,t)},S.getApproximateTerrainHeights=function(e,r){r=t(r,c.WGS84);var i=m(e),o=S._defaultMinTerrainHeight,s=S._defaultMaxTerrainHeight;if(n(i)){var u=i.level+"-"+i.x+"-"+i.y,l=S._terrainHeights[u];n(l)&&(o=l[0],s=l[1]),r.cartographicToCartesian(f.northeast(e,_),h),r.cartographicToCartesian(f.southwest(e,_),p),a.midpoint(p,h,v);var d=r.scaleToGeodeticSurface(v,g);if(n(d)){var y=a.distance(v,d);o=Math.min(o,-y)}else o=S._defaultMinTerrainHeight}return o=Math.max(S._defaultMinTerrainHeight,o),{minimumTerrainHeight:o,maximumTerrainHeight:s}},S.getInstanceBoundingSphere=function(e,i){i=t(i,c.WGS84);var a=m(e),o=S._defaultMaxTerrainHeight;if(n(a)){var s=a.level+"-"+a.x+"-"+a.y,u=S._terrainHeights[s];n(u)&&(o=u[1])}var l=r.fromRectangle3D(e,i,0);return r.fromRectangle3D(e,i,o,y),r.union(l,y,l)},S._terrainHeightsMaxLevel=6,S._defaultMaxTerrainHeight=9e3,S._defaultMinTerrainHeight=-1e5,S._terrainHeights=void 0,S._initPromise=void 0,S}),define("Core/arrayRemoveDuplicates",["./Check","./defaultValue","./defined","./Math"],function(e,t,n,r){"use strict";function i(e,r,i){if(n(e)){i=t(i,!1);var o=e.length;if(o<2)return e;var s,u,c;for(s=1;s<o&&(u=e[s-1],c=e[s],!r(u,c,a));++s);if(s===o)return i&&r(e[0],e[e.length-1],a)?e.slice(1):e;for(var l=e.slice(0,s);s<o;++s)c=e[s],r(u,c,a)||(l.push(c),u=c);return i&&l.length>1&&r(l[0],l[l.length-1],a)&&l.shift(),l}}var a=r.EPSILON10;return i}),define("Core/WebGLConstants",["./freezeObject"],function(e){"use strict";return e({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047})}),define("Core/ComponentDatatype",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./WebGLConstants"],function(e,t,n,r,i,a){"use strict";if(!r.supportsTypedArrays())return{};var o={BYTE:a.BYTE,UNSIGNED_BYTE:a.UNSIGNED_BYTE,SHORT:a.SHORT,UNSIGNED_SHORT:a.UNSIGNED_SHORT,INT:a.INT,UNSIGNED_INT:a.UNSIGNED_INT,FLOAT:a.FLOAT,DOUBLE:a.DOUBLE};return o.getSizeInBytes=function(e){switch(e){case o.BYTE:return Int8Array.BYTES_PER_ELEMENT;case o.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case o.SHORT:return Int16Array.BYTES_PER_ELEMENT;case o.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case o.INT:return Int32Array.BYTES_PER_ELEMENT;case o.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case o.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case o.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}},o.fromTypedArray=function(e){return e instanceof Int8Array?o.BYTE:e instanceof Uint8Array?o.UNSIGNED_BYTE:e instanceof Int16Array?o.SHORT:e instanceof Uint16Array?o.UNSIGNED_SHORT:e instanceof Int32Array?o.INT:e instanceof Uint32Array?o.UNSIGNED_INT:e instanceof Float32Array?o.FLOAT:e instanceof Float64Array?o.DOUBLE:void 0},o.validate=function(e){return t(e)&&(e===o.BYTE||e===o.UNSIGNED_BYTE||e===o.SHORT||e===o.UNSIGNED_SHORT||e===o.INT||e===o.UNSIGNED_INT||e===o.FLOAT||e===o.DOUBLE)},o.createTypedArray=function(e,t){switch(e){case o.BYTE:return new Int8Array(t);case o.UNSIGNED_BYTE:return new Uint8Array(t);case o.SHORT:return new Int16Array(t);case o.UNSIGNED_SHORT:return new Uint16Array(t);case o.INT:return new Int32Array(t);case o.UNSIGNED_INT:return new Uint32Array(t);case o.FLOAT:return new Float32Array(t);case o.DOUBLE:return new Float64Array(t)}},o.createArrayBufferView=function(t,n,r,i){switch(r=e(r,0),i=e(i,(n.byteLength-r)/o.getSizeInBytes(t)),t){case o.BYTE:return new Int8Array(n,r,i);case o.UNSIGNED_BYTE:return new Uint8Array(n,r,i);case o.SHORT:return new Int16Array(n,r,i);case o.UNSIGNED_SHORT:return new Uint16Array(n,r,i);case o.INT:return new Int32Array(n,r,i);case o.UNSIGNED_INT:return new Uint32Array(n,r,i);case o.FLOAT:return new Float32Array(n,r,i);case o.DOUBLE:return new Float64Array(n,r,i)}},o.fromName=function(e){switch(e){case"BYTE":return o.BYTE;case"UNSIGNED_BYTE":return o.UNSIGNED_BYTE;case"SHORT":return o.SHORT;case"UNSIGNED_SHORT":return o.UNSIGNED_SHORT;case"INT":return o.INT;case"UNSIGNED_INT":return o.UNSIGNED_INT;case"FLOAT":return o.FLOAT;case"DOUBLE":return o.DOUBLE}},i(o)}),define("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){var t=e._uSquared,n=e._ellipsoid.maximumRadius,r=e._ellipsoid.minimumRadius,i=(n-r)/n,a=Math.cos(e._startHeading),o=Math.sin(e._startHeading),s=(1-i)*Math.tan(e._start.latitude),u=1/Math.sqrt(1+s*s),c=u*s,l=Math.atan2(s,a),f=u*o,d=f*f,m=1-d,h=Math.sqrt(m),p=t/4,_=p*p,v=_*p,g=_*_,y=1+p-3*_/4+5*v/4-175*g/64,E=1-p+15*_/8-35*v/8,T=1-3*p+35*_/4,C=1-5*p,S=y*l-E*Math.sin(2*l)*p/2-T*Math.sin(4*l)*_/16-C*Math.sin(6*l)*v/48-5*Math.sin(8*l)*g/512,A=e._constants;A.a=n,A.b=r,A.f=i,A.cosineHeading=a,A.sineHeading=o,A.tanU=s,A.cosineU=u,A.sineU=c,A.sigma=l,A.sineAlpha=f,A.sineSquaredAlpha=d,A.cosineSquaredAlpha=m,A.cosineAlpha=h,A.u2Over4=p,A.u4Over16=_,A.u6Over64=v,A.u8Over256=g,A.a0=y,A.a1=E,A.a2=T,A.a3=C,A.distanceRatio=S}function c(e,t){return e*t*(4+e*(4-3*t))/16}function l(e,t,n,r,i,a,o){var s=c(e,n);return(1-s)*e*t*(r+s*i*(o+s*a*(2*o*o-1)))}function f(e,t,n,r,i,a,o){var u,c,f,d,m,h=(t-n)/t,p=a-r,_=Math.atan((1-h)*Math.tan(i)),v=Math.atan((1-h)*Math.tan(o)),g=Math.cos(_),y=Math.sin(_),E=Math.cos(v),T=Math.sin(v),C=g*E,S=g*T,A=y*T,x=y*E,w=p,R=s.TWO_PI,b=Math.cos(w),I=Math.sin(w);do{b=Math.cos(w),I=Math.sin(w);var O=S-x*b;f=Math.sqrt(E*E*I*I+O*O),c=A+C*b,u=Math.atan2(f,c);var D;0===f?(D=0,d=1):(D=C*I/f,d=1-D*D),R=w,m=c-2*A/d,isNaN(m)&&(m=0),w=p+l(h,D,d,u,f,c,m)}while(Math.abs(w-R)>s.EPSILON12);var P=d*(t*t-n*n)/(n*n),M=1+P*(4096+P*(P*(320-175*P)-768))/16384,N=P*(256+P*(P*(74-47*P)-128))/1024,z=m*m,F=N*f*(m+N*(c*(2*z-1)-N*m*(4*f*f-3)*(4*z-3)/6)/4),L=n*M*(u-F),B=Math.atan2(E*I,S-x*b),U=Math.atan2(g*I,S*b-x);e._distance=L,e._startHeading=B,e._endHeading=U,e._uSquared=P}function d(n,r,i,a){e.normalize(a.cartographicToCartesian(r,p),h),e.normalize(a.cartographicToCartesian(i,p),p);f(n,a.maximumRadius,a.minimumRadius,r.longitude,r.latitude,i.longitude,i.latitude),n._start=t.clone(r,n._start),n._end=t.clone(i,n._end),n._start.height=0,n._end.height=0,u(n)}function m(e,n,a){var s=r(a,o.WGS84);this._ellipsoid=s,this._start=new t,this._end=new t,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,i(e)&&i(n)&&d(this,e,n,s)}var h=new e,p=new e;return a(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}}),m.prototype.setEndPoints=function(e,t){d(this,e,t,this._ellipsoid)},m.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},m.prototype.interpolateUsingSurfaceDistance=function(e,n){var r=this._constants,a=r.distanceRatio+e/r.b,o=Math.cos(2*a),s=Math.cos(4*a),u=Math.cos(6*a),c=Math.sin(2*a),f=Math.sin(4*a),d=Math.sin(6*a),m=Math.sin(8*a),h=a*a,p=a*h,_=r.u8Over256,v=r.u2Over4,g=r.u6Over64,y=r.u4Over16,E=2*p*_*o/3+a*(1-v+7*y/4-15*g/4+579*_/64-(y-15*g/4+187*_/16)*o-(5*g/4-115*_/16)*s-29*_*u/16)+(v/2-y+71*g/32-85*_/16)*c+(5*y/16-5*g/4+383*_/96)*f-h*((g-11*_/2)*c+5*_*f/2)+(29*g/96-29*_/16)*d+539*_*m/1536,T=Math.asin(Math.sin(E)*r.cosineAlpha),C=Math.atan(r.a/r.b*Math.tan(T));E-=r.sigma;var S=Math.cos(2*r.sigma+E),A=Math.sin(E),x=Math.cos(E),w=r.cosineU*x,R=r.sineU*A,b=Math.atan2(A*r.sineHeading,w-R*r.cosineHeading),I=b-l(r.f,r.sineAlpha,r.cosineSquaredAlpha,E,A,x,S);return i(n)?(n.longitude=this._start.longitude+I,n.latitude=C,n.height=0,n):new t(this._start.longitude+I,C,0)},m}),define("Core/EncodedCartesian3",["./Cartesian3","./Check","./defined"],function(e,t,n){"use strict";function r(){this.high=e.clone(e.ZERO),this.low=e.clone(e.ZERO)}r.encode=function(e,t){n(t)||(t={high:0,low:0});var r;return e>=0?(r=65536*Math.floor(e/65536),t.high=r,t.low=e-r):(r=65536*Math.floor(-e/65536),t.high=-r,t.low=e+r),t};var i={high:0,low:0};r.fromCartesian=function(e,t){n(t)||(t=new r);var a=t.high,o=t.low;return r.encode(e.x,i),a.x=i.high,o.x=i.low,r.encode(e.y,i),a.y=i.high,o.y=i.low,r.encode(e.z,i),a.z=i.high,o.z=i.low,t};var a=new r;return r.writeElements=function(e,t,n){r.fromCartesian(e,a);var i=a.high,o=a.low;t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z,t[n+3]=o.x,t[n+4]=o.y,t[n+5]=o.z},r}),define("Core/GeometryOffsetAttribute",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,TOP:1,ALL:2})}),define("Core/GeometryType",["./freezeObject"],function(e){"use strict";return e({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3})}),
define("Core/Matrix2",["./Cartesian2","./Check","./defaultValue","./defined","./defineProperties","./freezeObject"],function(e,t,n,r,i,a){"use strict";function o(e,t,r,i){this[0]=n(e,0),this[1]=n(r,0),this[2]=n(t,0),this[3]=n(i,0)}o.packedLength=4,o.pack=function(e,t,r){return r=n(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t},o.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new o),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i},o.clone=function(e,t){if(r(e))return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new o(e[0],e[2],e[1],e[3])},o.fromArray=function(e,t,i){return t=n(t,0),r(i)||(i=new o),i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],i},o.fromColumnMajorArray=function(e,t){return o.clone(e,t)},o.fromRowMajorArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new o(e[0],e[1],e[2],e[3])},o.fromScale=function(e,t){return r(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new o(e.x,0,0,e.y)},o.fromUniformScale=function(e,t){return r(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new o(e,0,0,e)},o.fromRotation=function(e,t){var n=Math.cos(e),i=Math.sin(e);return r(t)?(t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t):new o(n,-i,i,n)},o.toArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},o.getElementIndex=function(e,t){return 2*e+t},o.getColumn=function(e,t,n){var r=2*t,i=e[r],a=e[r+1];return n.x=i,n.y=a,n},o.setColumn=function(e,t,n,r){r=o.clone(e,r);var i=2*t;return r[i]=n.x,r[i+1]=n.y,r},o.getRow=function(e,t,n){var r=e[t],i=e[t+2];return n.x=r,n.y=i,n},o.setRow=function(e,t,n,r){return r=o.clone(e,r),r[t]=n.x,r[t+2]=n.y,r};var s=new e;o.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],s)),n.y=e.magnitude(e.fromElements(t[2],t[3],s)),n};var u=new e;return o.getMaximumScale=function(t){return o.getScale(t,u),e.maximumComponent(u)},o.multiply=function(e,t,n){var r=e[0]*t[0]+e[2]*t[1],i=e[0]*t[2]+e[2]*t[3],a=e[1]*t[0]+e[3]*t[1],o=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=a,n[2]=i,n[3]=o,n},o.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},o.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},o.multiplyByVector=function(e,t,n){var r=e[0]*t.x+e[2]*t.y,i=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=i,n},o.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},o.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n},o.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},o.transpose=function(e,t){var n=e[0],r=e[2],i=e[1],a=e[3];return t[0]=n,t[1]=r,t[2]=i,t[3]=a,t},o.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},o.equals=function(e,t){return e===t||r(e)&&r(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},o.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},o.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n},o.IDENTITY=a(new o(1,0,0,1)),o.ZERO=a(new o(0,0,0,0)),o.COLUMN0ROW0=0,o.COLUMN0ROW1=1,o.COLUMN1ROW0=2,o.COLUMN1ROW1=3,i(o.prototype,{length:{get:function(){return o.packedLength}}}),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t){return o.equalsEpsilon(this,e,t)},o.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"},o}),define("Core/PrimitiveType",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={POINTS:t.POINTS,LINES:t.LINES,LINE_LOOP:t.LINE_LOOP,LINE_STRIP:t.LINE_STRIP,TRIANGLES:t.TRIANGLES,TRIANGLE_STRIP:t.TRIANGLE_STRIP,TRIANGLE_FAN:t.TRIANGLE_FAN,validate:function(e){return e===n.POINTS||e===n.LINES||e===n.LINE_LOOP||e===n.LINE_STRIP||e===n.TRIANGLES||e===n.TRIANGLE_STRIP||e===n.TRIANGLE_FAN}};return e(n)}),define("Core/Quaternion",["./Cartesian3","./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math","./Matrix3"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,r,i){this.x=n(e,0),this.y=n(t,0),this.z=n(r,0),this.w=n(i,0)}var c=new e;u.fromAxisAngle=function(t,n,i){var a=n/2,o=Math.sin(a);c=e.normalize(t,c);var s=c.x*o,l=c.y*o,f=c.z*o,d=Math.cos(a);return r(i)?(i.x=s,i.y=l,i.z=f,i.w=d,i):new u(s,l,f,d)};var l=[1,2,0],f=new Array(3);u.fromRotationMatrix=function(e,t){var n,i,a,o,c,d=e[s.COLUMN0ROW0],m=e[s.COLUMN1ROW1],h=e[s.COLUMN2ROW2],p=d+m+h;if(p>0)n=Math.sqrt(p+1),c=.5*n,n=.5/n,i=(e[s.COLUMN1ROW2]-e[s.COLUMN2ROW1])*n,a=(e[s.COLUMN2ROW0]-e[s.COLUMN0ROW2])*n,o=(e[s.COLUMN0ROW1]-e[s.COLUMN1ROW0])*n;else{var _=l,v=0;m>d&&(v=1),h>d&&h>m&&(v=2);var g=_[v],y=_[g];n=Math.sqrt(e[s.getElementIndex(v,v)]-e[s.getElementIndex(g,g)]-e[s.getElementIndex(y,y)]+1);var E=f;E[v]=.5*n,n=.5/n,c=(e[s.getElementIndex(y,g)]-e[s.getElementIndex(g,y)])*n,E[g]=(e[s.getElementIndex(g,v)]+e[s.getElementIndex(v,g)])*n,E[y]=(e[s.getElementIndex(y,v)]+e[s.getElementIndex(v,y)])*n,i=-E[0],a=-E[1],o=-E[2]}return r(t)?(t.x=i,t.y=a,t.z=o,t.w=c,t):new u(i,a,o,c)};var d=new u,m=new u,h=new u,p=new u;u.fromHeadingPitchRoll=function(t,n){return p=u.fromAxisAngle(e.UNIT_X,t.roll,d),h=u.fromAxisAngle(e.UNIT_Y,-t.pitch,n),n=u.multiply(h,p,h),m=u.fromAxisAngle(e.UNIT_Z,-t.heading,d),u.multiply(m,n,n)};var _=new e,v=new e,g=new u,y=new u,E=new u;u.packedLength=4,u.pack=function(e,t,r){return r=n(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.z,t[r]=e.w,t},u.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new u),i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3],i},u.packedInterpolationLength=3,u.convertPackedArrayForInterpolation=function(e,t,n,r){u.unpack(e,4*n,E),u.conjugate(E,E);for(var i=0,a=n-t+1;i<a;i++){var o=3*i;u.unpack(e,4*(t+i),g),u.multiply(g,E,g),g.w<0&&u.negate(g,g),u.computeAxis(g,_);var s=u.computeAngle(g);r[o]=_.x*s,r[o+1]=_.y*s,r[o+2]=_.z*s}},u.unpackInterpolationResult=function(t,n,i,a,o){r(o)||(o=new u),e.fromArray(t,0,v);var s=e.magnitude(v);return u.unpack(n,4*a,y),0===s?u.clone(u.IDENTITY,g):u.fromAxisAngle(v,s,g),u.multiply(g,y,o)},u.clone=function(e,t){if(r(e))return r(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new u(e.x,e.y,e.z,e.w)},u.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},u.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},u.magnitude=function(e){return Math.sqrt(u.magnitudeSquared(e))},u.normalize=function(e,t){var n=1/u.magnitude(e),r=e.x*n,i=e.y*n,a=e.z*n,o=e.w*n;return t.x=r,t.y=i,t.z=a,t.w=o,t},u.inverse=function(e,t){var n=u.magnitudeSquared(e);return t=u.conjugate(e,t),u.multiplyByScalar(t,1/n,t)},u.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},u.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},u.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},u.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},u.multiply=function(e,t,n){var r=e.x,i=e.y,a=e.z,o=e.w,s=t.x,u=t.y,c=t.z,l=t.w,f=o*s+r*l+i*c-a*u,d=o*u-r*c+i*l+a*s,m=o*c+r*u-i*s+a*l,h=o*l-r*s-i*u-a*c;return n.x=f,n.y=d,n.z=m,n.w=h,n},u.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},u.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},u.computeAxis=function(e,t){var n=e.w;if(Math.abs(n-1)<o.EPSILON6)return t.x=t.y=t.z=0,t;var r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t},u.computeAngle=function(e){return Math.abs(e.w-1)<o.EPSILON6?0:2*Math.acos(e.w)};var T=new u;u.lerp=function(e,t,n,r){return T=u.multiplyByScalar(t,n,T),r=u.multiplyByScalar(e,1-n,r),u.add(T,r,r)};var C=new u,S=new u,A=new u;u.slerp=function(e,t,n,r){var i=u.dot(e,t),a=t;if(i<0&&(i=-i,a=C=u.negate(t,C)),1-i<o.EPSILON6)return u.lerp(e,a,n,r);var s=Math.acos(i);return S=u.multiplyByScalar(e,Math.sin((1-n)*s),S),A=u.multiplyByScalar(a,Math.sin(n*s),A),r=u.add(S,A,r),u.multiplyByScalar(r,1/Math.sin(s),r)},u.log=function(t,n){var r=o.acosClamped(t.w),i=0;return 0!==r&&(i=r/Math.sin(r)),e.multiplyByScalar(t,i,n)},u.exp=function(t,n){var r=e.magnitude(t),i=0;return 0!==r&&(i=Math.sin(r)/r),n.x=t.x*i,n.y=t.y*i,n.z=t.z*i,n.w=Math.cos(r),n};var x=new e,w=new e,R=new u,b=new u;u.computeInnerQuadrangle=function(t,n,r,i){var a=u.conjugate(n,R);u.multiply(a,r,b);var o=u.log(b,x);u.multiply(a,t,b);var s=u.log(b,w);return e.add(o,s,o),e.multiplyByScalar(o,.25,o),e.negate(o,o),u.exp(o,R),u.multiply(n,R,i)},u.squad=function(e,t,n,r,i,a){var o=u.slerp(e,t,i,R),s=u.slerp(n,r,i,b);return u.slerp(o,s,2*i*(1-i),a)};for(var I=new u,O=1.9011074535173003,D=i.supportsTypedArrays()?new Float32Array(8):[],P=i.supportsTypedArrays()?new Float32Array(8):[],M=i.supportsTypedArrays()?new Float32Array(8):[],N=i.supportsTypedArrays()?new Float32Array(8):[],z=0;z<7;++z){var F=z+1,L=2*F+1;D[z]=1/(F*L),P[z]=F/L}return D[7]=O/136,P[7]=8*O/17,u.fastSlerp=function(e,t,n,r){var i,a=u.dot(e,t);a>=0?i=1:(i=-1,a=-a);for(var o=a-1,s=1-n,c=n*n,l=s*s,f=7;f>=0;--f)M[f]=(D[f]*c-P[f])*o,N[f]=(D[f]*l-P[f])*o;var d=i*n*(1+M[0]*(1+M[1]*(1+M[2]*(1+M[3]*(1+M[4]*(1+M[5]*(1+M[6]*(1+M[7])))))))),m=s*(1+N[0]*(1+N[1]*(1+N[2]*(1+N[3]*(1+N[4]*(1+N[5]*(1+N[6]*(1+N[7])))))))),h=u.multiplyByScalar(e,m,I);return u.multiplyByScalar(t,d,r),u.add(h,r,r)},u.fastSquad=function(e,t,n,r,i,a){var o=u.fastSlerp(e,t,i,R),s=u.fastSlerp(n,r,i,b);return u.fastSlerp(o,s,2*i*(1-i),a)},u.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},u.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n},u.ZERO=a(new u(0,0,0,0)),u.IDENTITY=a(new u(0,0,0,1)),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},u}),define("Core/binarySearch",["./Check"],function(e){"use strict";function t(e,t,n){for(var r,i,a=0,o=e.length-1;a<=o;)if(r=~~((a+o)/2),(i=n(e[r],t))<0)a=r+1;else{if(!(i>0))return r;o=r-1}return~(o+1)}return t}),define("Core/EarthOrientationParametersSample",[],function(){"use strict";function e(e,t,n,r,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=i}return e}),define("ThirdParty/sprintf",[],function(){function e(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,n=0,r=t[n++],i=function(e,t,n,r){n||(n=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+i:i+e},a=function(e,t,n,r,a,o){var s=r-e.length;return s>0&&(e=n||!a?i(e,r,o,n):e.slice(0,t.length)+i("",s,"0",!0)+e.slice(t.length)),e},o=function(e,t,n,r,o,s,u){var c=e>>>0;return n=n&&c&&{2:"0b",8:"0",16:"0x"}[t]||"",e=n+i(c.toString(t),s||0,"0",!1),a(e,n,r,o,u)},s=function(e,t,n,r,i,o){return null!=r&&(e=e.slice(0,r)),a(e,"",t,n,i,o)},u=function(e,r,u,c,l,f,d){var m,h,p,_,v;if("%%"==e)return"%";for(var g=!1,y="",E=!1,T=!1,C=" ",S=u.length,A=0;u&&A<S;A++)switch(u.charAt(A)){case" ":y=" ";break;case"+":y="+";break;case"-":g=!0;break;case"'":C=u.charAt(A+1);break;case"0":E=!0;break;case"#":T=!0}if(c=c?"*"==c?+t[n++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:0,c<0&&(c=-c,g=!0),!isFinite(c))throw new Error("sprintf: (minimum-)width must be finite");switch(f=f?"*"==f?+t[n++]:"*"==f.charAt(0)?+t[f.slice(1,-1)]:+f:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,v=r?t[r.slice(0,-1)]:t[n++],d){case"s":return s(String(v),g,c,f,E,C);case"c":return s(String.fromCharCode(+v),g,c,f,E);case"b":return o(v,2,T,g,c,f,E);case"o":return o(v,8,T,g,c,f,E);case"x":return o(v,16,T,g,c,f,E);case"X":return o(v,16,T,g,c,f,E).toUpperCase();case"u":return o(v,10,T,g,c,f,E);case"i":case"d":return m=+v||0,m=Math.round(m-m%1),h=m<0?"-":y,v=h+i(String(Math.abs(m)),f,"0",!1),a(v,h,g,c,E);case"e":case"E":case"f":case"F":case"g":case"G":return m=+v,h=m<0?"-":y,p=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],_=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],v=h+Math.abs(m)[p](f),a(v,h,g,c,E)[_]();default:return e}};return r.replace(e,u)}return e}),define("Core/GregorianDate",[],function(){"use strict";function e(e,t,n,r,i,a,o,s){this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=i,this.second=a,this.millisecond=o,this.isLeapSecond=s}return e}),define("Core/isLeapYear",["./DeveloperError"],function(e){"use strict";function t(e){return e%4==0&&e%100!=0||e%400==0}return t}),define("Core/LeapSecond",[],function(){"use strict";function e(e,t){this.julianDate=e,this.offset=t}return e}),define("Core/TimeConstants",["./freezeObject"],function(e){"use strict";return e({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5})}),define("Core/TimeStandard",["./freezeObject"],function(e){"use strict";return e({UTC:0,TAI:1})}),define("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t){return p.compare(e.julianDate,t.julianDate)}function f(e){g.julianDate=e;var n=p.leapSeconds,r=t(n,g,l);r<0&&(r=~r),r>=n.length&&(r=n.length-1);var i=n[r].offset;if(r>0){p.secondsDifference(n[r].julianDate,e)>i&&(r--,i=n[r].offset)}p.addSeconds(e,i,e)}function d(e,n){g.julianDate=e;var r=p.leapSeconds,i=t(r,g,l);if(i<0&&(i=~i),0===i)return p.addSeconds(e,-r[0].offset,n);if(i>=r.length)return p.addSeconds(e,-r[i-1].offset,n);var a=p.secondsDifference(r[i].julianDate,e);return 0===a?p.addSeconds(e,-r[i].offset,n):a<=1?void 0:p.addSeconds(e,-r[--i].offset,n)}function m(e,t,n){var r=t/u.SECONDS_PER_DAY|0;return e+=r,t-=u.SECONDS_PER_DAY*r,t<0&&(e--,t+=u.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function h(e,t,n,r,i,a,o){var s=(t-14)/12|0,c=e+4800+s,l=(1461*c/4|0)+(367*(t-2-12*s)/12|0)-(3*((c+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);var f=a+(r*u.SECONDS_PER_HOUR+i*u.SECONDS_PER_MINUTE+o*u.SECONDS_PER_MILLISECOND);return f>=43200&&(l-=1),[l,f]}function p(e,t,r){this.dayNumber=void 0,this.secondsOfDay=void 0,e=n(e,0),t=n(t,0),r=n(r,c.UTC);var i=0|e;t+=(e-i)*u.SECONDS_PER_DAY,m(i,t,this),r===c.UTC&&f(this)}var _=new a,v=[31,28,31,30,31,30,31,31,30,31,30,31],g=new s,y=/^(\d{4})$/,E=/^(\d{4})-(\d{2})$/,T=/^(\d{4})-?(\d{3})$/,C=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,S=/^(\d{4})-?(\d{2})-?(\d{2})$/,A=/([Z+\-])?(\d{2})?:?(\d{2})?$/,x=/^(\d{2})(\.\d+)?/.source+A.source,w=/^(\d{2}):?(\d{2})(\.\d+)?/.source+A.source,R=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+A.source;p.fromGregorianDate=function(e,t){var n=h(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return r(t)?(m(n[0],n[1],t),f(t),t):new p(n[0],n[1],c.UTC)},p.fromDate=function(e,t){var n=h(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return r(t)?(m(n[0],n[1],t),f(t),t):new p(n[0],n[1],c.UTC)},p.fromIso8601=function(e,t){e=e.replace(",",".");var n,i,a,s=e.split("T"),u=1,l=1,d=0,_=0,g=0,A=0,b=s[0],I=s[1];if(null!==(s=b.match(S)))n=+s[1],u=+s[2],l=+s[3];else if(null!==(s=b.match(E)))n=+s[1],u=+s[2];else if(null!==(s=b.match(y)))n=+s[1];else{var O;if(null!==(s=b.match(T)))n=+s[1],O=+s[2],a=o(n);else if(null!==(s=b.match(C))){n=+s[1];var D=+s[2],P=+s[3]||0,M=new Date(Date.UTC(n,0,4));O=7*D+P-M.getUTCDay()-3}i=new Date(Date.UTC(n,0,1)),i.setUTCDate(O),u=i.getUTCMonth()+1,l=i.getUTCDate()}a=o(n);var N;if(r(I)){s=I.match(R),null!==s?(d=+s[1],_=+s[2],g=+s[3],A=1e3*+(s[4]||0),N=5):(s=I.match(w),null!==s?(d=+s[1],_=+s[2],g=60*+(s[3]||0),N=4):null!==(s=I.match(x))&&(d=+s[1],_=60*+(s[2]||0),N=3));var z=s[N],F=+s[N+1],L=+(s[N+2]||0);switch(z){case"+":d-=F,_-=L;break;case"-":d+=F,_+=L;break;case"Z":break;default:_+=new Date(Date.UTC(n,u-1,l,d,_)).getTimezoneOffset()}}var B=60===g;for(B&&g--;_>=60;)_-=60,d++;for(;d>=24;)d-=24,l++;for(i=a&&2===u?29:v[u-1];l>i;)l-=i,u++,u>12&&(u-=12,n++),i=a&&2===u?29:v[u-1];for(;_<0;)_+=60,d--;for(;d<0;)d+=24,l--;for(;l<1;)u--,u<1&&(u+=12,n--),i=a&&2===u?29:v[u-1],l+=i;var U=h(n,u,l,d,_,g,A);return r(t)?(m(U[0],U[1],t),f(t)):t=new p(U[0],U[1],c.UTC),B&&p.addSeconds(t,1,t),t},p.now=function(e){return p.fromDate(new Date,e)};var b=new p(0,0,c.TAI);return p.toGregorianDate=function(e,t){var n=!1,i=d(e,b);r(i)||(p.addSeconds(e,-1,b),i=d(b,b),n=!0);var o=i.dayNumber,s=i.secondsOfDay;s>=43200&&(o+=1);var c=o+68569|0,l=4*c/146097|0;c=c-((146097*l+3)/4|0)|0;var f=4e3*(c+1)/1461001|0;c=c-(1461*f/4|0)+31|0;var m=80*c/2447|0,h=c-(2447*m/80|0)|0;c=m/11|0;var _=m+2-12*c|0,v=100*(l-49)+f+c|0,g=s/u.SECONDS_PER_HOUR|0,y=s-g*u.SECONDS_PER_HOUR,E=y/u.SECONDS_PER_MINUTE|0;y-=E*u.SECONDS_PER_MINUTE;var T=0|y,C=(y-T)/u.SECONDS_PER_MILLISECOND;return g+=12,g>23&&(g-=24),n&&(T+=1),r(t)?(t.year=v,t.month=_,t.day=h,t.hour=g,t.minute=E,t.second=T,t.millisecond=C,t.isLeapSecond=n,t):new a(v,_,h,g,E,T,C,n)},p.toDate=function(e){var t=p.toGregorianDate(e,_),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},p.toIso8601=function(t,n){var i=p.toGregorianDate(t,_),a=i.year,o=i.month,s=i.day,u=i.hour,c=i.minute,l=i.second,f=i.millisecond;1e4===a&&1===o&&1===s&&0===u&&0===c&&0===l&&0===f&&(a=9999,o=12,s=31,u=24);var d;return r(n)||0===f?r(n)&&0!==n?(d=(.01*f).toFixed(n).replace(".","").slice(0,n),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a,o,s,u,c,l,d)):e("%04d-%02d-%02dT%02d:%02d:%02dZ",a,o,s,u,c,l):(d=(.01*f).toString().replace(".",""),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",a,o,s,u,c,l,d))},p.clone=function(e,t){if(r(e))return r(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new p(e.dayNumber,e.secondsOfDay,c.TAI)},p.compare=function(e,t){var n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},p.equals=function(e,t){return e===t||r(e)&&r(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},p.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(p.secondsDifference(e,t))<=n},p.totalDays=function(e){return e.dayNumber+e.secondsOfDay/u.SECONDS_PER_DAY},p.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*u.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},p.daysDifference=function(e,t){return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/u.SECONDS_PER_DAY},p.computeTaiMinusUtc=function(e){g.julianDate=e;var n=p.leapSeconds,r=t(n,g,l);return r<0&&(r=~r,--r<0&&(r=0)),n[r].offset},p.addSeconds=function(e,t,n){return m(e.dayNumber,e.secondsOfDay+t,n)},p.addMinutes=function(e,t,n){var r=e.secondsOfDay+t*u.SECONDS_PER_MINUTE;return m(e.dayNumber,r,n)},p.addHours=function(e,t,n){var r=e.secondsOfDay+t*u.SECONDS_PER_HOUR;return m(e.dayNumber,r,n)},p.addDays=function(e,t,n){return m(e.dayNumber+t,e.secondsOfDay,n)},p.lessThan=function(e,t){return p.compare(e,t)<0},p.lessThanOrEquals=function(e,t){return p.compare(e,t)<=0},p.greaterThan=function(e,t){return p.compare(e,t)>0},p.greaterThanOrEquals=function(e,t){return p.compare(e,t)>=0},p.prototype.clone=function(e){return p.clone(this,e)},p.prototype.equals=function(e){return p.equals(this,e)},p.prototype.equalsEpsilon=function(e,t){return p.equalsEpsilon(this,e,t)},p.prototype.toString=function(){return p.toIso8601(this)},p.leapSeconds=[new s(new p(2441317,43210,c.TAI),10),new s(new p(2441499,43211,c.TAI),11),new s(new p(2441683,43212,c.TAI),12),new s(new p(2442048,43213,c.TAI),13),new s(new p(2442413,43214,c.TAI),14),new s(new p(2442778,43215,c.TAI),15),new s(new p(2443144,43216,c.TAI),16),new s(new p(2443509,43217,c.TAI),17),new s(new p(2443874,43218,c.TAI),18),new s(new p(2444239,43219,c.TAI),19),new s(new p(2444786,43220,c.TAI),20),new s(new p(2445151,43221,c.TAI),21),new s(new p(2445516,43222,c.TAI),22),new s(new p(2446247,43223,c.TAI),23),new s(new p(2447161,43224,c.TAI),24),new s(new p(2447892,43225,c.TAI),25),new s(new p(2448257,43226,c.TAI),26),new s(new p(2448804,43227,c.TAI),27),new s(new p(2449169,43228,c.TAI),28),new s(new p(2449534,43229,c.TAI),29),new s(new p(2450083,43230,c.TAI),30),new s(new p(2450630,43231,c.TAI),31),new s(new p(2451179,43232,c.TAI),32),new s(new p(2453736,43233,c.TAI),33),new s(new p(2454832,43234,c.TAI),34),new s(new p(2456109,43235,c.TAI),35),new s(new p(2457204,43236,c.TAI),36),new s(new p(2457754,43237,c.TAI),37)],p}),define("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./Resource","./RuntimeError","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,a,o,s,u,c,l,f){"use strict";function d(t){if(t=n(t,n.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=n(t.addNewLeapSeconds,!0),r(t.data))h(this,t.data);else if(r(t.url)){var i=u.createIfNeeded(t.url),a=this;this._downloadPromise=e(i.fetchJson(),function(e){h(a,e)},function(){a._dataError="An error occurred while retrieving the EOP data from the URL "+i.url+"."})}else h(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function m(e,t){return o.compare(e.julianDate,t)}function h(e,n){if(!r(n.columnNames))return void(e._dataError="Error in loaded EOP data: The columnNames property is required.");if(!r(n.samples))return void(e._dataError="Error in loaded EOP data: The samples property is required.");var i=n.columnNames.indexOf("modifiedJulianDateUtc"),a=n.columnNames.indexOf("xPoleWanderRadians"),u=n.columnNames.indexOf("yPoleWanderRadians"),c=n.columnNames.indexOf("ut1MinusUtcSeconds"),d=n.columnNames.indexOf("xCelestialPoleOffsetRadians"),h=n.columnNames.indexOf("yCelestialPoleOffsetRadians"),p=n.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||a<0||u<0||c<0||d<0||h<0||p<0)return void(e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");var _=e._samples=n.samples,v=e._dates=[];e._dateColumn=i,e._xPoleWanderRadiansColumn=a,e._yPoleWanderRadiansColumn=u,e._ut1MinusUtcSecondsColumn=c,e._xCelestialPoleOffsetRadiansColumn=d,e._yCelestialPoleOffsetRadiansColumn=h,e._taiMinusUtcSecondsColumn=p,e._columnCount=n.columnNames.length,e._lastIndex=void 0;for(var g,y=e._addNewLeapSeconds,E=0,T=_.length;E<T;E+=e._columnCount){var C=_[E+i],S=_[E+p],A=C+l.MODIFIED_JULIAN_DATE_DIFFERENCE,x=new o(A,S,f.TAI);if(v.push(x),y){if(S!==g&&r(g)){var w=o.leapSeconds,R=t(w,x,m);if(R<0){var b=new s(x,S);w.splice(~R,0,b)}}g=S}}}function p(e,t,n,r,i){var a=n*r;i.xPoleWander=t[a+e._xPoleWanderRadiansColumn],i.yPoleWander=t[a+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function _(e,t,n){return t+e*(n-t)}function v(e,t,n,r,i,a,s){var u=e._columnCount;if(a>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;var c=t[i],l=t[a];if(c.equals(l)||r.equals(c))return p(e,n,i,u,s),s;if(r.equals(l))return p(e,n,a,u,s),s;var f=o.secondsDifference(r,c)/o.secondsDifference(l,c),d=i*u,m=a*u,h=n[d+e._ut1MinusUtcSecondsColumn],v=n[m+e._ut1MinusUtcSecondsColumn],g=v-h;if(g>.5||g<-.5){var y=n[d+e._taiMinusUtcSecondsColumn],E=n[m+e._taiMinusUtcSecondsColumn];y!==E&&(l.equals(r)?h=v:v-=E-y)}return s.xPoleWander=_(f,n[d+e._xPoleWanderRadiansColumn],n[m+e._xPoleWanderRadiansColumn]),s.yPoleWander=_(f,n[d+e._yPoleWanderRadiansColumn],n[m+e._yPoleWanderRadiansColumn]),s.xPoleOffset=_(f,n[d+e._xCelestialPoleOffsetRadiansColumn],n[m+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=_(f,n[d+e._yCelestialPoleOffsetRadiansColumn],n[m+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=_(f,h,v),s}return d.NONE=a({getPromiseToLoad:function(){return e()},compute:function(e,t){return r(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new i(0,0,0,0,0),t}}),d.prototype.getPromiseToLoad=function(){return e(this._downloadPromise)},d.prototype.compute=function(e,n){if(r(this._samples)){if(r(n)||(n=new i(0,0,0,0,0)),0===this._samples.length)return n.xPoleWander=0,n.yPoleWander=0,n.xPoleOffset=0,n.yPoleOffset=0,n.ut1MinusUtc=0,n;var a=this._dates,s=this._lastIndex,u=0,l=0;if(r(s)){var f=a[s],d=a[s+1],m=o.lessThanOrEquals(f,e),h=!r(d),p=h||o.greaterThanOrEquals(d,e);if(m&&p)return u=s,!h&&d.equals(e)&&++u,l=u+1,v(this,a,this._samples,e,u,l,n),n}var _=t(a,e,o.compare,this._dateColumn);return _>=0?(_<a.length-1&&a[_+1].equals(e)&&++_,u=_,l=_):(l=~_,(u=l-1)<0&&(u=0)),this._lastIndex=u,v(this,a,this._samples,e,u,l,n),n}if(r(this._dataError))throw new c(this._dataError)},d}),define("Core/Iau2006XysSample",[],function(){"use strict";function e(e,t,n){this.x=e,this.y=t,this.s=n}return e}),define("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./Resource","./TimeStandard"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){e=n(e,n.EMPTY_OBJECT),this._xysFileUrlTemplate=o.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=n(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=n(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new a(this._sampleZeroJulianEphemerisDate,0,s.TAI),this._stepSizeDays=n(e.stepSizeDays,1),this._samplesPerXysFile=n(e.samplesPerXysFile,1e3),this._totalSamples=n(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,r=this._denominators=new Array(t+1),i=this._xTable=new Array(t+1),u=Math.pow(this._stepSizeDays,t),c=0;c<=t;++c){r[c]=u,i[c]=c*this._stepSizeDays;for(var l=0;l<=t;++l)l!==c&&(r[c]*=c-l);r[c]=1/r[c]}this._work=new Array(t+1),this._coef=new Array(t+1)}function c(e,t,n){var r=f;return r.dayNumber=t,r.secondsOfDay=n,a.daysDifference(r,e._sampleZeroDateTT)}function l(n,i){if(n._chunkDownloadsInProgress[i])return n._chunkDownloadsInProgress[i];var a=e.defer();n._chunkDownloadsInProgress[i]=a;var s,u=n._xysFileUrlTemplate;return s=r(u)?u.getDerivedResource({templateValues:{0:i}}):new o({url:t("Assets/IAU2006_XYS/IAU2006_XYS_"+i+".json")}),e(s.fetchJson(),function(e){n._chunkDownloadsInProgress[i]=!1;for(var t=n._samples,r=e.samples,o=i*n._samplesPerXysFile*3,s=0,u=r.length;s<u;++s)t[o+s]=r[s];a.resolve()}),a.promise}var f=new a(0,0,s.TAI);return u.prototype.preload=function(t,n,r,i){var a=c(this,t,n),o=c(this,r,i),s=a/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var f=s/this._samplesPerXysFile|0,d=u/this._samplesPerXysFile|0,m=[],h=f;h<=d;++h)m.push(l(this,h));return e.all(m)},u.prototype.computeXysRadians=function(e,t,n){var a=c(this,e,t);if(!(a<0)){var o=a/this._stepSizeDays|0;if(!(o>=this._totalSamples)){var s=this._interpolationOrder,u=o-(s/2|0);u<0&&(u=0);var f=u+s;f>=this._totalSamples&&(f=this._totalSamples-1,(u=f-s)<0&&(u=0));var d=!1,m=this._samples;if(r(m[3*u])||(l(this,u/this._samplesPerXysFile|0),d=!0),r(m[3*f])||(l(this,f/this._samplesPerXysFile|0),d=!0),!d){r(n)?(n.x=0,n.y=0,n.s=0):n=new i(0,0,0);var h,p,_=a-u*this._stepSizeDays,v=this._work,g=this._denominators,y=this._coef,E=this._xTable;for(h=0;h<=s;++h)v[h]=_-E[h];for(h=0;h<=s;++h){for(y[h]=1,p=0;p<=s;++p)p!==h&&(y[h]*=v[p]);y[h]*=g[h];var T=3*(u+h);n.x+=y[h]*m[T++],n.y+=y[h]*m[T++],n.s+=y[h]*m[T]}return n}}}},u}),define("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y){"use strict";var E={},T={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},C={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},S={},A={east:new n,north:new n,up:new n,west:new n,south:new n,down:new n},x=new n,w=new n,R=new n;E.localFrameToFixedFrameGenerator=function(e,t){if(!T.hasOwnProperty(e)||!T[e].hasOwnProperty(t))throw new u("firstAxis and secondAxis must be east, north, up, west, south or down.");var r,i=T[e][t],a=e+t;return s(S[a])?r=S[a]:(r=function(r,a,u){if(s(u)||(u=new v),p.equalsEpsilon(r.x,0,p.EPSILON14)&&p.equalsEpsilon(r.y,0,p.EPSILON14)){var c=p.sign(r.z);n.unpack(C[e],0,x),"east"!==e&&"west"!==e&&n.multiplyByScalar(x,c,x),n.unpack(C[t],0,w),"east"!==t&&"west"!==t&&n.multiplyByScalar(w,c,w),n.unpack(C[i],0,R),"east"!==i&&"west"!==i&&n.multiplyByScalar(R,c,R)}else{a=o(a,f.WGS84),a.geodeticSurfaceNormal(r,A.up);var l=A.up,d=A.east;d.x=-r.y,d.y=r.x,d.z=0,n.normalize(d,A.east),n.cross(l,d,A.north),n.multiplyByScalar(A.up,-1,A.down),n.multiplyByScalar(A.east,-1,A.west),n.multiplyByScalar(A.north,-1,A.south),x=A[e],w=A[t],R=A[i]}return u[0]=x.x,u[1]=x.y,u[2]=x.z,u[3]=0,u[4]=w.x,u[5]=w.y,u[6]=w.z,u[7]=0,u[8]=R.x,u[9]=R.y,u[10]=R.z,u[11]=0,u[12]=r.x,u[13]=r.y,u[14]=r.z,u[15]=1,u},S[a]=r),r},E.eastNorthUpToFixedFrame=E.localFrameToFixedFrameGenerator("east","north"),E.northEastDownToFixedFrame=E.localFrameToFixedFrameGenerator("north","east"),E.northUpEastToFixedFrame=E.localFrameToFixedFrameGenerator("north","up"),E.northWestUpToFixedFrame=E.localFrameToFixedFrameGenerator("north","west");var b=new g,I=new n(1,1,1),O=new v;E.headingPitchRollToFixedFrame=function(e,t,r,i,a){i=o(i,E.eastNorthUpToFixedFrame);var s=g.fromHeadingPitchRoll(t,b),u=v.fromTranslationQuaternionRotationScale(n.ZERO,s,I,O);return a=i(e,r,a),v.multiply(a,u,a)};var D=new v,P=new _;E.headingPitchRollQuaternion=function(e,t,n,r,i){var a=E.headingPitchRollToFixedFrame(e,t,n,r,D),o=v.getRotation(a,P);return g.fromRotationMatrix(o,i)};var M=p.TWO_PI/86400,N=new h;E.computeTemeToPseudoFixedMatrix=function(e,t){N=h.addSeconds(e,-h.computeTaiMinusUtc(e),N);var n,r=N.dayNumber,i=N.secondsOfDay,a=r-2451545;n=i>=43200?(a+.5)/y.DAYS_PER_JULIAN_CENTURY:(a-.5)/y.DAYS_PER_JULIAN_CENTURY;var o=24110.54841+n*(8640184.812866+n*(.093104+-62e-7*n)),u=o*M%p.TWO_PI,c=72921158553e-15+1.1772758384668e-19*(r-2451545.5),l=(i+.5*y.SECONDS_PER_DAY)%y.SECONDS_PER_DAY,f=u+c*l,d=Math.cos(f),m=Math.sin(f);return s(t)?(t[0]=d,t[1]=-m,t[2]=0,t[3]=m,t[4]=d,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new _(d,m,0,-m,d,0,0,0,1)},E.iau2006XysData=new d,E.earthOrientationParameters=c.NONE;E.preloadIcrfFixed=function(t){var n=t.start.dayNumber,r=t.start.secondsOfDay+32.184,i=t.stop.dayNumber,a=t.stop.secondsOfDay+32.184,o=E.iau2006XysData.preload(n,r,i,a),s=E.earthOrientationParameters.getPromiseToLoad();return e.all([o,s])},E.computeIcrfToFixedMatrix=function(e,t){s(t)||(t=new _);var n=E.computeFixedToIcrfMatrix(e,t);if(s(n))return _.transpose(n,t)}
;var z=new m(0,0,0),F=new l(0,0,0,0,0,0),L=new _,B=new _;E.computeFixedToIcrfMatrix=function(e,t){s(t)||(t=new _);var n=E.earthOrientationParameters.compute(e,F);if(s(n)){var r=e.dayNumber,i=e.secondsOfDay+32.184,a=E.iau2006XysData.computeXysRadians(r,i,z);if(s(a)){var o=a.x+n.xPoleOffset,u=a.y+n.yPoleOffset,c=1/(1+Math.sqrt(1-o*o-u*u)),l=L;l[0]=1-c*o*o,l[3]=-c*o*u,l[6]=o,l[1]=-c*o*u,l[4]=1-c*u*u,l[7]=u,l[2]=-o,l[5]=-u,l[8]=1-c*(o*o+u*u);var f=_.fromRotationZ(-a.s,B),d=_.multiply(l,f,L),m=e.dayNumber,v=e.secondsOfDay-h.computeTaiMinusUtc(e)+n.ut1MinusUtc,g=m-2451545,T=v/y.SECONDS_PER_DAY,C=.779057273264+T+.00273781191135448*(g+T);C=C%1*p.TWO_PI;var S=_.fromRotationZ(C,B),A=_.multiply(d,S,L),x=Math.cos(n.xPoleWander),w=Math.cos(n.yPoleWander),R=Math.sin(n.xPoleWander),b=Math.sin(n.yPoleWander),I=r-2451545+i/y.SECONDS_PER_DAY;I/=36525;var O=-47e-6*I*p.RADIANS_PER_DEGREE/3600,D=Math.cos(O),P=Math.sin(O),M=B;return M[0]=x*D,M[1]=x*P,M[2]=R,M[3]=-w*P+b*R*D,M[4]=w*D+b*R*P,M[5]=-b*x,M[6]=-b*P-w*R*D,M[7]=b*D-w*R*P,M[8]=w*x,_.multiply(A,M,t)}}};var U=new r;E.pointToWindowCoordinates=function(e,t,n,r){return r=E.pointToGLWindowCoordinates(e,t,n,r),r.y=2*t[5]-r.y,r},E.pointToGLWindowCoordinates=function(e,n,i,a){s(a)||(a=new t);var o=U;return v.multiplyByVector(e,r.fromElements(i.x,i.y,i.z,1,o),o),r.multiplyByScalar(o,1/o.w,o),v.multiplyByVector(n,o,o),t.fromCartesian4(o,a)};var G=new n,V=new n,k=new n;E.rotationMatrixFromPositionVelocity=function(e,t,r,i){var a=o(r,f.WGS84).geodeticSurfaceNormal(e,G),u=n.cross(t,a,V);n.equalsEpsilon(u,n.ZERO,p.EPSILON6)&&(u=n.clone(n.UNIT_X,u));var c=n.cross(u,t,k);return n.cross(t,c,u),n.negate(u,u),s(i)||(i=new _),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=u.x,i[4]=u.y,i[5]=u.z,i[6]=c.x,i[7]=c.y,i[8]=c.z,i};var q=new v(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),H=new i,W=new n,Y=new n,X=new _,j=new v,Z=new v;return E.basisTo2D=function(e,t,r){var i=v.getTranslation(t,Y),a=e.ellipsoid,o=a.cartesianToCartographic(i,H),s=e.project(o,W);n.fromElements(s.z,s.x,s.y,s);var u=E.eastNorthUpToFixedFrame(i,a,j),c=v.inverseTransformation(u,Z),l=v.getRotation(t,X),f=v.multiplyByMatrix3(c,l,r);return v.multiply(q,f,r),v.setTranslation(r,s,r),r},E.wgs84To2DModelMatrix=function(e,t,r){var i=e.ellipsoid,a=E.eastNorthUpToFixedFrame(t,i,j),o=v.inverseTransformation(a,Z),s=i.cartesianToCartographic(t,H),u=e.project(s,W);n.fromElements(u.z,u.x,u.y,u);var c=v.fromTranslation(u,j);return v.multiply(q,o,r),v.multiply(c,r,r),r},E}),define("Core/Geometry",["./Cartesian2","./Cartesian3","./Cartographic","./Check","./defaultValue","./defined","./DeveloperError","./GeometryOffsetAttribute","./GeometryType","./Matrix2","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p){"use strict";function _(e){e=i(e,i.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=i(e.primitiveType,d.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=i(e.geometryType,u.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}_.computeNumberOfVertices=function(e){var t=-1;for(var n in e.attributes)if(e.attributes.hasOwnProperty(n)&&a(e.attributes[n])&&a(e.attributes[n].values)){var r=e.attributes[n],i=r.values.length/r.componentsPerAttribute;t=i}return t};var v=new n,g=new t,y=new f,E=[new n,new n,new n],T=[new e,new e,new e],C=[new e,new e,new e],S=new t,A=new m,x=new f,w=new c;return _._textureCoordinateRotationPoints=function(r,i,a,o){var s,u=h.center(o,v),d=n.toCartesian(u,a,g),_=p.eastNorthUpToFixedFrame(d,a,y),R=f.inverse(_,y),b=T,I=E;I[0].longitude=o.west,I[0].latitude=o.south,I[1].longitude=o.west,I[1].latitude=o.north,I[2].longitude=o.east,I[2].latitude=o.south;var O=S;for(s=0;s<3;s++)n.toCartesian(I[s],a,O),O=f.multiplyByPointAsVector(R,O,O),b[s].x=O.x,b[s].y=O.y;var D=m.fromAxisAngle(t.UNIT_Z,-i,A),P=l.fromQuaternion(D,x),M=r.length,N=Number.POSITIVE_INFINITY,z=Number.POSITIVE_INFINITY,F=Number.NEGATIVE_INFINITY,L=Number.NEGATIVE_INFINITY;for(s=0;s<M;s++)O=f.multiplyByPointAsVector(R,r[s],O),O=l.multiplyByVector(P,O,O),N=Math.min(N,O.x),z=Math.min(z,O.y),F=Math.max(F,O.x),L=Math.max(L,O.y);var B=c.fromRotation(i,w),U=C;U[0].x=N,U[0].y=z,U[1].x=N,U[1].y=L,U[2].x=F,U[2].y=z;var G=b[0],V=b[2].x-G.x,k=b[1].y-G.y;for(s=0;s<3;s++){var q=U[s];c.multiplyByVector(B,q,q),q.x=(q.x-G.x)/V,q.y=(q.y-G.y)/k}var H=U[0],W=U[1],Y=U[2],X=new Array(6);return e.pack(H,X),e.pack(W,X,2),e.pack(Y,X,4),X},_}),define("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t){t=e(t,e.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=e(t.normalize,!1),this.values=t.values}return r}),define("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(e,t){"use strict";function n(e,n,r){var i=e+n;return t.sign(e)!==t.sign(n)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(n)))<r?0:i}var r={};return r.computeDiscriminant=function(e,t,n){return t*t-4*e*n},r.computeRealRoots=function(e,r,i){var a;if(0===e)return 0===r?[]:[-i/r];if(0===r){if(0===i)return[0,0];var o=Math.abs(i),s=Math.abs(e);if(o<s&&o/s<t.EPSILON14)return[0,0];if(o>s&&s/o<t.EPSILON14)return[];if((a=-i/e)<0)return[];var u=Math.sqrt(a);return[-u,u]}if(0===i)return a=-r/e,a<0?[a,0]:[0,a];var c=r*r,l=4*e*i,f=n(c,-l,t.EPSILON14);if(f<0)return[];var d=-.5*n(r,t.sign(r)*Math.sqrt(f),t.EPSILON14);return r>0?[d/e,i/d]:[i/d,d/e]},r}),define("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(e,t){"use strict";function n(e,t,n,r){var i,a,o=e,s=t/3,u=n/3,c=r,l=o*u,f=s*c,d=s*s,m=u*u,h=o*u-d,p=o*c-s*u,_=s*c-m,v=4*h*_-p*p;if(v<0){var g,y,E;d*f>=l*m?(g=o,y=h,E=-2*s*h+o*p):(g=c,y=_,E=-c*p+2*u*_);var T=E<0?-1:1,C=-T*Math.abs(g)*Math.sqrt(-v);a=-E+C;var S=a/2,A=S<0?-Math.pow(-S,1/3):Math.pow(S,1/3),x=a===C?-A:-y/A;return i=y<=0?A+x:-E/(A*A+x*x+y),d*f>=l*m?[(i-s)/o]:[-c/(i+u)]}var w=h,R=-2*s*h+o*p,b=_,I=-c*p+2*u*_,O=Math.sqrt(v),D=Math.sqrt(3)/2,P=Math.abs(Math.atan2(o*O,-R)/3);i=2*Math.sqrt(-w);var M=Math.cos(P);a=i*M;var N=i*(-M/2-D*Math.sin(P)),z=a+N>2*s?a-s:N-s,F=o,L=z/F;P=Math.abs(Math.atan2(c*O,-I)/3),i=2*Math.sqrt(-b),M=Math.cos(P),a=i*M,N=i*(-M/2-D*Math.sin(P));var B=-c,U=a+N<2*u?a+u:N+u,G=B/U,V=F*U,k=-z*U-F*B,q=z*B,H=(u*k-s*q)/(-s*k+u*V);return L<=H?L<=G?H<=G?[L,H,G]:[L,G,H]:[G,L,H]:L<=G?[H,L,G]:H<=G?[H,G,L]:[G,H,L]}var r={};return r.computeDiscriminant=function(e,t,n,r){var i=e*e,a=t*t,o=n*n;return 18*e*t*n*r+a*o-27*i*(r*r)-4*(e*o*n+a*t*r)},r.computeRealRoots=function(e,r,i,a){var o,s;if(0===e)return t.computeRealRoots(r,i,a);if(0===r){if(0===i){if(0===a)return[0,0,0];s=-a/e;var u=s<0?-Math.pow(-s,1/3):Math.pow(s,1/3);return[u,u,u]}return 0===a?(o=t.computeRealRoots(e,0,i),0===o.Length?[0]:[o[0],0,o[1]]):n(e,0,i,a)}return 0===i?0===a?(s=-r/e,s<0?[s,0,0]:[0,0,s]):n(e,r,0,a):0===a?(o=t.computeRealRoots(e,r,i),0===o.length?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]):n(e,r,i,a)},r}),define("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(e,t,n,r){"use strict";function i(t,i,a,o){var s=t*t,u=i-3*s/8,c=a-i*t/2+s*t/8,l=o-a*t/4+i*s/16-3*s*s/256,f=e.computeRealRoots(1,2*u,u*u-4*l,-c*c);if(f.length>0){var d=-t/4,m=f[f.length-1];if(Math.abs(m)<n.EPSILON14){var h=r.computeRealRoots(1,u,l);if(2===h.length){var p,_=h[0],v=h[1];if(_>=0&&v>=0){var g=Math.sqrt(_),y=Math.sqrt(v);return[d-y,d-g,d+g,d+y]}if(_>=0&&v<0)return p=Math.sqrt(_),[d-p,d+p];if(_<0&&v>=0)return p=Math.sqrt(v),[d-p,d+p]}return[]}if(m>0){var E=Math.sqrt(m),T=(u+m-c/E)/2,C=(u+m+c/E)/2,S=r.computeRealRoots(1,E,T),A=r.computeRealRoots(1,-E,C);return 0!==S.length?(S[0]+=d,S[1]+=d,0!==A.length?(A[0]+=d,A[1]+=d,S[1]<=A[0]?[S[0],S[1],A[0],A[1]]:A[1]<=S[0]?[A[0],A[1],S[0],S[1]]:S[0]>=A[0]&&S[1]<=A[1]?[A[0],S[0],S[1],A[1]]:A[0]>=S[0]&&A[1]<=S[1]?[S[0],A[0],A[1],S[1]]:S[0]>A[0]&&S[0]<A[1]?[A[0],S[0],A[1],S[1]]:[S[0],A[0],S[1],A[1]]):S):0!==A.length?(A[0]+=d,A[1]+=d,A):[]}}return[]}function a(t,i,a,o){var s=a*a,u=i*i,c=t*t,l=-2*i,f=a*t+u-4*o,d=c*o-a*i*t+s,m=e.computeRealRoots(1,l,f,d);if(m.length>0){var h,p,_=m[0],v=i-_,g=v*v,y=t/2,E=v/2,T=g-4*o,C=g+4*Math.abs(o),S=c-4*_,A=c+4*Math.abs(_);if(_<0||T*A<S*C){var x=Math.sqrt(S);h=x/2,p=0===x?0:(t*E-a)/x}else{var w=Math.sqrt(T);h=0===w?0:(t*E-a)/w,p=w/2}var R,b;0===y&&0===h?(R=0,b=0):n.sign(y)===n.sign(h)?(R=y+h,b=_/R):(b=y-h,R=_/b);var I,O;0===E&&0===p?(I=0,O=0):n.sign(E)===n.sign(p)?(I=E+p,O=o/I):(O=E-p,I=o/O);var D=r.computeRealRoots(1,R,I),P=r.computeRealRoots(1,b,O);if(0!==D.length)return 0!==P.length?D[1]<=P[0]?[D[0],D[1],P[0],P[1]]:P[1]<=D[0]?[P[0],P[1],D[0],D[1]]:D[0]>=P[0]&&D[1]<=P[1]?[P[0],D[0],D[1],P[1]]:P[0]>=D[0]&&P[1]<=D[1]?[D[0],P[0],P[1],D[1]]:D[0]>P[0]&&D[0]<P[1]?[P[0],D[0],P[1],D[1]]:[D[0],P[0],D[1],P[1]]:D;if(0!==P.length)return P}return[]}var o={};return o.computeDiscriminant=function(e,t,n,r,i){var a=e*e,o=a*e,s=t*t,u=s*t,c=n*n,l=c*n,f=r*r,d=f*r,m=i*i;return s*c*f-4*u*d-4*e*l*f+18*e*t*n*d-27*a*f*f+256*o*(m*i)+i*(18*u*n*r-4*s*l+16*e*c*c-80*e*t*c*r-6*e*s*f+144*a*n*f)+m*(144*e*s*n-27*s*s-128*a*c-192*a*t*r)},o.computeRealRoots=function(t,r,o,s,u){if(Math.abs(t)<n.EPSILON15)return e.computeRealRoots(r,o,s,u);var c=r/t,l=o/t,f=s/t,d=u/t,m=c<0?1:0;switch(m+=l<0?m+1:m,m+=f<0?m+1:m,m+=d<0?m+1:m){case 0:return i(c,l,f,d);case 1:case 2:return a(c,l,f,d);case 3:case 4:return i(c,l,f,d);case 5:return a(c,l,f,d);case 6:case 7:return i(c,l,f,d);case 8:return a(c,l,f,d);case 9:case 10:return i(c,l,f,d);case 11:return a(c,l,f,d);case 12:case 13:case 14:case 15:return i(c,l,f,d);default:return}},o}),define("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";function i(n,r){r=e.clone(t(r,e.ZERO)),e.equals(r,e.ZERO)||e.normalize(r,r),this.origin=e.clone(t(n,e.ZERO)),this.direction=r}return i.getPoint=function(t,r,i){return n(i)||(i=new e),i=e.multiplyByScalar(t.direction,r,i),e.add(t.origin,i,i)},i}),define("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Interval","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e,t,n,r){var i=t*t-4*e*n;if(!(i<0)){if(i>0){var a=1/(2*e),o=Math.sqrt(i),s=(-t+o)*a,u=(-t-o)*a;return s<u?(r.root0=s,r.root1=u):(r.root0=u,r.root1=s),r}var c=-t/(2*e);if(0!==c)return r.root0=r.root1=c,r}}function d(t,n,i){r(i)||(i=new a);var o=t.origin,s=t.direction,u=n.center,c=n.radius*n.radius,l=e.subtract(o,u,g),d=e.dot(s,s),m=2*e.dot(s,l),h=e.magnitudeSquared(l)-c,p=f(d,m,h,C);if(r(p))return i.start=p.root0,i.stop=p.root1,i}function m(e,t,n){var r=e+t;return o.sign(e)!==o.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}function h(t,n,r,i,a){var l,f=i*i,d=a*a,h=(t[s.COLUMN1ROW1]-t[s.COLUMN2ROW2])*d,p=a*(i*m(t[s.COLUMN1ROW0],t[s.COLUMN0ROW1],o.EPSILON15)+n.y),_=t[s.COLUMN0ROW0]*f+t[s.COLUMN2ROW2]*d+i*n.x+r,v=d*m(t[s.COLUMN2ROW1],t[s.COLUMN1ROW2],o.EPSILON15),g=a*(i*m(t[s.COLUMN2ROW0],t[s.COLUMN0ROW2])+n.z),y=[];if(0===g&&0===v){if(l=u.computeRealRoots(h,p,_),0===l.length)return y;var E=l[0],T=Math.sqrt(Math.max(1-E*E,0));if(y.push(new e(i,a*E,a*-T)),y.push(new e(i,a*E,a*T)),2===l.length){var C=l[1],S=Math.sqrt(Math.max(1-C*C,0));y.push(new e(i,a*C,a*-S)),y.push(new e(i,a*C,a*S))}return y}var A=g*g,x=v*v,w=h*h,R=g*v,b=w+x,I=2*(p*h+R),O=2*_*h+p*p-x+A,D=2*(_*p-R),P=_*_-A;if(0===b&&0===I&&0===O&&0===D)return y;l=c.computeRealRoots(b,I,O,D,P);var M=l.length;if(0===M)return y;for(var N=0;N<M;++N){var z,F=l[N],L=F*F,B=Math.max(1-L,0),U=Math.sqrt(B);z=o.sign(h)===o.sign(_)?m(h*L+_,p*F,o.EPSILON12):o.sign(_)===o.sign(p*F)?m(h*L,p*F+_,o.EPSILON12):m(h*L+p*F,_,o.EPSILON12);var G=m(v*F,g,o.EPSILON15),V=z*G;V<0?y.push(new e(i,a*F,a*U)):V>0?y.push(new e(i,a*F,a*-U)):0!==U?(y.push(new e(i,a*F,a*-U)),y.push(new e(i,a*F,a*U)),++N):y.push(new e(i,a*F,a*U))}return y}var p={};p.rayPlane=function(t,n,i){r(i)||(i=new e);var a=t.origin,s=t.direction,u=n.normal,c=e.dot(u,s);if(!(Math.abs(c)<o.EPSILON15)){var l=(-n.distance-e.dot(u,a))/c;if(!(l<0))return i=e.multiplyByScalar(s,l,i),e.add(a,i,i)}};var _=new e,v=new e,g=new e,y=new e,E=new e;p.rayTriangleParametric=function(t,r,i,a,s){s=n(s,!1);var u,c,l,f,d,m=t.origin,h=t.direction,p=e.subtract(i,r,_),T=e.subtract(a,r,v),C=e.cross(h,T,g),S=e.dot(p,C);if(s){if(S<o.EPSILON6)return;if(u=e.subtract(m,r,y),(l=e.dot(u,C))<0||l>S)return;if(c=e.cross(u,p,E),(f=e.dot(h,c))<0||l+f>S)return;d=e.dot(T,c)/S}else{if(Math.abs(S)<o.EPSILON6)return;var A=1/S;if(u=e.subtract(m,r,y),(l=e.dot(u,C)*A)<0||l>1)return;if(c=e.cross(u,p,E),(f=e.dot(h,c)*A)<0||l+f>1)return;d=e.dot(T,c)*A}return d},p.rayTriangle=function(t,n,i,a,o,s){var u=p.rayTriangleParametric(t,n,i,a,o);if(r(u)&&!(u<0))return r(s)||(s=new e),e.multiplyByScalar(t.direction,u,s),e.add(t.origin,s,s)};var T=new l;p.lineSegmentTriangle=function(t,n,i,a,o,s,u){var c=T;e.clone(t,c.origin),e.subtract(n,t,c.direction),e.normalize(c.direction,c.direction);var l=p.rayTriangleParametric(c,i,a,o,s);if(!(!r(l)||l<0||l>e.distance(t,n)))return r(u)||(u=new e),e.multiplyByScalar(c.direction,l,u),e.add(c.origin,u,u)};var C={root0:0,root1:0};p.raySphere=function(e,t,n){if(n=d(e,t,n),r(n)&&!(n.stop<0))return n.start=Math.max(n.start,0),n};var S=new l;p.lineSegmentSphere=function(t,n,i,a){var o=S;e.clone(t,o.origin);var s=e.subtract(n,t,o.direction),u=e.magnitude(s);if(e.normalize(s,s),a=d(o,i,a),!(!r(a)||a.stop<0||a.start>u))return a.start=Math.max(a.start,0),a.stop=Math.min(a.stop,u),a};var A=new e,x=new e;p.rayEllipsoid=function(t,n){var r,i,o,s,u,c=n.oneOverRadii,l=e.multiplyComponents(c,t.origin,A),f=e.multiplyComponents(c,t.direction,x),d=e.magnitudeSquared(l),m=e.dot(l,f);if(d>1){if(m>=0)return;var h=m*m;if(r=d-1,i=e.magnitudeSquared(f),o=i*r,h<o)return;if(h>o){s=m*m-o,u=-m+Math.sqrt(s);var p=u/i,_=r/u;return p<_?new a(p,_):{start:_,stop:p}}var v=Math.sqrt(r/i);return new a(v,v)}return d<1?(r=d-1,i=e.magnitudeSquared(f),o=i*r,s=m*m-o,u=-m+Math.sqrt(s),new a(0,u/i)):m<0?(i=e.magnitudeSquared(f),new a(0,-m/i)):void 0};var w=new e,R=new e,b=new e,I=new e,O=new e,D=new s,P=new s,M=new s,N=new s,z=new s,F=new s,L=new s,B=new e,U=new e,G=new t;p.grazingAltitudeLocation=function(t,n){var i=t.origin,a=t.direction;if(!e.equals(i,e.ZERO)){var u=n.geodeticSurfaceNormal(i,w);if(e.dot(a,u)>=0)return i}var c=r(this.rayEllipsoid(t,n)),l=n.transformPositionToScaledSpace(a,w),f=e.normalize(l,l),d=e.mostOrthogonalAxis(l,I),m=e.normalize(e.cross(d,f,R),R),p=e.normalize(e.cross(f,m,b),b),_=D;_[0]=f.x,_[1]=f.y,_[2]=f.z,_[3]=m.x,_[4]=m.y,_[5]=m.z,_[6]=p.x,_[7]=p.y,_[8]=p.z;var v=s.transpose(_,P),g=s.fromScale(n.radii,M),y=s.fromScale(n.oneOverRadii,N),E=z;E[0]=0,E[1]=-a.z,E[2]=a.y,E[3]=a.z,E[4]=0,E[5]=-a.x,E[6]=-a.y,E[7]=a.x,E[8]=0;var T,C,S=s.multiply(s.multiply(v,y,F),E,F),A=s.multiply(s.multiply(S,g,L),_,L),x=s.multiplyByVector(S,i,O),V=h(A,e.negate(x,w),0,0,1),k=V.length;if(k>0){for(var q=e.clone(e.ZERO,U),H=Number.NEGATIVE_INFINITY,W=0;W<k;++W){T=s.multiplyByVector(g,s.multiplyByVector(_,V[W],B),B);var Y=e.normalize(e.subtract(T,i,I),I),X=e.dot(Y,a);X>H&&(H=X,q=e.clone(T,q))}var j=n.cartesianToCartographic(q,G);return H=o.clamp(H,0,1),C=e.magnitude(e.subtract(q,i,I))*Math.sqrt(1-H*H),C=c?-C:C,j.height=C,n.cartographicToCartesian(j,new e)}};var V=new e;return p.lineSegmentPlane=function(t,n,i,a){r(a)||(a=new e);var s=e.subtract(n,t,V),u=i.normal,c=e.dot(u,s);if(!(Math.abs(c)<o.EPSILON6)){var l=e.dot(u,t),f=-(i.distance+l)/c;if(!(f<0||f>1))return e.multiplyByScalar(s,f,a),e.add(t,a,a),a}},p.trianglePlaneIntersection=function(t,n,r,i){var a=i.normal,o=i.distance,s=e.dot(a,t)+o<0,u=e.dot(a,n)+o<0,c=e.dot(a,r)+o<0,l=0;l+=s?1:0,l+=u?1:0,l+=c?1:0;var f,d;if(1!==l&&2!==l||(f=new e,d=new e),1===l){if(s)return p.lineSegmentPlane(t,n,i,f),p.lineSegmentPlane(t,r,i,d),{positions:[t,n,r,f,d],indices:[0,3,4,1,2,4,1,4,3]};if(u)return p.lineSegmentPlane(n,r,i,f),p.lineSegmentPlane(n,t,i,d),{positions:[t,n,r,f,d],indices:[1,3,4,2,0,4,2,4,3]};if(c)return p.lineSegmentPlane(r,t,i,f),p.lineSegmentPlane(r,n,i,d),{positions:[t,n,r,f,d],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===l){if(!s)return p.lineSegmentPlane(n,t,i,f),p.lineSegmentPlane(r,t,i,d),{positions:[t,n,r,f,d],indices:[1,2,4,1,4,3,0,3,4]};if(!u)return p.lineSegmentPlane(r,n,i,f),p.lineSegmentPlane(t,n,i,d),{positions:[t,n,r,f,d],indices:[2,0,4,2,4,3,1,3,4]};if(!c)return p.lineSegmentPlane(t,r,i,f),p.lineSegmentPlane(n,r,i,d),{positions:[t,n,r,f,d],indices:[0,1,4,0,4,3,2,3,4]}}},p}),define("Core/Plane",["./Cartesian3","./Check","./defined","./DeveloperError","./freezeObject","./Math","./Matrix4"],function(e,t,n,r,i,a,o){"use strict";function s(t,n){this.normal=e.clone(t),this.distance=n}s.fromPointNormal=function(t,r,i){var a=-e.dot(r,t);return n(i)?(e.clone(r,i.normal),i.distance=a,i):new s(r,a)};var u=new e;s.fromCartesian4=function(t,r){var i=e.fromCartesian4(t,u),a=t.w;return n(r)?(e.clone(i,r.normal),r.distance=a,r):new s(i,a)},s.getPointDistance=function(t,n){return e.dot(t.normal,n)+t.distance};var c=new e;s.projectPointOntoPlane=function(t,r,i){n(i)||(i=new e);var a=s.getPointDistance(t,r),o=e.multiplyByScalar(t.normal,a,c);return e.subtract(r,o,i)};var l=new e;return s.transform=function(t,n,r){return o.multiplyByPointAsVector(n,t.normal,u),e.normalize(u,u),e.multiplyByScalar(t.normal,-t.distance,l),o.multiplyByPoint(n,l,l),s.fromPointNormal(l,u,r)},s.clone=function(t,r){return n(r)?(e.clone(t.normal,r.normal),r.distance=t.distance,r):new s(t.normal,t.distance)},s.equals=function(t,n){return t.distance===n.distance&&e.equals(t.normal,n.normal)},s.ORIGIN_XY_PLANE=i(new s(e.UNIT_Z,0)),s.ORIGIN_YZ_PLANE=i(new s(e.UNIT_X,0)),s.ORIGIN_ZX_PLANE=i(new s(e.UNIT_Y,0)),s}),define("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){this._ellipsoid=n(e,o.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),u.mercatorAngleToGeodeticLatitude=function(e){return s.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},u.geodeticLatitudeToMercatorAngle=function(e){e>u.MaximumLatitude?e=u.MaximumLatitude:e<-u.MaximumLatitude&&(e=-u.MaximumLatitude);var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},u.MaximumLatitude=u.mercatorAngleToGeodeticLatitude(Math.PI),u.prototype.project=function(t,n){var i=this._semimajorAxis,a=t.longitude*i,o=u.geodeticLatitudeToMercatorAngle(t.latitude)*i,s=t.height;return r(n)?(n.x=a,n.y=o,n.z=s,n):new e(a,o,s)},u.prototype.unproject=function(e,n){var i=this._oneOverSemimajorAxis,a=e.x*i,o=u.mercatorAngleToGeodeticLatitude(e.y*i),s=e.z;return r(n)?(n.longitude=a,n.latitude=o,n.height=s,n):new t(a,o,s)},u}),define("Core/GroundPolylineGeometry",["./ApproximateTerrainHeights","./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./Check","./ComponentDatatype","./DeveloperError","./Math","./defaultValue","./defined","./defineProperties","./Ellipsoid","./EllipsoidGeodesic","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./IntersectionTests","./Matrix3","./Plane","./Quaternion","./Rectangle","./WebMercatorProjection"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S){"use strict";function A(e){e=c(e,c.EMPTY_OBJECT);var t=e.positions;this.width=c(e.width,1),this._positions=t,this.granularity=c(e.granularity,9999),this.loop=c(e.loop,!1),this._ellipsoid=d.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}function x(e,t,n,i,a){var o=R(i,e,0,q),s=R(i,e,n,H),u=R(i,t,0,W),c=b(s,o,H),l=b(u,o,W);return r.cross(l,c,a),r.normalize(a,a)}function w(e,t,n,i,a,o,s,u,c,l){if(0!==a){var f=new m(e,t,o),d=f.surfaceDistance;if(!(d<a))for(var h=x(e,t,i,o,Z),p=Math.ceil(d/a),_=d/p,v=_,g=p-1,y=s.length,E=0;E<g;E++){var T=f.interpolateUsingSurfaceDistance(v,Y),C=R(o,T,n,X),S=R(o,T,i,j);r.pack(h,s,y),r.pack(C,u,y),r.pack(S,c,y),l.push(T.latitude),l.push(T.longitude),y+=3,v+=_}}}function R(e,t,n,r){return i.clone(t,K),K.height=n,i.toCartesian(K,e,r)}function b(e,t,n){return r.subtract(e,t,n),r.normalize(n,n),n}function I(e,t,n,i,a){var o=b(n,t,ne),s=b(e,t,J),c=b(i,t,Q),l=r.cross(o,s,ee);l=r.normalize(l,l);var f=E.fromPointNormal(t,l,te),d=E.getPointDistance(f,i);if(u.equalsEpsilon(d,0,u.EPSILON7))return r.clone(l,a),a;a=r.add(c,s,a),a=r.normalize(a,a);var m=r.cross(o,a,$);return r.normalize(m,m),r.cross(m,o,a),r.normalize(a,a),r.dot(c,m)<re&&(a=r.negate(a,a)),a}function O(e,t,n,i){var a=b(n,t,fe),o=r.dot(a,e);if(o>U||o<G){var s=b(i,n,ne),c=o<G?u.PI_OVER_TWO:-u.PI_OVER_TWO,l=T.fromAxisAngle(s,c,me),f=y.fromQuaternion(l,de);return y.multiplyByVector(f,e,e),!0}return!1}function D(e,t,n,a,o){var s=i.toCartesian(t,e._ellipsoid,pe),c=r.add(s,n,_e),l=!1,f=e._ellipsoid,d=f.cartesianToCartographic(c,he);Math.abs(t.longitude-d.longitude)>u.PI_OVER_TWO&&(l=!0,c=r.subtract(s,n,_e),d=f.cartesianToCartographic(c,he)),d.height=0;var m=e.project(d,o);return o=r.subtract(m,a,o),o.z=0,o=r.normalize(o,o),l&&r.negate(o,o),o}function P(e,t,n,i,a,o){var s=r.subtract(t,e,ve);r.normalize(s,s);var u=n-V,c=r.multiplyByScalar(s,u,ge);r.add(e,c,a);var l=i-k;c=r.multiplyByScalar(s,l,ge),r.add(t,c,o)}function M(e,t){var n=E.getPointDistance(ie,e),i=E.getPointDistance(ie,t),a=ye;u.equalsEpsilon(n,0,u.EPSILON2)?(a=b(t,e,a),r.multiplyByScalar(a,u.EPSILON2,a),r.add(e,a,e)):u.equalsEpsilon(i,0,u.EPSILON2)&&(a=b(e,t,a),r.multiplyByScalar(a,u.EPSILON2,a),r.add(t,a,t))}function N(e,t){var n=Math.abs(e.longitude),r=Math.abs(t.longitude);if(u.equalsEpsilon(n,u.PI,u.EPSILON11)){var i=u.sign(t.longitude);return e.longitude=i*(n-u.EPSILON11),1}if(u.equalsEpsilon(r,u.PI,u.EPSILON11)){var a=u.sign(e.longitude);return t.longitude=a*(r-u.EPSILON11),2}return 0}function z(t,a,s,c,l,f,d){var m,p,g,y,E,T,S=a._ellipsoid,A=s.length/3-1,x=8*A,w=4*x,R=36*A,I=x>65535?new Uint32Array(R):new Uint16Array(R),z=new Float64Array(3*x),L=new Float32Array(w),B=new Float32Array(w),G=new Float32Array(w),V=new Float32Array(w),k=new Float32Array(w);d&&(g=new Float32Array(w),y=new Float32Array(w),E=new Float32Array(w),T=new Float32Array(2*x));var q=f.length/2,H=0,W=Ee;W.height=0;var Y=Te;Y.height=0;var X=Ce,j=Se;if(d)for(p=0,m=1;m<q;m++)W.latitude=f[p],W.longitude=f[p+1],Y.latitude=f[p+2],Y.longitude=f[p+3],X=a.project(W,X),j=a.project(Y,j),H+=r.distance(X,j),p+=2;var Z=c.length/3;j=r.unpack(c,0,j);var K=0;for(p=3,m=1;m<Z;m++)X=r.clone(j,X),j=r.unpack(c,p,j),K+=r.distance(X,j),p+=3;var J;p=3;var Q=0,$=0,ee=0,te=0,ne=!1,re=r.unpack(s,0,xe),ie=r.unpack(c,0,Se),ae=r.unpack(l,0,Re);if(t){O(ae,r.unpack(s,s.length-6,Ae),re,ie)&&(ae=r.negate(ae,ae))}var oe=0,se=0,ue=0;for(m=0;m<A;m++){var ce=r.clone(re,Ae),le=r.clone(ie,Ce),fe=r.clone(ae,we);ne&&(fe=r.negate(fe,fe)),re=r.unpack(s,p,xe),ie=r.unpack(c,p,Se),ae=r.unpack(l,p,Re),ne=O(ae,ce,re,ie),W.latitude=f[Q],W.longitude=f[Q+1],Y.latitude=f[Q+2],Y.longitude=f[Q+3];var de,me,he,pe;if(d){var _e=N(W,Y);de=a.project(W,Ne),me=a.project(Y,ze);var ve=b(me,de,Ye);ve.y=Math.abs(ve.y),he=Fe,pe=Le,0===_e||r.dot(ve,r.UNIT_Y)>U?(he=D(a,W,fe,de,Fe),pe=D(a,Y,ae,me,Le)):1===_e?(pe=D(a,Y,ae,me,Le),he.x=0,he.y=u.sign(W.longitude-Math.abs(Y.longitude)),he.z=0):(he=D(a,W,fe,de,Fe),pe.x=0,pe.y=u.sign(W.longitude-Y.longitude),pe.z=0)}var ge=r.distance(le,ie),ye=h.fromCartesian(ce,He),$e=r.subtract(re,ce,Be),et=r.normalize($e,Ve),tt=r.subtract(le,ce,Ue);tt=r.normalize(tt,tt);var nt=r.cross(et,tt,Ve);nt=r.normalize(nt,nt);var rt=r.cross(tt,fe,ke);rt=r.normalize(rt,rt);var it=r.subtract(ie,re,Ge);it=r.normalize(it,it);var at=r.cross(ae,it,qe);at=r.normalize(at,at);var ot,st,ut,ct=ge/K,lt=oe/K,ft=0,dt=0,mt=0;if(d){ft=r.distance(de,me),ot=h.fromCartesian(de,We),st=r.subtract(me,de,Ye),ut=r.normalize(st,Xe);var ht=ut.x;ut.x=ut.y,ut.y=-ht,dt=ft/H,mt=se/H}for(J=0;J<8;J++){var pt=te+4*J,_t=$+2*J,vt=pt+3,gt=J<4?1:-1,yt=2===J||3===J||6===J||7===J?1:-1;r.pack(ye.high,L,pt),L[vt]=$e.x,r.pack(ye.low,B,pt),B[vt]=$e.y,r.pack(rt,G,pt),G[vt]=$e.z,r.pack(at,V,pt),V[vt]=ct*gt,r.pack(nt,k,pt);var Et=lt*yt;0===Et&&yt<0&&(Et=Number.POSITIVE_INFINITY),k[vt]=Et,d&&(g[pt]=ot.high.x,g[pt+1]=ot.high.y,g[pt+2]=ot.low.x,g[pt+3]=ot.low.y,E[pt]=-he.y,E[pt+1]=he.x,E[pt+2]=pe.y,E[pt+3]=-pe.x,y[pt]=st.x,y[pt+1]=st.y,y[pt+2]=ut.x,y[pt+3]=ut.y,T[_t]=dt*gt,Et=mt*yt,0===Et&&yt<0&&(Et=Number.POSITIVE_INFINITY),T[_t+1]=Et)}var Tt=Pe,Ct=Me,St=Oe,At=De,xt=C.fromCartographicArray(be,Ie),wt=e.getApproximateTerrainHeights(xt,S),Rt=wt.minimumTerrainHeight,bt=wt.maximumTerrainHeight;ue+=Rt,ue+=bt,P(ce,le,Rt,bt,Tt,St),P(re,ie,Rt,bt,Ct,At);var It=r.multiplyByScalar(nt,u.EPSILON5,je);r.add(Tt,It,Tt),r.add(Ct,It,Ct),r.add(St,It,St),r.add(At,It,At),M(Tt,Ct),M(St,At),r.pack(Tt,z,ee),r.pack(Ct,z,ee+3),r.pack(At,z,ee+6),r.pack(St,z,ee+9),It=r.multiplyByScalar(nt,-2*u.EPSILON5,je),r.add(Tt,It,Tt),r.add(Ct,It,Ct),r.add(St,It,St),r.add(At,It,At),M(Tt,Ct),M(St,At),r.pack(Tt,z,ee+12),r.pack(Ct,z,ee+15),r.pack(At,z,ee+18),r.pack(St,z,ee+21),Q+=2,p+=3,$+=16,ee+=24,te+=32,oe+=ge,se+=ft}p=0;var Ot=0;for(m=0;m<A;m++){for(J=0;J<Qe;J++)I[p+J]=Je[J]+Ot;Ot+=8,p+=Qe}var Dt=Ze;n.fromVertices(s,r.ZERO,3,Dt[0]),n.fromVertices(c,r.ZERO,3,Dt[1]);var Pt=n.fromBoundingSpheres(Dt),Mt=ue/(2*A),Nt=i.fromCartesian(Pt.center,S,Ke);Nt.height=Mt,Pt.center=i.toCartesian(Nt,S,Pt.center),Pt.radius=Math.max(Pt.radius,Mt);var zt={position:new v({componentDatatype:o.DOUBLE,componentsPerAttribute:3,normalize:!1,values:z}),startHiAndForwardOffsetX:F(L),startLoAndForwardOffsetY:F(B),startNormalAndForwardOffsetZ:F(G),endNormalAndTextureCoordinateNormalizationX:F(V),rightNormalAndTextureCoordinateNormalizationY:F(k)};return d&&(zt.startHiLo2D=F(g),zt.offsetAndRight2D=F(y),zt.startEndNormals2D=F(E),zt.texcoordNormalization2D=new v({componentDatatype:o.FLOAT,componentsPerAttribute:2,normalize:!1,values:T})),new _({attributes:zt,indices:I,boundingSphere:Pt})}function F(e){return new v({componentDatatype:o.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}var L=[p,S],B=L.length,U=Math.cos(u.toRadians(30)),G=Math.cos(u.toRadians(150)),V=0,k=1e3;f(A.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+d.packedLength+1+1}}}),A.setProjectionAndEllipsoid=function(e,t){for(var n=0,r=0;r<B;r++)if(t instanceof L[r]){n=r;break}e._projectionIndex=n,e._ellipsoid=t.ellipsoid};var q=new r,H=new r,W=new r,Y=new i,X=new r,j=new r,Z=new r,K=new i;A.pack=function(e,t,n){var i=c(n,0),a=e._positions,o=a.length;t[i++]=o;for(var s=0;s<o;++s){var u=a[s];r.pack(u,t,i),i+=3}return t[i++]=e.granularity,t[i++]=e.loop?1:0,d.pack(e._ellipsoid,t,i),i+=d.packedLength,t[i++]=e._projectionIndex,t[i++]=e._scene3DOnly?1:0,t},A.unpack=function(e,t,n){for(var i=c(t,0),a=e[i++],o=new Array(a),s=0;s<a;s++)o[s]=r.unpack(e,i),i+=3;var u=e[i++],f=1===e[i++],m=d.unpack(e,i);i+=d.packedLength;var h=e[i++],p=1===e[i++];if(!l(n)){var _=new A({positions:o,granularity:u,loop:f,ellipsoid:m});return _._projectionIndex=h,_._scene3DOnly=p,_}return n._positions=o,n.granularity=u,n.loop=f,n._ellipsoid=m,n._projectionIndex=h,n._scene3DOnly=p,n};var J=new r,Q=new r,$=new r,ee=new r,te=new E(r.UNIT_X,0),ne=new r,re=0,ie=E.fromPointNormal(r.ZERO,r.UNIT_Y),ae=new r,oe=new r,se=new r,ue=new r,ce=new r,le=new r;A.createGeometry=function(e){var n,a,o=!e._scene3DOnly,s=e.loop,c=e._ellipsoid,f=e.granularity,d=new L[e._projectionIndex](c),m=V,h=k,p=e._positions,_=p.length;2===_&&(s=!1);var v,y,E,T=[p[0]];for(a=0;a<_-1;a++)v=p[a],y=p[a+1],E=g.lineSegmentPlane(v,y,ie,le),!l(E)||r.equalsEpsilon(E,v,u.EPSILON7)||r.equalsEpsilon(E,y,u.EPSILON7)||T.push(r.clone(E)),T.push(y);s&&(v=p[_-1],y=p[0],E=g.lineSegmentPlane(v,y,ie,le),!l(E)||r.equalsEpsilon(E,v,u.EPSILON7)||r.equalsEpsilon(E,y,u.EPSILON7)||T.push(r.clone(E)));var C=T.length,S=new Array(C);for(a=0;a<C;a++){var A=i.fromCartesian(T[a],c);A.height=0,S[a]=A}if(S=t(S,i.equalsEpsilon),!((C=S.length)<2)){var b=[],O=[],D=[],P=[],M=ae,N=oe,F=se,B=ue,U=ce,G=S[0],q=S[1],H=S[C-1];for(M=R(c,H,m,M),B=R(c,q,m,B),N=R(c,G,m,N),F=R(c,G,h,F),U=s?I(M,N,F,B,U):x(G,q,h,c,U),r.pack(U,O,0),r.pack(N,D,0),r.pack(F,P,0),b.push(G.latitude),b.push(G.longitude),w(G,q,m,h,f,c,O,D,P,b),a=1;a<C-1;++a){M=r.clone(N,M),N=r.clone(B,N);var W=S[a];R(c,W,h,F),R(c,S[a+1],m,B),I(M,N,F,B,U),n=O.length,r.pack(U,O,n),r.pack(N,D,n),r.pack(F,P,n),b.push(W.latitude),b.push(W.longitude),w(S[a],S[a+1],m,h,f,c,O,D,P,b)}var Y=S[C-1],X=S[C-2];if(N=R(c,Y,m,N),F=R(c,Y,h,F),s){var j=S[0];M=R(c,X,m,M),B=R(c,j,m,B),U=I(M,N,F,B,U)}else U=x(X,Y,h,c,U);if(n=O.length,r.pack(U,O,n),r.pack(N,D,n),r.pack(F,P,n),b.push(Y.latitude),b.push(Y.longitude),s){for(w(Y,G,m,h,f,c,O,D,P,b),n=O.length,a=0;a<3;++a)O[n+a]=O[a],D[n+a]=D[a],P[n+a]=P[a];b.push(G.latitude),b.push(G.longitude)}return z(s,d,D,P,O,b,o)}};var fe=new r,de=new y,me=new T,he=new i,pe=new r,_e=new r,ve=new r,ge=new r,ye=new r,Ee=new i,Te=new i,Ce=new r,Se=new r,Ae=new r,xe=new r,we=new r,Re=new r,be=[Ee,Te],Ie=new C,Oe=new r,De=new r,Pe=new r,Me=new r,Ne=new r,ze=new r,Fe=new r,Le=new r,Be=new r,Ue=new r,Ge=new r,Ve=new r,ke=new r,qe=new r,He=new h,We=new h,Ye=new r,Xe=new r,je=new r,Ze=[new n,new n],Ke=new i,Je=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Qe=Je.length;return A._projectNormal=D,A}),define("Core/destroyObject",["./defaultValue","./DeveloperError"],function(e,t){"use strict";function n(){return!0}function r(t,r){function i(){}r=e(r,"This object was destroyed, i.e., destroy() was called.");for(var a in t)"function"==typeof t[a]&&(t[a]=i);t.isDestroyed=n}return r}),define("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this.geometry=t.geometry,this.modelMatrix=r.clone(e(t.modelMatrix,r.IDENTITY)),this.id=t.id,this.pickPrimitive=t.pickPrimitive,this.attributes=e(t.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}return i}),define("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t){t=e(t,e.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=e(t.normalize,!1),this.value=t.value}return r}),define("Shaders/PolylineShadowVolumeVS",[],function(){"use strict"
;return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\n#ifndef COLUMBUS_VIEW_2D\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\n#else\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\n#endif\nattribute float batchId;\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;\nvec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);\nvec3 ecEnd = forwardDirectionEC + ecStart;\nforwardDirectionEC = normalize(forwardDirectionEC);\nv_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nvec4 startPlaneEC;\nstartPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);\nv_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;\n#else // COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;\nvec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);\nvec3 ecEnd = ecStart + offset;\nvec3 forwardDirectionEC = normalize(offset);\nvec4 startPlaneEC;\nstartPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nv_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\nv_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;\n#endif // COLUMBUS_VIEW_2D\nv_endEcAndStartEcX.xyz = ecEnd;\nv_endEcAndStartEcX.w = ecStart.x;\nv_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#endif // PER_INSTANCE_COLOR\nvec4 positionRelativeToEye = czm_computePosition();\nvec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);\nvec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nupOrDown = cross(forwardDirectionEC, normalEC);\nupOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;\nupOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;\nupOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;\npositionEC.xyz += upOrDown;\nv_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));\nfloat width = czm_batchTable_width(batchId);\n#ifdef WIDTH_VARYING\nv_width = width;\n#endif\nv_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;\nv_startPlaneNormalEcAndHalfWidth.w = width * 0.5;\nv_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;\nv_endPlaneNormalEcAndBatchId.w = batchId;\nwidth = width * max(0.0, czm_metersPerPixel(positionEC));\nwidth = width / dot(normalEC, v_rightPlaneEC.xyz);\n#ifdef COLUMBUS_VIEW_2D\nnormalEC *= sign(texcoordNormalization2D.x);\n#else\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\n#endif\npositionEC.xyz += width * normalEC;\ngl_Position = czm_depthClampFarPlane(czm_projection * positionEC);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n"}),define("Shaders/PolylineShadowVolumeFS",[],function(){"use strict";return"#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main(void)\n{\nfloat logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\nvec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);\nif (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\neyeCoordinate /= eyeCoordinate.w;\nfloat halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);\nfloat widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\nfloat distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);\nfloat distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);\nif (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec3 alignedPlaneNormal;\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);\ns = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;\nfloat t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, t);\nmaterialInput.str = vec3(s, t, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\nczm_writeDepthClampedToFarPlane();\n}\n"}),define("Shaders/PolylineShadowVolumeMorphVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\nattribute float batchId;\nvarying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nvoid main()\n{\nv_batchId = batchId;\nvec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));\nvec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);\nvec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nvec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nvec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec4 startPlane2D;\nvec4 startPlane3D;\nstartPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlane2D.w = -dot(startPlane2D.xyz, posEc2D);\nstartPlane3D.w = -dot(startPlane3D.xyz, posEc3D);\nvec4 rightPlane2D;\nvec4 rightPlane3D;\nrightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nrightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nrightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);\nrightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);\nposRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);\nposRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);\nposRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nposEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nposEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));\nvec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));\nvec4 endPlane2D;\nvec4 endPlane3D;\nendPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlane2D.w = -dot(endPlane2D.xyz, posEc2D);\nendPlane3D.w = -dot(endPlane3D.xyz, posEc3D);\nv_forwardDirectionEC = normalize(endEC - startEC);\nvec2 cleanTexcoordNormalization2D;\ncleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);\ncleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));\nvec2 cleanTexcoordNormalization3D;\ncleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\ncleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;\ncleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));\nv_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#else // PER_INSTANCE_COLOR\nv_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);\nv_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);\n#endif // PER_INSTANCE_COLOR\n#ifdef WIDTH_VARYING\nfloat width = czm_batchTable_width(batchId);\nfloat halfWidth = width * 0.5;\nv_width = width;\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#else\nfloat halfWidth = 0.5 * czm_batchTable_width(batchId);\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#endif\nvec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);\nvec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nvec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));\ngeodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc3D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\npositionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;\nvec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nabsStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));\nabsEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));\nplaneDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);\nupOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));\nnormalEC = normalize(cross(planeDirection, upOrDown));\ngeodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));\ngeodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc2D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(texcoordNormalization2D.x);\n#ifndef PER_INSTANCE_COLOR\nv_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);\n#endif\npositionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;\ngl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n"}),define("Shaders/PolylineShadowVolumeMorphFS",[],function(){"use strict";return"varying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nfloat rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {\nreturn (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);\n}\nvoid main(void)\n{\nvec4 eyeCoordinate = gl_FragCoord;\neyeCoordinate /= eyeCoordinate.w;\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);\nfloat distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);\ndistanceFromStart = max(0.0, distanceFromStart);\ndistanceFromEnd = max(0.0, distanceFromEnd);\nfloat s = distanceFromStart / (distanceFromStart + distanceFromEnd);\ns = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, v_texcoordT);\nmaterialInput.str = vec3(s, v_texcoordT, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\n}\n"}),define("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this._boundingVolume=t.boundingVolume,this._orientedBoundingBox=t.orientedBoundingBox,this._cull=e(t.cull,!0),this._modelMatrix=t.modelMatrix,this._primitiveType=e(t.primitiveType,r.TRIANGLES),this._vertexArray=t.vertexArray,this._count=t.count,this._offset=e(t.offset,0),this._instanceCount=e(t.instanceCount,0),this._shaderProgram=t.shaderProgram,this._uniformMap=t.uniformMap,this._renderState=t.renderState,this._framebuffer=t.framebuffer,this._pass=t.pass,this._executeInClosestFrustum=e(t.executeInClosestFrustum,!1),this._owner=t.owner,this._debugShowBoundingVolume=e(t.debugShowBoundingVolume,!1),this._debugOverlappingFrustums=0,this._castShadows=e(t.castShadows,!1),this._receiveShadows=e(t.receiveShadows,!1),this._pickId=t.pickId,this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}return n(i.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return this._castShadows},set:function(e){this._castShadows!==e&&(this._castShadows=e,this.dirty=!0)}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){this._receiveShadows!==e&&(this._receiveShadows=e,this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){this._executeInClosestFrustum!==e&&(this._executeInClosestFrustum=e,this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}}}),i.shallowClone=function(e,n){if(t(e))return t(n)||(n=new i),n._boundingVolume=e._boundingVolume,n._orientedBoundingBox=e._orientedBoundingBox,n._cull=e._cull,n._modelMatrix=e._modelMatrix,n._primitiveType=e._primitiveType,n._vertexArray=e._vertexArray,n._count=e._count,n._offset=e._offset,n._instanceCount=e._instanceCount,n._shaderProgram=e._shaderProgram,n._uniformMap=e._uniformMap,n._renderState=e._renderState,n._framebuffer=e._framebuffer,n._pass=e._pass,n._executeInClosestFrustum=e._executeInClosestFrustum,n._owner=e._owner,n._debugShowBoundingVolume=e._debugShowBoundingVolume,n._debugOverlappingFrustums=e._debugOverlappingFrustums,n._castShadows=e._castShadows,n._receiveShadows=e._receiveShadows,n._pickId=e._pickId,n.dirty=!0,n.lastDirtyTime=0,n},i.prototype.execute=function(e,t){e.draw(this,t)},i}),define("Renderer/Pass",["../Core/freezeObject"],function(e){"use strict";return e({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,CLASSIFICATION:7,OPAQUE:8,TRANSLUCENT:9,OVERLAY:10,NUMBER_OF_PASSES:11})}),define("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./Check","./defaultValue","./defined","./GeographicProjection","./Intersect","./Rectangle"],function(e,t,n,r,i,a,o,s){"use strict";function u(e,t,n,i){this.x=r(e,0),this.y=r(t,0),this.width=r(n,0),this.height=r(i,0)}u.packedLength=4,u.pack=function(e,t,n){return n=r(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.width,t[n]=e.height,t},u.unpack=function(e,t,n){return t=r(t,0),i(n)||(n=new u),n.x=e[t++],n.y=e[t++],n.width=e[t++],n.height=e[t],n},u.fromPoints=function(e,t){if(i(t)||(t=new u),!i(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var n=e.length,r=e[0].x,a=e[0].y,o=e[0].x,s=e[0].y,c=1;c<n;c++){var l=e[c],f=l.x,d=l.y;r=Math.min(f,r),o=Math.max(f,o),a=Math.min(d,a),s=Math.max(d,s)}return t.x=r,t.y=a,t.width=o-r,t.height=s-a,t};var c=new a,l=new t,f=new t;return u.fromRectangle=function(t,n,a){if(i(a)||(a=new u),!i(t))return a.x=0,a.y=0,a.width=0,a.height=0,a;n=r(n,c);var o=n.project(s.southwest(t,l)),d=n.project(s.northeast(t,f));return e.subtract(d,o,d),a.x=o.x,a.y=o.y,a.width=d.x,a.height=d.y,a},u.clone=function(e,t){if(i(e))return i(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new u(e.x,e.y,e.width,e.height)},u.union=function(e,t,n){i(n)||(n=new u);var r=Math.min(e.x,t.x),a=Math.min(e.y,t.y),o=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=r,n.y=a,n.width=o-r,n.height=s-a,n},u.expand=function(e,t,n){n=u.clone(e,n);var r=t.x-n.x,i=t.y-n.y;return r>n.width?n.width=r:r<0&&(n.width-=r,n.x=t.x),i>n.height?n.height=i:i<0&&(n.height-=i,n.y=t.y),n},u.intersect=function(e,t){var n=e.x,r=e.y,i=t.x,a=t.y;return n>i+t.width||n+e.width<i||r+e.height<a||r>a+t.height?o.OUTSIDE:o.INTERSECTING},u.equals=function(e,t){return e===t||i(e)&&i(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.intersect=function(e){return u.intersect(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u}),define("Core/Color",["./Check","./defaultValue","./defined","./FeatureDetection","./freezeObject","./Math"],function(e,t,n,r,i,a){"use strict";function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function s(e,n,r,i){this.red=t(e,1),this.green=t(n,1),this.blue=t(r,1),this.alpha=t(i,1)}s.fromCartesian4=function(e,t){return n(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new s(e.x,e.y,e.z,e.w)},s.fromBytes=function(e,r,i,a,o){return e=s.byteToFloat(t(e,255)),r=s.byteToFloat(t(r,255)),i=s.byteToFloat(t(i,255)),a=s.byteToFloat(t(a,255)),n(o)?(o.red=e,o.green=r,o.blue=i,o.alpha=a,o):new s(e,r,i,a)},s.fromAlpha=function(e,t,r){return n(r)?(r.red=e.red,r.green=e.green,r.blue=e.blue,r.alpha=t,r):new s(e.red,e.green,e.blue,t)};var u,c,l;r.supportsTypedArrays()&&(u=new ArrayBuffer(4),c=new Uint32Array(u),l=new Uint8Array(u)),s.fromRgba=function(e,t){return c[0]=e,s.fromBytes(l[0],l[1],l[2],l[3],t)},s.fromHsl=function(e,r,i,a,u){e=t(e,0)%1,r=t(r,0),i=t(i,0),a=t(a,1);var c=i,l=i,f=i;if(0!==r){var d;d=i<.5?i*(1+r):i+r-i*r;var m=2*i-d;c=o(m,d,e+1/3),l=o(m,d,e),f=o(m,d,e-1/3)}return n(u)?(u.red=c,u.green=l,u.blue=f,u.alpha=a,u):new s(c,l,f,a)},s.fromRandom=function(e,r){e=t(e,t.EMPTY_OBJECT);var i=e.red;if(!n(i)){var o=t(e.minimumRed,0),u=t(e.maximumRed,1);i=o+a.nextRandomNumber()*(u-o)}var c=e.green;if(!n(c)){var l=t(e.minimumGreen,0),f=t(e.maximumGreen,1);c=l+a.nextRandomNumber()*(f-l)}var d=e.blue;if(!n(d)){var m=t(e.minimumBlue,0),h=t(e.maximumBlue,1);d=m+a.nextRandomNumber()*(h-m)}var p=e.alpha;if(!n(p)){var _=t(e.minimumAlpha,0),v=t(e.maximumAlpha,1);p=_+a.nextRandomNumber()*(v-_)}return n(r)?(r.red=i,r.green=c,r.blue=d,r.alpha=p,r):new s(i,c,d,p)};var f=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,d=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,m=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,h=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;return s.fromCssColorString=function(e,r){n(r)||(r=new s);var i=s[e.toUpperCase()];if(n(i))return s.clone(i,r),r;var a=f.exec(e);return null!==a?(r.red=parseInt(a[1],16)/15,r.green=parseInt(a[2],16)/15,r.blue=parseInt(a[3],16)/15,r.alpha=1,r):null!==(a=d.exec(e))?(r.red=parseInt(a[1],16)/255,r.green=parseInt(a[2],16)/255,r.blue=parseInt(a[3],16)/255,r.alpha=1,r):null!==(a=m.exec(e))?(r.red=parseFloat(a[1])/("%"===a[1].substr(-1)?100:255),r.green=parseFloat(a[2])/("%"===a[2].substr(-1)?100:255),r.blue=parseFloat(a[3])/("%"===a[3].substr(-1)?100:255),r.alpha=parseFloat(t(a[4],"1.0")),r):null!==(a=h.exec(e))?s.fromHsl(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,parseFloat(t(a[4],"1.0")),r):r=void 0},s.packedLength=4,s.pack=function(e,n,r){return r=t(r,0),n[r++]=e.red,n[r++]=e.green,n[r++]=e.blue,n[r]=e.alpha,n},s.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new s),i.red=e[r++],i.green=e[r++],i.blue=e[r++],i.alpha=e[r],i},s.byteToFloat=function(e){return e/255},s.floatToByte=function(e){return 1===e?255:256*e|0},s.clone=function(e,t){if(n(e))return n(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new s(e.red,e.green,e.blue,e.alpha)},s.equals=function(e,t){return e===t||n(e)&&n(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},s.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]},s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return this===e||n(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},s.prototype.toCssColorString=function(){var e=s.floatToByte(this.red),t=s.floatToByte(this.green),n=s.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+n+")":"rgba("+e+","+t+","+n+","+this.alpha+")"},s.prototype.toBytes=function(e){var t=s.floatToByte(this.red),r=s.floatToByte(this.green),i=s.floatToByte(this.blue),a=s.floatToByte(this.alpha);return n(e)?(e[0]=t,e[1]=r,e[2]=i,e[3]=a,e):[t,r,i,a]},s.prototype.toRgba=function(){return l[0]=s.floatToByte(this.red),l[1]=s.floatToByte(this.green),l[2]=s.floatToByte(this.blue),l[3]=s.floatToByte(this.alpha),c[0]},s.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},s.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},s.prototype.withAlpha=function(e,t){return s.fromAlpha(this,e,t)},s.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n},s.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n},s.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n},s.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n},s.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n},s.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n},s.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n},s.ALICEBLUE=i(s.fromCssColorString("#F0F8FF")),s.ANTIQUEWHITE=i(s.fromCssColorString("#FAEBD7")),s.AQUA=i(s.fromCssColorString("#00FFFF")),s.AQUAMARINE=i(s.fromCssColorString("#7FFFD4")),s.AZURE=i(s.fromCssColorString("#F0FFFF")),s.BEIGE=i(s.fromCssColorString("#F5F5DC")),s.BISQUE=i(s.fromCssColorString("#FFE4C4")),s.BLACK=i(s.fromCssColorString("#000000")),s.BLANCHEDALMOND=i(s.fromCssColorString("#FFEBCD")),s.BLUE=i(s.fromCssColorString("#0000FF")),s.BLUEVIOLET=i(s.fromCssColorString("#8A2BE2")),s.BROWN=i(s.fromCssColorString("#A52A2A")),s.BURLYWOOD=i(s.fromCssColorString("#DEB887")),s.CADETBLUE=i(s.fromCssColorString("#5F9EA0")),s.CHARTREUSE=i(s.fromCssColorString("#7FFF00")),s.CHOCOLATE=i(s.fromCssColorString("#D2691E")),s.CORAL=i(s.fromCssColorString("#FF7F50")),s.CORNFLOWERBLUE=i(s.fromCssColorString("#6495ED")),s.CORNSILK=i(s.fromCssColorString("#FFF8DC")),s.CRIMSON=i(s.fromCssColorString("#DC143C")),s.CYAN=i(s.fromCssColorString("#00FFFF")),s.DARKBLUE=i(s.fromCssColorString("#00008B")),s.DARKCYAN=i(s.fromCssColorString("#008B8B")),s.DARKGOLDENROD=i(s.fromCssColorString("#B8860B")),s.DARKGRAY=i(s.fromCssColorString("#A9A9A9")),s.DARKGREEN=i(s.fromCssColorString("#006400")),s.DARKGREY=s.DARKGRAY,s.DARKKHAKI=i(s.fromCssColorString("#BDB76B")),s.DARKMAGENTA=i(s.fromCssColorString("#8B008B")),s.DARKOLIVEGREEN=i(s.fromCssColorString("#556B2F")),s.DARKORANGE=i(s.fromCssColorString("#FF8C00")),s.DARKORCHID=i(s.fromCssColorString("#9932CC")),s.DARKRED=i(s.fromCssColorString("#8B0000")),s.DARKSALMON=i(s.fromCssColorString("#E9967A")),s.DARKSEAGREEN=i(s.fromCssColorString("#8FBC8F")),s.DARKSLATEBLUE=i(s.fromCssColorString("#483D8B")),s.DARKSLATEGRAY=i(s.fromCssColorString("#2F4F4F")),s.DARKSLATEGREY=s.DARKSLATEGRAY,s.DARKTURQUOISE=i(s.fromCssColorString("#00CED1")),s.DARKVIOLET=i(s.fromCssColorString("#9400D3")),s.DEEPPINK=i(s.fromCssColorString("#FF1493")),s.DEEPSKYBLUE=i(s.fromCssColorString("#00BFFF")),s.DIMGRAY=i(s.fromCssColorString("#696969")),s.DIMGREY=s.DIMGRAY,s.DODGERBLUE=i(s.fromCssColorString("#1E90FF")),s.FIREBRICK=i(s.fromCssColorString("#B22222")),s.FLORALWHITE=i(s.fromCssColorString("#FFFAF0")),s.FORESTGREEN=i(s.fromCssColorString("#228B22")),s.FUCHSIA=i(s.fromCssColorString("#FF00FF")),s.GAINSBORO=i(s.fromCssColorString("#DCDCDC")),s.GHOSTWHITE=i(s.fromCssColorString("#F8F8FF")),s.GOLD=i(s.fromCssColorString("#FFD700")),s.GOLDENROD=i(s.fromCssColorString("#DAA520")),s.GRAY=i(s.fromCssColorString("#808080")),s.GREEN=i(s.fromCssColorString("#008000")),s.GREENYELLOW=i(s.fromCssColorString("#ADFF2F")),s.GREY=s.GRAY,s.HONEYDEW=i(s.fromCssColorString("#F0FFF0")),s.HOTPINK=i(s.fromCssColorString("#FF69B4")),s.INDIANRED=i(s.fromCssColorString("#CD5C5C")),s.INDIGO=i(s.fromCssColorString("#4B0082")),s.IVORY=i(s.fromCssColorString("#FFFFF0")),s.KHAKI=i(s.fromCssColorString("#F0E68C")),s.LAVENDER=i(s.fromCssColorString("#E6E6FA")),s.LAVENDAR_BLUSH=i(s.fromCssColorString("#FFF0F5")),s.LAWNGREEN=i(s.fromCssColorString("#7CFC00")),
s.LEMONCHIFFON=i(s.fromCssColorString("#FFFACD")),s.LIGHTBLUE=i(s.fromCssColorString("#ADD8E6")),s.LIGHTCORAL=i(s.fromCssColorString("#F08080")),s.LIGHTCYAN=i(s.fromCssColorString("#E0FFFF")),s.LIGHTGOLDENRODYELLOW=i(s.fromCssColorString("#FAFAD2")),s.LIGHTGRAY=i(s.fromCssColorString("#D3D3D3")),s.LIGHTGREEN=i(s.fromCssColorString("#90EE90")),s.LIGHTGREY=s.LIGHTGRAY,s.LIGHTPINK=i(s.fromCssColorString("#FFB6C1")),s.LIGHTSEAGREEN=i(s.fromCssColorString("#20B2AA")),s.LIGHTSKYBLUE=i(s.fromCssColorString("#87CEFA")),s.LIGHTSLATEGRAY=i(s.fromCssColorString("#778899")),s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY,s.LIGHTSTEELBLUE=i(s.fromCssColorString("#B0C4DE")),s.LIGHTYELLOW=i(s.fromCssColorString("#FFFFE0")),s.LIME=i(s.fromCssColorString("#00FF00")),s.LIMEGREEN=i(s.fromCssColorString("#32CD32")),s.LINEN=i(s.fromCssColorString("#FAF0E6")),s.MAGENTA=i(s.fromCssColorString("#FF00FF")),s.MAROON=i(s.fromCssColorString("#800000")),s.MEDIUMAQUAMARINE=i(s.fromCssColorString("#66CDAA")),s.MEDIUMBLUE=i(s.fromCssColorString("#0000CD")),s.MEDIUMORCHID=i(s.fromCssColorString("#BA55D3")),s.MEDIUMPURPLE=i(s.fromCssColorString("#9370DB")),s.MEDIUMSEAGREEN=i(s.fromCssColorString("#3CB371")),s.MEDIUMSLATEBLUE=i(s.fromCssColorString("#7B68EE")),s.MEDIUMSPRINGGREEN=i(s.fromCssColorString("#00FA9A")),s.MEDIUMTURQUOISE=i(s.fromCssColorString("#48D1CC")),s.MEDIUMVIOLETRED=i(s.fromCssColorString("#C71585")),s.MIDNIGHTBLUE=i(s.fromCssColorString("#191970")),s.MINTCREAM=i(s.fromCssColorString("#F5FFFA")),s.MISTYROSE=i(s.fromCssColorString("#FFE4E1")),s.MOCCASIN=i(s.fromCssColorString("#FFE4B5")),s.NAVAJOWHITE=i(s.fromCssColorString("#FFDEAD")),s.NAVY=i(s.fromCssColorString("#000080")),s.OLDLACE=i(s.fromCssColorString("#FDF5E6")),s.OLIVE=i(s.fromCssColorString("#808000")),s.OLIVEDRAB=i(s.fromCssColorString("#6B8E23")),s.ORANGE=i(s.fromCssColorString("#FFA500")),s.ORANGERED=i(s.fromCssColorString("#FF4500")),s.ORCHID=i(s.fromCssColorString("#DA70D6")),s.PALEGOLDENROD=i(s.fromCssColorString("#EEE8AA")),s.PALEGREEN=i(s.fromCssColorString("#98FB98")),s.PALETURQUOISE=i(s.fromCssColorString("#AFEEEE")),s.PALEVIOLETRED=i(s.fromCssColorString("#DB7093")),s.PAPAYAWHIP=i(s.fromCssColorString("#FFEFD5")),s.PEACHPUFF=i(s.fromCssColorString("#FFDAB9")),s.PERU=i(s.fromCssColorString("#CD853F")),s.PINK=i(s.fromCssColorString("#FFC0CB")),s.PLUM=i(s.fromCssColorString("#DDA0DD")),s.POWDERBLUE=i(s.fromCssColorString("#B0E0E6")),s.PURPLE=i(s.fromCssColorString("#800080")),s.RED=i(s.fromCssColorString("#FF0000")),s.ROSYBROWN=i(s.fromCssColorString("#BC8F8F")),s.ROYALBLUE=i(s.fromCssColorString("#4169E1")),s.SADDLEBROWN=i(s.fromCssColorString("#8B4513")),s.SALMON=i(s.fromCssColorString("#FA8072")),s.SANDYBROWN=i(s.fromCssColorString("#F4A460")),s.SEAGREEN=i(s.fromCssColorString("#2E8B57")),s.SEASHELL=i(s.fromCssColorString("#FFF5EE")),s.SIENNA=i(s.fromCssColorString("#A0522D")),s.SILVER=i(s.fromCssColorString("#C0C0C0")),s.SKYBLUE=i(s.fromCssColorString("#87CEEB")),s.SLATEBLUE=i(s.fromCssColorString("#6A5ACD")),s.SLATEGRAY=i(s.fromCssColorString("#708090")),s.SLATEGREY=s.SLATEGRAY,s.SNOW=i(s.fromCssColorString("#FFFAFA")),s.SPRINGGREEN=i(s.fromCssColorString("#00FF7F")),s.STEELBLUE=i(s.fromCssColorString("#4682B4")),s.TAN=i(s.fromCssColorString("#D2B48C")),s.TEAL=i(s.fromCssColorString("#008080")),s.THISTLE=i(s.fromCssColorString("#D8BFD8")),s.TOMATO=i(s.fromCssColorString("#FF6347")),s.TURQUOISE=i(s.fromCssColorString("#40E0D0")),s.VIOLET=i(s.fromCssColorString("#EE82EE")),s.WHEAT=i(s.fromCssColorString("#F5DEB3")),s.WHITE=i(s.fromCssColorString("#FFFFFF")),s.WHITESMOKE=i(s.fromCssColorString("#F5F5F5")),s.YELLOW=i(s.fromCssColorString("#FFFF00")),s.YELLOWGREEN=i(s.fromCssColorString("#9ACD32")),s.TRANSPARENT=i(new s(0,0,0,0)),s}),define("Core/WindingOrder",["./freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={CLOCKWISE:t.CW,COUNTER_CLOCKWISE:t.CCW,validate:function(e){return e===n.CLOCKWISE||e===n.COUNTER_CLOCKWISE}};return e(n)}),define("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1};return e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}}),t}),define("Renderer/freezeRenderState",["../Core/freezeObject"],function(e){"use strict";function t(n){if("object"!=typeof n||null===n)return n;for(var r,i=Object.keys(n),a=0;a<i.length;a++)r=i[a],n.hasOwnProperty(r)&&"_applyFunctions"!==r&&(n[r]=t(n[r]));return e(n)}return t}),define("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/WebGLConstants","../Core/WindingOrder","./ContextLimits","./freezeRenderState"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(i){var s=n(i,{}),u=n(s.cull,{}),c=n(s.polygonOffset,{}),l=n(s.scissorTest,{}),f=n(l.rectangle,{}),d=n(s.depthRange,{}),m=n(s.depthTest,{}),h=n(s.colorMask,{}),p=n(s.blending,{}),_=n(p.color,{}),v=n(s.stencilTest,{}),g=n(v.frontOperation,{}),y=n(v.backOperation,{}),E=n(s.sampleCoverage,{}),T=s.viewport;this.frontFace=n(s.frontFace,o.COUNTER_CLOCKWISE),this.cull={enabled:n(u.enabled,!1),face:n(u.face,a.BACK)},this.lineWidth=n(s.lineWidth,1),this.polygonOffset={enabled:n(c.enabled,!1),factor:n(c.factor,0),units:n(c.units,0)},this.scissorTest={enabled:n(l.enabled,!1),rectangle:e.clone(f)},this.depthRange={near:n(d.near,0),far:n(d.far,1)},this.depthTest={enabled:n(m.enabled,!1),func:n(m.func,a.LESS)},this.colorMask={red:n(h.red,!0),green:n(h.green,!0),blue:n(h.blue,!0),alpha:n(h.alpha,!0)},this.depthMask=n(s.depthMask,!0),this.stencilMask=n(s.stencilMask,-1),this.blending={enabled:n(p.enabled,!1),color:new t(n(_.red,0),n(_.green,0),n(_.blue,0),n(_.alpha,0)),equationRgb:n(p.equationRgb,a.FUNC_ADD),equationAlpha:n(p.equationAlpha,a.FUNC_ADD),functionSourceRgb:n(p.functionSourceRgb,a.ONE),functionSourceAlpha:n(p.functionSourceAlpha,a.ONE),functionDestinationRgb:n(p.functionDestinationRgb,a.ZERO),functionDestinationAlpha:n(p.functionDestinationAlpha,a.ZERO)},this.stencilTest={enabled:n(v.enabled,!1),frontFunction:n(v.frontFunction,a.ALWAYS),backFunction:n(v.backFunction,a.ALWAYS),reference:n(v.reference,0),mask:n(v.mask,-1),frontOperation:{fail:n(g.fail,a.KEEP),zFail:n(g.zFail,a.KEEP),zPass:n(g.zPass,a.KEEP)},backOperation:{fail:n(y.fail,a.KEEP),zFail:n(y.zFail,a.KEEP),zPass:n(y.zPass,a.KEEP)}},this.sampleCoverage={enabled:n(E.enabled,!1),value:n(E.value,1),invert:n(E.invert,!1)},this.viewport=r(T)?new e(T.x,T.y,T.width,T.height):void 0,this.id=0,this._applyFunctions=[]}function l(e,t,n){n?e.enable(t):e.disable(t)}function f(e,t){e.frontFace(t.frontFace)}function d(e,t){var n=t.cull,r=n.enabled;l(e,e.CULL_FACE,r),r&&e.cullFace(n.face)}function m(e,t){e.lineWidth(t.lineWidth)}function h(e,t){var n=t.polygonOffset,r=n.enabled;l(e,e.POLYGON_OFFSET_FILL,r),r&&e.polygonOffset(n.factor,n.units)}function p(e,t,n){var i=t.scissorTest,a=r(n.scissorTest)?n.scissorTest.enabled:i.enabled;if(l(e,e.SCISSOR_TEST,a),a){var o=r(n.scissorTest)?n.scissorTest.rectangle:i.rectangle;e.scissor(o.x,o.y,o.width,o.height)}}function _(e,t){var n=t.depthRange;e.depthRange(n.near,n.far)}function v(e,t){var n=t.depthTest,r=n.enabled;l(e,e.DEPTH_TEST,r),r&&e.depthFunc(n.func)}function g(e,t){var n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function y(e,t){e.depthMask(t.depthMask)}function E(e,t){e.stencilMask(t.stencilMask)}function T(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function C(e,t,n){var i=t.blending,a=r(n.blendingEnabled)?n.blendingEnabled:i.enabled;l(e,e.BLEND,a),a&&(T(e,i.color),e.blendEquationSeparate(i.equationRgb,i.equationAlpha),e.blendFuncSeparate(i.functionSourceRgb,i.functionDestinationRgb,i.functionSourceAlpha,i.functionDestinationAlpha))}function S(e,t){var n=t.stencilTest,r=n.enabled;if(l(e,e.STENCIL_TEST,r),r){var i=n.frontFunction,a=n.backFunction,o=n.reference,s=n.mask;e.stencilFunc(i,o,s),e.stencilFuncSeparate(e.BACK,a,o,s),e.stencilFuncSeparate(e.FRONT,i,o,s);var u=n.frontOperation,c=u.fail,f=u.zFail,d=u.zPass;e.stencilOpSeparate(e.FRONT,c,f,d);var m=n.backOperation,h=m.fail,p=m.zFail,_=m.zPass;e.stencilOpSeparate(e.BACK,h,p,_)}}function A(e,t){var n=t.sampleCoverage,r=n.enabled;l(e,e.SAMPLE_COVERAGE,r),r&&e.sampleCoverage(n.value,n.invert)}function x(e,t,i){var a=n(t.viewport,i.viewport);r(a)||(a=I,a.width=i.context.drawingBufferWidth,a.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=a,e.viewport(a.x,a.y,a.width,a.height)}function w(e,t){var n=[];return e.frontFace!==t.frontFace&&n.push(f),e.cull.enabled===t.cull.enabled&&e.cull.face===t.cull.face||n.push(d),e.lineWidth!==t.lineWidth&&n.push(m),e.polygonOffset.enabled===t.polygonOffset.enabled&&e.polygonOffset.factor===t.polygonOffset.factor&&e.polygonOffset.units===t.polygonOffset.units||n.push(h),e.depthRange.near===t.depthRange.near&&e.depthRange.far===t.depthRange.far||n.push(_),e.depthTest.enabled===t.depthTest.enabled&&e.depthTest.func===t.depthTest.func||n.push(v),e.colorMask.red===t.colorMask.red&&e.colorMask.green===t.colorMask.green&&e.colorMask.blue===t.colorMask.blue&&e.colorMask.alpha===t.colorMask.alpha||n.push(g),e.depthMask!==t.depthMask&&n.push(y),e.stencilMask!==t.stencilMask&&n.push(E),e.stencilTest.enabled===t.stencilTest.enabled&&e.stencilTest.frontFunction===t.stencilTest.frontFunction&&e.stencilTest.backFunction===t.stencilTest.backFunction&&e.stencilTest.reference===t.stencilTest.reference&&e.stencilTest.mask===t.stencilTest.mask&&e.stencilTest.frontOperation.fail===t.stencilTest.frontOperation.fail&&e.stencilTest.frontOperation.zFail===t.stencilTest.frontOperation.zFail&&e.stencilTest.backOperation.fail===t.stencilTest.backOperation.fail&&e.stencilTest.backOperation.zFail===t.stencilTest.backOperation.zFail&&e.stencilTest.backOperation.zPass===t.stencilTest.backOperation.zPass||n.push(S),e.sampleCoverage.enabled===t.sampleCoverage.enabled&&e.sampleCoverage.value===t.sampleCoverage.value&&e.sampleCoverage.invert===t.sampleCoverage.invert||n.push(A),n}var R=0,b={};c.fromCache=function(e){var t=JSON.stringify(e),n=b[t];if(r(n))return++n.referenceCount,n.state;var i=new c(e),a=JSON.stringify(i);return n=b[a],r(n)||(i.id=R++,n={referenceCount:0,state:i},b[a]=n),++n.referenceCount,b[t]={referenceCount:1,state:n.state},n.state},c.removeFromCache=function(e){var t=new c(e),n=JSON.stringify(t),i=b[n],a=JSON.stringify(e),o=b[a];r(o)&&0===--o.referenceCount&&(delete b[a],r(i)&&--i.referenceCount),r(i)&&0===i.referenceCount&&delete b[n]},c.getCache=function(){return b},c.clearCache=function(){b={}};var I=new e;return c.apply=function(e,t,n){f(e,t),d(e,t),m(e,t),h(e,t),_(e,t),v(e,t),g(e,t),y(e,t),E(e,t),S(e,t),A(e,t),p(e,t,n),C(e,t,n),x(e,t,n)},c.partialApply=function(e,t,n,i,a,o){if(t!==n){var s=n._applyFunctions[t.id];r(s)||(s=w(t,n),n._applyFunctions[t.id]=s);for(var u=s.length,c=0;c<u;++c)s[c](e,n)}((r(i.scissorTest)?i.scissorTest:t.scissorTest)!==(r(a.scissorTest)?a.scissorTest:n.scissorTest)||o)&&p(e,n,a);var l=r(i.blendingEnabled)?i.blendingEnabled:t.blending.enabled,f=r(a.blendingEnabled)?a.blendingEnabled:n.blending.enabled;(l!==f||f&&t.blending!==n.blending)&&C(e,n,a),t===n&&i===a&&i.context===a.context||x(e,n,a)},c.getState=function(n){return{frontFace:n.frontFace,cull:{enabled:n.cull.enabled,face:n.cull.face},lineWidth:n.lineWidth,polygonOffset:{enabled:n.polygonOffset.enabled,factor:n.polygonOffset.factor,units:n.polygonOffset.units},scissorTest:{enabled:n.scissorTest.enabled,rectangle:e.clone(n.scissorTest.rectangle)},depthRange:{near:n.depthRange.near,far:n.depthRange.far},depthTest:{enabled:n.depthTest.enabled,func:n.depthTest.func},colorMask:{red:n.colorMask.red,green:n.colorMask.green,blue:n.colorMask.blue,alpha:n.colorMask.alpha},depthMask:n.depthMask,stencilMask:n.stencilMask,blending:{enabled:n.blending.enabled,color:t.clone(n.blending.color),equationRgb:n.blending.equationRgb,equationAlpha:n.blending.equationAlpha,functionSourceRgb:n.blending.functionSourceRgb,functionSourceAlpha:n.blending.functionSourceAlpha,functionDestinationRgb:n.blending.functionDestinationRgb,functionDestinationAlpha:n.blending.functionDestinationAlpha},stencilTest:{enabled:n.stencilTest.enabled,frontFunction:n.stencilTest.frontFunction,backFunction:n.stencilTest.backFunction,reference:n.stencilTest.reference,mask:n.stencilTest.mask,frontOperation:{fail:n.stencilTest.frontOperation.fail,zFail:n.stencilTest.frontOperation.zFail,zPass:n.stencilTest.frontOperation.zPass},backOperation:{fail:n.stencilTest.backOperation.fail,zFail:n.stencilTest.backOperation.zFail,zPass:n.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:n.sampleCoverage.enabled,value:n.sampleCoverage.value,invert:n.sampleCoverage.invert},viewport:r(n.viewport)?e.clone(n.viewport):void 0}},c}),define("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Math","../Core/Matrix4","../Core/WebGLConstants"],function(e,t,n,r){"use strict";function i(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var a=new e;if("undefined"==typeof WebGLRenderingContext)return{};var o={};return o[r.FLOAT]="float",o[r.FLOAT_VEC2]="vec2",o[r.FLOAT_VEC3]="vec3",o[r.FLOAT_VEC4]="vec4",o[r.INT]="int",o[r.INT_VEC2]="ivec2",o[r.INT_VEC3]="ivec3",o[r.INT_VEC4]="ivec4",o[r.BOOL]="bool",o[r.BOOL_VEC2]="bvec2",o[r.BOOL_VEC3]="bvec3",o[r.BOOL_VEC4]="bvec4",o[r.FLOAT_MAT2]="mat2",o[r.FLOAT_MAT3]="mat3",o[r.FLOAT_MAT4]="mat4",o[r.SAMPLER_2D]="sampler2D",o[r.SAMPLER_CUBE]="samplerCube",i.prototype.getDeclaration=function(e){var t="uniform "+o[this._datatype]+" "+e,n=this._size;return t+=1===n?";":"["+n.toString()+"];"},{czm_viewport:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new i({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new i({size:1,datatype:r.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new i({size:1,datatype:r.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_log2FarDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2FarDistance}}),czm_log2FarPlusOne:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2FarPlusOne}}),czm_log2NearDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.log2NearDistance}}),czm_sunPositionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new i({size:1,datatype:r.FLOAT_VEC3,getValue:function(e){return n.getTranslation(e.inverseView,a)}}),czm_frameNumber:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new i({size:1,datatype:r.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new i({size:1,datatype:r.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_temeToPseudoFixed:new i({size:1,datatype:r.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new i({size:1,datatype:r.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new i({size:1,datatype:r.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}})}}),define("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/FeatureDetection","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e,t,n,r){switch(t.type){case e.FLOAT:return new d(e,t,n,r);case e.FLOAT_VEC2:return new m(e,t,n,r);case e.FLOAT_VEC3:return new h(e,t,n,r);case e.FLOAT_VEC4:return new p(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new _(e,t,n,r);case e.INT:case e.BOOL:return new v(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new g(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new y(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new E(e,t,n,r);case e.FLOAT_MAT2:return new T(e,t,n,r);case e.FLOAT_MAT3:return new C(e,t,n,r);case e.FLOAT_MAT4:return new S(e,t,n,r);default:throw new l("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}function d(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function m(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function h(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function p(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function _(e,t,n,r){this.name=n,this.value=void 0,this._gl=e,this._location=r,this.textureUnitIndex=void 0}function v(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function g(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function y(e,n,r,i){this.name=r,this.value=void 0,this._value=new t,this._gl=e,this._location=i}function E(e,t,r,i){this.name=r,this.value=void 0,this._value=new n,this._gl=e,this._location=i}function T(e,t,n,r){this.name=n,this.value=void 0,this._value=new s,this._gl=e,this._location=r}function C(e,t,n,r){this.name=n,this.value=void 0,this._value=new u,this._gl=e,this._location=r}function S(e,t,n,r){this.name=n,this.value=void 0,this._value=new c,this._gl=e,this._location=r}if(!o.supportsTypedArrays())return{};d.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},m.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2f(this._location,t.x,t.y))},h.prototype.set=function(){var e=this.value;i(e.red)?r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):i(e.x)&&(t.equals(e,this._value)||(this._value=t.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))},p.prototype.set=function(){var e=this.value;i(e.red)?r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):i(e.x)&&(n.equals(e,this._value)||(this._value=n.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))},_.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)},_.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},v.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},g.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2i(this._location,t.x,t.y))},y.prototype.set=function(){var e=this.value;t.equals(e,this._value)||(t.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},E.prototype.set=function(){var e=this.value;n.equals(e,this._value)||(n.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var A=new Float32Array(4);T.prototype.set=function(){if(!s.equalsArray(this.value,this._value,0)){s.clone(this.value,this._value);var e=s.toArray(this.value,A);this._gl.uniformMatrix2fv(this._location,!1,e)}};var x=new Float32Array(9);C.prototype.set=function(){if(!u.equalsArray(this.value,this._value,0)){u.clone(this.value,this._value);var e=u.toArray(this.value,x);this._gl.uniformMatrix3fv(this._location,!1,e)}};var w=new Float32Array(16);return S.prototype.set=function(){if(!c.equalsArray(this.value,this._value,0)){c.clone(this.value,this._value);var e=c.toArray(this.value,w);this._gl.uniformMatrix4fv(this._location,!1,e)}},f}),define("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,a,o,s,u,c){"use strict";function l(e,t,n,r){switch(t.type){case e.FLOAT:return new f(e,t,n,r);case e.FLOAT_VEC2:return new d(e,t,n,r);case e.FLOAT_VEC3:return new m(e,t,n,r);case e.FLOAT_VEC4:return new h(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new p(e,t,n,r);case e.INT:case e.BOOL:return new _(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new v(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new g(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,n,r);case e.FLOAT_MAT2:return new E(e,t,n,r);case e.FLOAT_MAT3:return new T(e,t,n,r);case e.FLOAT_MAT4:return new C(e,t,n,r);default:throw new c("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}function f(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._location=r[0]}function d(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(2*i),this._gl=e,this._location=r[0]}function m(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(3*i),this._gl=e,this._location=r[0]}function h(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function p(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._locations=r,this.textureUnitIndex=void 0}function _(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i),this._gl=e,this._location=r[0]}function v(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(2*i),this._gl=e,this._location=r[0]}function g(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(3*i),this._gl=e,this._location=r[0]}function y(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(4*i),this._gl=e,this._location=r[0]}function E(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function T(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(9*i),this._gl=e,this._location=r[0]}function C(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(16*i),this._gl=e,this._location=r[0]}return f.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var a=e[i];a!==n[i]&&(n[i]=a,r=!0)}r&&this._gl.uniform1fv(this._location,n)},d.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=t[o];e.equalsArray(s,r,a)||(e.pack(s,r,a),i=!0),a+=2}i&&this._gl.uniform2fv(this._location,r)},m.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,a=!1,o=0,s=0;s<n;++s){var u=e[s];i(u.red)?u.red===r[o]&&u.green===r[o+1]&&u.blue===r[o+2]||(r[o]=u.red,r[o+1]=u.green,r[o+2]=u.blue,a=!0):i(u.x)&&(t.equalsArray(u,r,o)||(t.pack(u,r,o),a=!0)),o+=3}a&&this._gl.uniform3fv(this._location,r)},h.prototype.set=function(){for(var e=this.value,t=e.length,a=this._value,o=!1,s=0,u=0;u<t;++u){var c=e[u];i(c.red)?r.equalsArray(c,a,s)||(r.pack(c,a,s),o=!0):i(c.x)&&(n.equalsArray(c,a,s)||(n.pack(c,a,s),o=!0)),s+=4}o&&this._gl.uniform4fv(this._location,a)},p.prototype.set=function(){for(var e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,r=n.length,i=0;i<r;++i){var a=n[i];e.activeTexture(t+i),e.bindTexture(a._target,a._texture)}},p.prototype._setSampler=function(e){this.textureUnitIndex=e;for(var t=this._locations,n=t.length,r=0;r<n;++r){var i=e+r;this._gl.uniform1i(t[r],i)}return e+n},_.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var a=e[i];a!==n[i]&&(n[i]=a,r=!0)}r&&this._gl.uniform1iv(this._location,n)},v.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=t[o];e.equalsArray(s,r,a)||(e.pack(s,r,a),i=!0),a+=2}i&&this._gl.uniform2iv(this._location,r)},g.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,i=!1,a=0,o=0;o<n;++o){var s=e[o];t.equalsArray(s,r,a)||(t.pack(s,r,a),i=!0),a+=3}i&&this._gl.uniform3iv(this._location,r)},y.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,a=0,o=0;o<t;++o){var s=e[o];n.equalsArray(s,r,a)||(n.pack(s,r,a),i=!0),a+=4}i&&this._gl.uniform4iv(this._location,r)},E.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var s=e[a];o.equalsArray(s,n,i)||(o.pack(s,n,i),r=!0),i+=4}r&&this._gl.uniformMatrix2fv(this._location,!1,n)},T.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var o=e[a];s.equalsArray(o,n,i)||(s.pack(o,n,i),r=!0),i+=9}r&&this._gl.uniformMatrix3fv(this._location,!1,n)},C.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,a=0;a<t;++a){var o=e[a];u.equalsArray(o,n,i)||(u.pack(o,n,i),r=!0),i+=16}r&&this._gl.uniformMatrix4fv(this._location,!1,n)},l}),
define("Renderer/ShaderProgram",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(e,t,n,r,i,a,o,s,u,c,l){"use strict";function f(e){var t=m(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=t.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=t.fragmentShaderText,this.id=E++}function d(e){var t=[],r=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(n(r))for(var i=r.length,a=0;a<i;a++){var o=r[a].trim(),s=o.slice(o.lastIndexOf(" ")+1);t.push(s)}return t}function m(e,t){var n={};if(!u.highpFloatSupported||!u.highpIntSupported){var r,i,a,o,s=d(e),c=d(t),l=s.length,f=c.length;for(r=0;r<l;r++)for(i=0;i<f;i++)if(s[r]===c[i]){a=s[r],o="czm_mediump_"+a;var m=new RegExp(a+"\\b","g");t=t.replace(m,o),n[o]=a}}return{fragmentShaderText:t,duplicateUniformNames:n}}function h(e,t){var r=t._vertexShaderText,i=t._fragmentShaderText,a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,r),e.compileShader(a);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);var u=e.createProgram();e.attachShader(u,a),e.attachShader(u,s),e.deleteShader(a),e.deleteShader(s);var c=t._attributeLocations;if(n(c))for(var l in c)c.hasOwnProperty(l)&&e.bindAttribLocation(u,c[l],l);e.linkProgram(u);var f;if(!e.getProgramParameter(u,e.LINK_STATUS)){var d=t._debugShaders;if(!e.getShaderParameter(s,e.COMPILE_STATUS)){if(f=e.getShaderInfoLog(s),console.error(T+"Fragment shader compile log: "+f),n(d)){var m=d.getTranslatedShaderSource(s);""!==m?console.error(T+"Translated fragment shader source:\n"+m):console.error(T+"Fragment shader translation failed.")}throw e.deleteProgram(u),new o("Fragment shader failed to compile.  Compile log: "+f)}if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(f=e.getShaderInfoLog(a),console.error(T+"Vertex shader compile log: "+f),n(d)){var h=d.getTranslatedShaderSource(a);""!==h?console.error(T+"Translated vertex shader source:\n"+h):console.error(T+"Vertex shader translation failed.")}throw e.deleteProgram(u),new o("Vertex shader failed to compile.  Compile log: "+f)}throw f=e.getProgramInfoLog(u),console.error(T+"Shader program link log: "+f),n(d)&&(console.error(T+"Translated vertex shader source:\n"+d.getTranslatedShaderSource(a)),console.error(T+"Translated fragment shader source:\n"+d.getTranslatedShaderSource(s))),e.deleteProgram(u),new o("Program failed to link.  Link log: "+f)}var p=t._logShaderCompilation;return p&&(f=e.getShaderInfoLog(a),n(f)&&f.length>0&&console.log(T+"Vertex shader compile log: "+f)),p&&(f=e.getShaderInfoLog(s),n(f)&&f.length>0&&console.log(T+"Fragment shader compile log: "+f)),p&&(f=e.getProgramInfoLog(u),n(f)&&f.length>0&&console.log(T+"Shader program link log: "+f)),u}function p(e,t,n){for(var r={},i=0;i<n;++i){var a=e.getActiveAttrib(t,i),o=e.getAttribLocation(t,a.name);r[a.name]={name:a.name,type:a.type,index:o}}return r}function _(e,t){for(var r={},i=[],a=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;++s){var u=e.getActiveUniform(t,s),f=-1!==u.name.indexOf("[0]",u.name.length-"[0]".length)?u.name.slice(0,u.name.length-3):u.name;if(0!==f.indexOf("gl_"))if(u.name.indexOf("[")<0){var d=e.getUniformLocation(t,f);if(null!==d){var m=c(e,u,f,d);r[f]=m,i.push(m),m._setSampler&&a.push(m)}}else{var h,p,_,v,g=f.indexOf("[");if(g>=0){if(h=r[f.slice(0,g)],!n(h))continue;p=h._locations,p.length<=1&&(_=h.value,null!==(v=e.getUniformLocation(t,f))&&(p.push(v),_.push(e.getUniform(t,v))))}else{p=[];for(var y=0;y<u.size;++y)null!==(v=e.getUniformLocation(t,f+"["+y+"]"))&&p.push(v);h=l(e,u,f,p),r[f]=h,i.push(h),h._setSampler&&a.push(h)}}}return{uniformsByName:r,uniforms:i,samplerUniforms:a}}function v(e,t){var r=[],i=[];for(var a in t)if(t.hasOwnProperty(a)){var o=t[a],u=a,c=e._duplicateUniformNames[u];n(c)&&(o.name=c,u=c);var l=s[u];n(l)?r.push({uniform:o,automaticUniform:l}):i.push(o)}return{automaticUniforms:r,manualUniforms:i}}function g(e,t,n){e.useProgram(t);for(var r=0,i=n.length,a=0;a<i;++a)r=n[a]._setSampler(r);return e.useProgram(null),r}function y(e){if(!n(e._program)){var t=e._gl,r=h(t,e,e._debugShaders),i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=_(t,r),o=v(e,a.uniformsByName);e._program=r,e._numberOfVertexAttributes=i,e._vertexAttributes=p(t,r,i),e._uniformsByName=a.uniformsByName,e._uniforms=a.uniforms,e._automaticUniforms=o.automaticUniforms,e._manualUniforms=o.manualUniforms,e.maximumTextureUnitIndex=g(t,r,a.samplerUniforms)}}var E=0;f.fromCache=function(e){return e=t(e,t.EMPTY_OBJECT),e.context.shaderCache.getShaderProgram(e)},f.replaceCache=function(e){return e=t(e,t.EMPTY_OBJECT),e.context.shaderCache.replaceShaderProgram(e)},r(f.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return y(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return y(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return y(this),this._uniformsByName}}});var T="[Cesium WebGL] ";return f.prototype._bind=function(){y(this),this._gl.useProgram(this._program)},f.prototype._setUniforms=function(e,t,r){var i,a;if(n(e)){var o=this._manualUniforms;for(i=o.length,a=0;a<i;++a){var s=o[a];s.value=e[s.name]()}}var u=this._automaticUniforms;for(i=u.length,a=0;a<i;++a){var c=u[a];c.uniform.value=c.automaticUniform.getValue(t)}var l=this._uniforms;for(i=l.length,a=0;a<i;++a)l[a].set();if(r){var f=this._gl,d=this._program;f.validateProgram(d)}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},f.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),i(this)},f}),define("Renderer/modernizeShader",["../Core/defined","../Core/DeveloperError"],function(e,t){"use strict";function n(e,n){var i=/#define OUTPUT_DECLARATION/,l=e.split("\n");if(/#version 300 es/g.test(e))return e;var f,d,m=-1;for(f=0;f<l.length;++f)if(d=l[f],i.test(d)){m=f;break}if(-1===m)throw new t("Could not find a #define OUTPUT_DECLARATION!");var h=[];for(f=0;f<10;f++){var p="gl_FragData\\["+f+"\\]",_="czm_out"+f;new RegExp(p,"g").test(e)&&(s(_,h),r(p,_,l),l.splice(m,0,"layout(location = "+f+") out vec4 "+_+";"),m+=1)}a("gl_FragColor",l)&&(s("czm_fragColor",h),r("gl_FragColor","czm_fragColor",l),l.splice(m,0,"layout(location = 0) out vec4 czm_fragColor;"),m+=1);var v=u(h,l),g={};for(f=0;f<l.length;f++){d=l[f];for(var y in v)if(v.hasOwnProperty(y)){var E=new RegExp("(layout)[^]+(out)[^]+("+y+")[^]+","g");E.test(d)&&(g[d]=y)}}for(var T in g)if(g.hasOwnProperty(T)){var C,S=g[T],A=l.indexOf(T),x=v[S],w=x.length;for(C=0;C<w;C++)l.splice(A,0,x[C]);for(A+=w+1,C=w-1;C>=0;C--)l.splice(A,0,"#endif //"+x[C])}var R=!1;for(f=0;f<l.length;f++)/#version/.test(l[f])&&(l[f]="#version 300 es",R=!0);return R||l.splice(0,0,"#version 300 es"),c("EXT_draw_buffers",l),c("EXT_frag_depth",l),r("texture2D","texture",l),r("texture3D","texture",l),r("textureCube","texture",l),r("gl_FragDepthEXT","gl_FragDepth",l),n?r("varying","in",l):(r("attribute","in",l),r("varying","out",l)),o(l)}function r(e,t,n){for(var r="(^|[^\\w])("+e+")($|[^\\w])",i=new RegExp(r,"g"),a=n.length,o=0;o<a;++o){var s=n[o];n[o]=s.replace(i,"$1"+t+"$3")}}function i(e,t,n){for(var r=n.length,i=0;i<r;++i){var a=n[i];n[i]=a.replace(e,t)}}function a(e,t){for(var n="(^|[^\\w])("+e+")($|[^\\w])",r=new RegExp(n,"g"),i=t.length,a=0;a<i;++a){var o=t[a];if(r.test(o))return!0}return!1}function o(e){for(var t="",n=e.length,r=0;r<n;++r)t+=e[r]+"\n";return t}function s(e,t){-1===t.indexOf(e)&&t.push(e)}function u(t,n){for(var r={},i=t.length,a=[],o=0;o<n.length;++o){var s=n[o],u=/(#ifdef|#if)/g.test(s),c=/#else/g.test(s),l=/#endif/g.test(s);if(u)a.push(s);else if(c){var f=a[a.length-1],d=f.replace("ifdef","ifndef");/if/g.test(d)&&(d=d.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),a.pop(),a.push(d)}else if(l)a.pop();else if(!/layout/g.test(s))for(var m=0;m<i;++m){var h=t[m];-1!==s.indexOf(h)&&(e(r[h])?r[h]=r[h].filter(function(e){return a.indexOf(e)>=0}):r[h]=a.slice())}}return r}function c(e,t){var n="#extension\\s+GL_"+e+"\\s+:\\s+[a-zA-Z0-9]+\\s*$";i(new RegExp(n,"g"),"",t)}return n}),define("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"const float czm_degreesPerRadian = 57.29577951308232;\n"}),define("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"}),define("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"const float czm_epsilon1 = 0.1;\n"}),define("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"const float czm_epsilon2 = 0.01;\n"}),define("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"const float czm_epsilon3 = 0.001;\n"}),define("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"const float czm_epsilon4 = 0.0001;\n"}),define("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"const float czm_epsilon5 = 0.00001;\n"}),define("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"const float czm_epsilon6 = 0.000001;\n"}),define("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"const float czm_epsilon7 = 0.0000001;\n"}),define("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"const float czm_infinity = 5906376272000.0;\n"}),define("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"const float czm_oneOverPi = 0.3183098861837907;\n"}),define("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"const float czm_oneOverTwoPi = 0.15915494309189535;\n"}),define("Shaders/Builtin/Constants/passCesium3DTile",[],function(){"use strict";return"const float czm_passCesium3DTile = 4.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassification",[],function(){"use strict";return"const float czm_passCesium3DTileClassification = 5.0;\n"}),define("Shaders/Builtin/Constants/passCesium3DTileClassificationIgnoreShow",[],function(){"use strict";return"const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;\n"}),define("Shaders/Builtin/Constants/passClassification",[],function(){"use strict";return"const float czm_passClassification = 7.0;\n"}),define("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"const float czm_passCompute = 1.0;\n"}),define("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"const float czm_passEnvironment = 0.0;\n"}),define("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"const float czm_passGlobe = 2.0;\n"}),define("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"const float czm_passOpaque = 8.0;\n"}),define("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"const float czm_passOverlay = 10.0;\n"}),define("Shaders/Builtin/Constants/passTerrainClassification",[],function(){"use strict";return"const float czm_passTerrainClassification = 3.0;\n"}),define("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"const float czm_passTranslucent = 9.0;\n"}),define("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"const float czm_pi = 3.141592653589793;\n"}),define("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"const float czm_piOverFour = 0.7853981633974483;\n"}),define("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"const float czm_piOverSix = 0.5235987755982988;\n"}),define("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"const float czm_piOverThree = 1.0471975511965976;\n"}),define("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"const float czm_piOverTwo = 1.5707963267948966;\n"}),define("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"const float czm_radiansPerDegree = 0.017453292519943295;\n"}),define("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"const float czm_sceneMode2D = 2.0;\n"}),define("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"const float czm_sceneMode3D = 3.0;\n"}),define("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"const float czm_sceneModeColumbusView = 1.0;\n"}),define("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"const float czm_sceneModeMorphing = 0.0;\n"}),define("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"const float czm_solarRadius = 695500000.0;\n"}),define("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"const float czm_threePiOver2 = 4.71238898038469;\n"}),define("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"const float czm_twoPi = 6.283185307179586;\n"}),define("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"}),define("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n"}),define("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n"}),define("Shaders/Builtin/Structs/material",[],function(){"use strict";return"struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n"}),define("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\nfloat height;\nfloat slope;\n};\n"}),define("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n"}),define("Shaders/Builtin/Structs/raySegment",[],function(){"use strict";return"struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"}),define("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n"}),define("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"float czm_alphaWeight(float a)\n{\nfloat z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));\n}\n"}),define("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"}),define("Shaders/Builtin/Functions/approximateSphericalCoordinates",[],function(){"use strict";return"vec2 czm_approximateSphericalCoordinates(vec3 normal) {\nfloat latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);\nfloat longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);\nreturn vec2(latitudeApproximation, longitudeApproximation);\n}\n"}),define("Shaders/Builtin/Functions/branchFreeTernary",[],function(){"use strict";return"float czm_branchFreeTernary(bool comparison, float a, float b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\n"}),define("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n"}),define("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n"}),define("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n"}),define("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"vec4 czm_computePosition();\n"}),define("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n"}),define("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n"}),define("Shaders/Builtin/Functions/depthClampFarPlane",[],function(){"use strict";return"#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvec4 czm_depthClampFarPlane(vec4 coords)\n{\n#ifndef LOG_DEPTH\nv_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;\ncoords.z = min(coords.z, coords.w);\n#endif\nreturn coords;\n}\n"}),define("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict";return"czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"}),define("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n"}),define("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n"}),define("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/fastApproximateAtan",[],function(){"use strict";return"float czm_fastApproximateAtan(float x) {\nreturn x * (-0.1784 * x - 0.0663 * x * x + 1.0301);\n}\nfloat czm_fastApproximateAtan(float x, float y) {\nfloat t = abs(x);\nfloat opposite = abs(y);\nfloat adjacent = max(t, opposite);\nopposite = min(t, opposite);\nt = czm_fastApproximateAtan(opposite / adjacent);\nt = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);\nt = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);\nt = czm_branchFreeTernary(y < 0.0, -t, t);\nreturn t;\n}\n"}),define("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\n"}),define("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"}),define("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n"}),define("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"}),define("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n"}),define("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n"}),define("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),define("Shaders/Builtin/Functions/HSBToRGB",[],function(){"use strict";return"const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 czm_HSBToRGB(vec3 hsb)\n{\nvec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n"}),define("Shaders/Builtin/Functions/HSLToRGB",[],function(){"use strict";return"vec3 hueToRGB(float hue)\n{\nfloat r = abs(hue * 6.0 - 3.0) - 1.0;\nfloat g = 2.0 - abs(hue * 6.0 - 2.0);\nfloat b = 2.0 - abs(hue * 6.0 - 4.0);\nreturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 czm_HSLToRGB(vec3 hsl)\n{\nvec3 rgb = hueToRGB(hsl.x);\nfloat c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\nreturn (rgb - 0.5) * c + hsl.z;\n}\n"}),define("Shaders/Builtin/Functions/hue",[],function(){"use strict"
;return"vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n"}),define("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n"}),define("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"}),define("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"}),define("Shaders/Builtin/Functions/lineDistance",[],function(){"use strict";return"float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {\nreturn abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);\n}\n"}),define("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n"}),define("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n"}),define("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),define("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"}),define("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n"}),define("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return"vec3 czm_octDecode(vec2 encoded, float range)\n{\nif (encoded.x == 0.0 && encoded.y == 0.0) {\nreturn vec3(0.0, 0.0, 0.0);\n}\nencoded = encoded / range * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(vec2 encoded)\n{\nreturn czm_octDecode(encoded, 255.0);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n"}),define("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n"}),define("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/planeDistance",[],function(){"use strict";return"float czm_planeDistance(vec4 plane, vec3 point) {\nreturn (dot(plane.xyz, point) + plane.w);\n}\nfloat czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {\nreturn (dot(planeNormal, point) + planeDistance);\n}\n"}),define("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n"}),define("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n"}),define("Shaders/Builtin/Functions/readDepth",[],function(){"use strict";return"float czm_readDepth(sampler2D depthTexture, vec2 texCoords)\n{\nreturn czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);\n}\n"}),define("Shaders/Builtin/Functions/reverseLogDepth",[],function(){"use strict";return"float czm_reverseLogDepth(float logZ)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nlogZ = pow(2.0, logZ * czm_log2FarPlusOne) - 1.0;\nlogZ = far * (1.0 - near / logZ) / (far - near);\n#endif\nreturn logZ;\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSB",[],function(){"use strict";return"const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec3 czm_RGBToHSB(vec3 rgb)\n{\nvec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\nvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n"}),define("Shaders/Builtin/Functions/RGBToHSL",[],function(){"use strict";return"vec3 RGBtoHCV(vec3 rgb)\n{\nvec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\nvec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\nfloat c = q.x - min(q.w, q.y);\nfloat h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\nreturn vec3(h, c, q.x);\n}\nvec3 czm_RGBToHSL(vec3 rgb)\n{\nvec3 hcv = RGBtoHCV(rgb);\nfloat l = hcv.z - hcv.y * 0.5;\nfloat s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\nreturn vec3(hcv.x, s, l);\n}\n"});define("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n"}),define("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n"}),define("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"}),define("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"}),define("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"}),define("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 bitangent = normalize(bitangentEC);\nreturn mat3(tangent.x  , tangent.y  , tangent.z,\nbitangent.x, bitangent.y, bitangent.z,\nnormal.x   , normal.y   , normal.z);\n}\n"}),define("Shaders/Builtin/Functions/transformPlane",[],function(){"use strict";return"vec4 czm_transformPlane(vec4 clippingPlane, mat4 transform) {\nvec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);\nvec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;\nvec4 transformedPlane;\ntransformedPlane.xyz = transformedDirection;\ntransformedPlane.w = -dot(transformedDirection, transformedPosition);\nreturn transformedPlane;\n}\n"}),define("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n"}),define("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),define("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"}),define("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n"}),define("Shaders/Builtin/Functions/unpackFloat",[],function(){"use strict";return"#define SHIFT_RIGHT_8 0.00390625 //1.0 / 256.0\n#define SHIFT_RIGHT_16 0.00001525878 //1.0 / 65536.0\n#define SHIFT_RIGHT_24 5.960464477539063e-8//1.0 / 16777216.0\n#define BIAS 38.0\nfloat czm_unpackFloat(vec4 packedFloat)\n{\npackedFloat *= 255.0;\nfloat temp = packedFloat.w / 2.0;\nfloat exponent = floor(temp);\nfloat sign = (temp - exponent) * 2.0;\nexponent = exponent - float(BIAS);\nsign = sign * 2.0 - 1.0;\nsign = -sign;\nfloat unpacked = sign * packedFloat.x * float(SHIFT_RIGHT_8);\nunpacked += sign * packedFloat.y * float(SHIFT_RIGHT_16);\nunpacked += sign * packedFloat.z * float(SHIFT_RIGHT_24);\nreturn unpacked * pow(10.0, exponent);\n}\n"}),define("Shaders/Builtin/Functions/vertexLogDepth",[],function(){"use strict";return"#ifdef LOG_DEPTH\nvarying float v_logZ;\n#ifdef SHADOW_MAP\nvarying vec3 v_logPositionEC;\n#endif\n#endif\nvoid czm_updatePositionDepth() {\n#if defined(LOG_DEPTH) && !defined(DISABLE_GL_POSITION_LOG_DEPTH)\nvec3 logPositionEC = (czm_inverseProjection * gl_Position).xyz;\n#ifdef SHADOW_MAP\nv_logPositionEC = logPositionEC;\n#endif\n#ifdef ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT\nif (length(logPositionEC) < 2.0e6)\n{\nreturn;\n}\n#endif\ngl_Position.z = log2(max(1e-6, 1.0 + gl_Position.w)) * czm_log2FarDistance - 1.0;\ngl_Position.z *= gl_Position.w;\n#endif\n}\nvoid czm_vertexLogDepth()\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + gl_Position.w;\nczm_updatePositionDepth();\n#endif\n}\nvoid czm_vertexLogDepth(vec4 clipCoords)\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + clipCoords.w;\nczm_updatePositionDepth();\n#endif\n}\n"}),define("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict";return"vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nif (!(czm_inverseProjection == mat4(0.0)))\n{\nq = czm_inverseProjection * q;\n}\nelse\n{\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn q;\n}\nvec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nfloat unscaledDepth = pow(2.0, depthOrLogDepth * czm_log2FarPlusOne) - 1.0;\nvec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / unscaledDepth) / (far - near), 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\neyeCoordinate.w = 1.0 / unscaledDepth;\n#else\nvec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\n#endif\nreturn eyeCoordinate;\n}\n"}),define("Shaders/Builtin/Functions/writeDepthClampedToFarPlane",[],function(){"use strict";return"#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvoid czm_writeDepthClampedToFarPlane()\n{\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n"}),define("Shaders/Builtin/Functions/writeLogDepth",[],function(){"use strict";return"#ifdef LOG_DEPTH\nvarying float v_logZ;\n#endif\nvoid czm_writeLogDepth(float logZ)\n{\n#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH) && !defined(DISABLE_LOG_DEPTH_FRAGMENT_WRITE)\nfloat halfLogFarDistance = czm_log2FarDistance * 0.5;\nfloat depth = log2(logZ);\nif (depth < czm_log2NearDistance) {\ndiscard;\n}\ngl_FragDepthEXT = depth * halfLogFarDistance;\n#endif\n}\nvoid czm_writeLogDepth() {\n#ifdef LOG_DEPTH\nczm_writeLogDepth(v_logZ);\n#endif\n}\n"}),define("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n"}),define("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCesium3DTile","./Constants/passCesium3DTileClassification","./Constants/passCesium3DTileClassificationIgnoreShow","./Constants/passClassification","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTerrainClassification","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/approximateSphericalCoordinates","./Functions/branchFreeTernary","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/depthClampFarPlane","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fastApproximateAtan","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/HSBToRGB","./Functions/HSLToRGB","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/lineDistance","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/planeDistance","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/readDepth","./Functions/reverseLogDepth","./Functions/RGBToHSB","./Functions/RGBToHSL","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/transformPlane","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/unpackFloat","./Functions/vertexLogDepth","./Functions/windowToEyeCoordinates","./Functions/writeDepthClampedToFarPlane","./Functions/writeLogDepth","./Functions/XYZToRGB"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A,x,w,R,b,I,O,D,P,M,N,z,F,L,B,U,G,V,k,q,H,W,Y,X,j,Z,K,J,Q,$,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,de,me,he,pe,_e,ve,ge,ye,Ee,Te,Ce,Se,Ae,xe,we,Re,be,Ie,Oe,De,Pe,Me,Ne,ze,Fe,Le,Be,Ue,Ge,Ve,ke,qe,He,We,Ye,Xe,je,Ze,Ke,Je,Qe,$e,et,tt,nt){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:n,czm_epsilon2:r,czm_epsilon3:i,czm_epsilon4:a,czm_epsilon5:o,czm_epsilon6:s,czm_epsilon7:u,czm_infinity:c,czm_oneOverPi:l,czm_oneOverTwoPi:f,czm_passCesium3DTile:d,czm_passCesium3DTileClassification:m,czm_passCesium3DTileClassificationIgnoreShow:h,czm_passClassification:p,czm_passCompute:_,czm_passEnvironment:v,czm_passGlobe:g,czm_passOpaque:y,czm_passOverlay:E,czm_passTerrainClassification:T,czm_passTranslucent:C,czm_pi:S,czm_piOverFour:A,czm_piOverSix:x,czm_piOverThree:w,czm_piOverTwo:R,czm_radiansPerDegree:b,czm_sceneMode2D:I,czm_sceneMode3D:O,czm_sceneModeColumbusView:D,czm_sceneModeMorphing:P,czm_solarRadius:M,czm_threePiOver2:N,czm_twoPi:z,czm_webMercatorMaxLatitude:F,czm_depthRangeStruct:L,czm_ellipsoid:B,czm_material:U,czm_materialInput:G,czm_ray:V,czm_raySegment:k,czm_shadowParameters:q,czm_alphaWeight:H,czm_antialias:W,czm_approximateSphericalCoordinates:Y,czm_branchFreeTernary:X,czm_cascadeColor:j,czm_cascadeDistance:Z,czm_cascadeMatrix:K,czm_cascadeWeights:J,czm_columbusViewMorph:Q,czm_computePosition:$,czm_cosineAndSine:ee,czm_decompressTextureCoordinates:te,czm_depthClampFarPlane:ne,czm_eastNorthUpToEyeCoordinates:re,czm_ellipsoidContainsPoint:ie,czm_ellipsoidNew:ae,czm_ellipsoidWgs84TextureCoordinates:oe,czm_equalsEpsilon:se,czm_eyeOffset:ue,czm_eyeToWindowCoordinates:ce,czm_fastApproximateAtan:le,czm_fog:fe,czm_geodeticSurfaceNormal:de,czm_getDefaultMaterial:me,czm_getLambertDiffuse:he,czm_getSpecular:pe,czm_getWaterNoise:_e,czm_getWgs84EllipsoidEC:ve,czm_HSBToRGB:ge,czm_HSLToRGB:ye,czm_hue:Ee,czm_isEmpty:Te,czm_isFull:Ce,czm_latitudeToWebMercatorFraction:Se,czm_lineDistance:Ae,czm_luminance:xe,czm_metersPerPixel:we,czm_modelToWindowCoordinates:Re,czm_multiplyWithColorBalance:be,czm_nearFarScalar:Ie,czm_octDecode:Oe,czm_packDepth:De,czm_phong:Pe,czm_planeDistance:Me,czm_pointAlongRay:Ne,czm_rayEllipsoidIntersectionInterval:ze,czm_readDepth:Fe,czm_reverseLogDepth:Le,czm_RGBToHSB:Be,czm_RGBToHSL:Ue,czm_RGBToXYZ:Ge,czm_saturation:Ve,czm_shadowDepthCompare:ke,czm_shadowVisibility:qe,czm_signNotZero:He,czm_tangentToEyeSpaceMatrix:We,czm_transformPlane:Ye,czm_translateRelativeToEye:Xe,czm_translucentPhong:je,czm_transpose:Ze,czm_unpackDepth:Ke,czm_unpackFloat:Je,czm_vertexLogDepth:Qe,czm_windowToEyeCoordinates:$e,czm_writeDepthClampedToFarPlane:et,czm_writeLogDepth:tt,czm_XYZToRGB:nt}}),define("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Renderer/modernizeShader","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(e,t,n,r,i,a){"use strict";function o(e){return e=e.replace(/\/\/.*/g,""),e.replace(/\/\*\*[\s\S]*?\*\//gm,function(e){for(var t=e.match(/\n/gm).length,n="",r=0;r<t;++r)n+="\n";return n})}function s(e,n,r){for(var i,a=0;a<r.length;++a)r[a].name===e&&(i=r[a]);return t(i)||(n=o(n),i={name:e,glslSource:n,dependsOn:[],requiredBy:[],evaluated:!1},r.push(i)),i}function u(e,n){if(!e.evaluated){e.evaluated=!0;var r=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);t(r)&&null!==r&&(r=r.filter(function(e,t){return r.indexOf(e)===t}),r.forEach(function(t){if(t!==e.name&&d._czmBuiltinsAndUniforms.hasOwnProperty(t)){var r=s(t,d._czmBuiltinsAndUniforms[t],n);e.dependsOn.push(r),r.requiredBy.push(e),u(r,n)}}))}}function c(e){for(var t=[],n=[];e.length>0;){var r=e.pop();n.push(r),0===r.requiredBy.length&&t.push(r)}for(;t.length>0;){var i=t.shift();e.push(i);for(var a=0;a<i.dependsOn.length;++a){var o=i.dependsOn[a],s=o.requiredBy.indexOf(i);o.requiredBy.splice(s,1),0===o.requiredBy.length&&t.push(o)}}for(var u=[],c=0;c<n.length;++c)0!==n[c].requiredBy.length&&u.push(n[c])}function l(e){var t=[],n=s("main",e,t);u(n,t),c(t);for(var r="",i=t.length-1;i>=0;--i)r=r+t[i].glslSource+"\n";return r.replace(n.glslSource,"")}function f(e,n,i){var a,s,u="",c=e.sources;if(t(c))for(a=0,s=c.length;a<s;++a)u+="\n#line 0\n"+c[a];u=o(u);var f;u=u.replace(/#version\s+(.*?)\n/gm,function(e,t){return f=t,"\n"});var m=[];u=u.replace(/#extension.*\n/gm,function(e){return m.push(e),"\n"}),u=u.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var h=e.pickColorQualifier;t(h)&&(u=d.createPickFragmentShaderSource(u,h));var p="";t(f)&&(p="#version "+f+"\n");var _=m.length;for(a=0;a<_;a++)p+=m[a];n&&(p+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n");var v=e.defines;if(t(v))for(a=0,s=v.length;a<s;++a){var g=v[a];0!==g.length&&(p+="#define "+g+"\n")}return i.webgl2&&(p+="#define OUTPUT_DECLARATION\n\n"),e.includeBuiltIns&&(p+=l(u)),p+="\n#line 0\n",p+=u,i.webgl2&&(p=r(p,n,!0)),p}function d(n){n=e(n,e.EMPTY_OBJECT);var r=n.pickColorQualifier;this.defines=t(n.defines)?n.defines.slice(0):[],this.sources=t(n.sources)?n.sources.slice(0):[],this.pickColorQualifier=r,this.includeBuiltIns=e(n.includeBuiltIns,!0)}d.prototype.clone=function(){return new d({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},d.replaceMain=function(e,t){return t="void "+t+"()",e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)},d.prototype.createCombinedVertexShader=function(e){return f(this,!1,e)},d.prototype.createCombinedFragmentShader=function(e){return f(this,!0,e)},d._czmBuiltinsAndUniforms={};for(var m in i)i.hasOwnProperty(m)&&(d._czmBuiltinsAndUniforms[m]=i[m]);for(var h in a)if(a.hasOwnProperty(h)){var p=a[h];"function"==typeof p.getDeclaration&&(d._czmBuiltinsAndUniforms[h]=p.getDeclaration(h))}d.createPickVertexShaderSource=function(e){return d.replaceMain(e,"czm_old_main")+"\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}"},d.createPickFragmentShaderSource=function(e,t){return d.replaceMain(e,"czm_old_main")+"\n"+t+" vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}"},d.findVarying=function(e,t){for(var n=e.sources,r=t.length,i=0;i<r;++i)for(var a=t[i],o=n.length,s=0;s<o;++s)if(-1!==n[s].indexOf(a))return a}
;var _=["v_normalEC","v_normal"];d.findNormalVarying=function(e){return d.findVarying(e,_)};var v=["v_positionEC"];return d.findPositionVarying=function(e){return d.findVarying(e,v)},d}),define("Scene/BlendEquation",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT,MIN:t.MIN,MAX:t.MAX})}),define("Scene/BlendFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE})}),define("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,n){"use strict";return e({DISABLED:e({enabled:!1}),ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.ONE,functionSourceAlpha:n.ONE,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE,functionDestinationAlpha:n.ONE})})}),define("Scene/CullFace",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK})}),define("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this.position=e(t.position,!1),this.normal=e(t.normal,!1),this.st=e(t.st,!1),this.bitangent=e(t.bitangent,!1),this.tangent=e(t.tangent,!1),this.color=e(t.color,!1)}return i.POSITION_ONLY=r(new i({position:!0})),i.POSITION_AND_NORMAL=r(new i({position:!0,normal:!0})),i.POSITION_NORMAL_AND_ST=r(new i({position:!0,normal:!0,st:!0})),i.POSITION_AND_ST=r(new i({position:!0,st:!0})),i.POSITION_AND_COLOR=r(new i({position:!0,color:!0})),i.ALL=r(new i({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),i.DEFAULT=i.POSITION_NORMAL_AND_ST,i.packedLength=6,i.pack=function(t,n,r){return r=e(r,0),n[r++]=t.position?1:0,n[r++]=t.normal?1:0,n[r++]=t.st?1:0,n[r++]=t.tangent?1:0,n[r++]=t.bitangent?1:0,n[r]=t.color?1:0,n},i.unpack=function(n,r,a){return r=e(r,0),t(a)||(a=new i),a.position=1===n[r++],a.normal=1===n[r++],a.st=1===n[r++],a.tangent=1===n[r++],a.bitangent=1===n[r++],a.color=1===n[r],a},i.clone=function(e,n){if(t(e))return t(n)||(n=new i),n.position=e.position,n.normal=e.normal,n.st=e.st,n.tangent=e.tangent,n.bitangent=e.bitangent,n.color=e.color,n},i}),define("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n"}),define("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n"}),define("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\n#ifdef POLYLINE_DASH\nvec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\nvec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\nvec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\nvec2 lineDir;\nif (usePrevious) {\nlineDir = normalize(positionWindow.xy - previousWindow.xy);\n}\nelse {\nlineDir = normalize(nextWindow.xy - positionWindow.xy);\n}\nangle = atan(lineDir.x, lineDir.y) - 1.570796327;\nangle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\nif (czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || clipped)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nreturn getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n"}),define("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(e,t,n,r,i,a,o){"use strict";function s(e){e=n(e,n.EMPTY_OBJECT),this.material=e.material,this.translucent=n(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=n(e.closed,!1)}return i(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),s.prototype.getFragmentShaderSource=function(){var e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),r(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},s.prototype.isTranslucent=function(){return r(this.material)&&this.material.isTranslucent()||!r(this.material)&&this.translucent},s.prototype.getRenderState=function(){var t=this.isTranslucent(),n=e(this.renderState,!1);return t?(n.depthMask=!1,n.blending=a.ALPHA_BLEND):n.depthMask=!0,n},s.getDefaultRenderState=function(e,n,i){var s={depthTest:{enabled:!0}};return e&&(s.depthMask=!1,s.blending=a.ALPHA_BLEND),n&&(s.cull={enabled:!0,face:o.BACK}),r(i)&&(s=t(i,s,!0)),s},s}),define("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(e,t,n,r,i,a,o){"use strict";function s(t){t=e(t,e.EMPTY_OBJECT);var n=e(t.translucent,!0),r=s.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=e(t.vertexShaderSource,u),this._fragmentShaderSource=e(t.fragmentShaderSource,c),this._renderState=o.getDefaultRenderState(n,!1,t.renderState),this._closed=!1,this._vertexFormat=r}var u=a+"\n"+i,c=r;return t(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),s.VERTEX_FORMAT=n.POSITION_ONLY,s.prototype.getFragmentShaderSource=o.prototype.getFragmentShaderSource,s.prototype.isTranslucent=o.prototype.isTranslucent,s.prototype.getRenderState=o.prototype.getRenderState,s}),define("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n"}),define("Shaders/PolylineFS",[],function(){"use strict";return"#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\ngl_FragColor *= u_highlightColor;\n#endif\nczm_writeLogDepth();\n}\n"}),define("Core/createGuid",[],function(){"use strict";function e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}return e}),define("Core/CompressedTextureBuffer",["./defined","./defineProperties"],function(e,t){"use strict";function n(e,t,n,r){this._format=e,this._width=t,this._height=n,this._buffer=r}return t(n.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}}),n.clone=function(t){if(e(t))return new n(t._format,t._width,t._height,t._buffer)},n.prototype.clone=function(){return n.clone(this)},n}),define("Core/TaskProcessor",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./Event","./FeatureDetection","./getAbsoluteUri","./isCrossOriginUrl","./Resource","./RuntimeError","require"],function(e,t,n,r,i,a,o,s,u,c,l,f,d){"use strict";function m(){if(!r(y._canTransferArrayBuffer)){var t=new Worker(p("Workers/transferTypedArrayTest.js"));t.postMessage=n(t.webkitPostMessage,t.postMessage);var i=new Int8Array([99]);try{t.postMessage({array:i},[i.buffer])}catch(e){return y._canTransferArrayBuffer=!1,y._canTransferArrayBuffer}var a=e.defer();t.onmessage=function(e){var n=e.data.array,i=r(n)&&99===n[0];a.resolve(i),t.terminate(),y._canTransferArrayBuffer=i},y._canTransferArrayBuffer=a.promise}return y._canTransferArrayBuffer}function h(e,t){--e._activeTasks;var n=t.id;if(r(n)){var i=e._deferreds,o=i[n];if(r(t.error)){var s=t.error;"RuntimeError"===s.name?(s=new f(t.error.message),s.stack=t.error.stack):"DeveloperError"===s.name&&(s=new a(t.error.message),s.stack=t.error.stack),T.raiseEvent(s),o.reject(s)}else T.raiseEvent(),o.resolve(t.result);delete i[n]}}function p(e){var n=t(e);if(c(n)){var r,i='importScripts("'+n+'");';try{r=new Blob([i],{type:"application/javascript"})}catch(e){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=new a;o.append(i),r=o.getBlob("application/javascript")}n=(window.URL||window.webkitURL).createObjectURL(r)}return n}function _(){return r(E)||(E=p("Workers/cesiumWorkerBootstrapper.js")),E}function v(e){var i=new Worker(_());i.postMessage=n(i.webkitPostMessage,i.postMessage);var a={loaderConfig:{},workerModule:y._workerModulePrefix+e._workerName};return r(y._loaderConfig)?a.loaderConfig=y._loaderConfig:(r(define.amd)&&!define.amd.toUrlUndefined&&r(d.toUrl)||(a.loaderConfig.paths={Workers:t("Workers")}),a.loaderConfig.baseUrl=t.getCesiumBaseUrl().url),i.postMessage(a),i.onmessage=function(t){h(e,t.data)},i}function g(n,i){var a={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!s.supportsWebAssembly()){if(!r(i.fallbackModulePath))throw new f("This browser does not support Web Assembly, and no backup module was provided for "+n._workerName);return a.modulePath=t(i.fallbackModulePath),e.resolve(a)}return a.modulePath=t(i.modulePath),a.wasmBinaryFile=t(i.wasmBinaryFile),l.fetchArrayBuffer({url:a.wasmBinaryFile}).then(function(e){return a.wasmBinary=e,a})}function y(e,t){this._workerName=e,this._maximumActiveTasks=n(t,5),this._activeTasks=0,this._deferreds={},this._nextID=0}var E,T=new o,C=[];return y.prototype.scheduleTask=function(t,n){if(r(this._worker)||(this._worker=v(this)),!(this._activeTasks>=this._maximumActiveTasks)){++this._activeTasks;var i=this;return e(m(),function(a){r(n)?a||(n.length=0):n=C;var o=i._nextID++,s=e.defer();return i._deferreds[o]=s,i._worker.postMessage({id:o,parameters:t,canTransferArrayBuffer:a},n),s.promise})}},y.prototype.initWebAssemblyModule=function(t){r(this._worker)||(this._worker=v(this));var n=e.defer(),i=this,a=this._worker;return g(this,t).then(function(t){return e(m(),function(e){var o,s=t.wasmBinary;r(s)&&e&&(o=[s]),a.onmessage=function(e){a.onmessage=function(e){h(i,e.data)},n.resolve(e.data)},a.postMessage({webAssemblyConfig:t},o)})}),n},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return r(this._worker)&&this._worker.terminate(),i(this)},y.taskCompletedEvent=T,y._defaultWorkerModulePrefix="Workers/",y._workerModulePrefix=y._defaultWorkerModulePrefix,y._loaderConfig=void 0,y._canTransferArrayBuffer=void 0,y}),define("Core/loadCRN",["../ThirdParty/when","./CompressedTextureBuffer","./defined","./DeveloperError","./Resource","./TaskProcessor"],function(e,t,n,r,i,a){"use strict";function o(r){var a;if(r instanceof ArrayBuffer||ArrayBuffer.isView(r))a=e.resolve(r);else{a=i.createIfNeeded(r).fetchArrayBuffer()}if(n(a))return a.then(function(e){if(n(e)){var t=[];return e instanceof ArrayBuffer?t.push(e):0===e.byteOffset&&e.byteLength===e.buffer.byteLength?t.push(e.buffer):(e=e.slice(0,e.length),t.push(e.buffer)),s.scheduleTask(e,t)}}).then(function(e){return t.clone(e)})}var s=new a("transcodeCRNToDXT",Number.POSITIVE_INFINITY);return o}),define("Renderer/PixelDatatype",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,HALF_FLOAT:t.HALF_FLOAT_OES,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,isPacked:function(e){return e===n.UNSIGNED_INT_24_8||e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case n.UNSIGNED_BYTE:return 1;case n.UNSIGNED_SHORT:case n.UNSIGNED_SHORT_4_4_4_4:case n.UNSIGNED_SHORT_5_5_5_1:case n.UNSIGNED_SHORT_5_6_5:case n.HALF_FLOAT:return 2;case n.UNSIGNED_INT:case n.FLOAT:case n.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===n.UNSIGNED_BYTE||e===n.UNSIGNED_SHORT||e===n.UNSIGNED_INT||e===n.FLOAT||e===n.HALF_FLOAT||e===n.UNSIGNED_INT_24_8||e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5}};return e(n)}),define("Core/PixelFormat",["../Renderer/PixelDatatype","./freezeObject","./WebGLConstants"],function(e,t,n){"use strict";var r={DEPTH_COMPONENT:n.DEPTH_COMPONENT,DEPTH_STENCIL:n.DEPTH_STENCIL,ALPHA:n.ALPHA,RGB:n.RGB,RGBA:n.RGBA,LUMINANCE:n.LUMINANCE,LUMINANCE_ALPHA:n.LUMINANCE_ALPHA,RGB_DXT1:n.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:n.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:n.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:n.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:n.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case r.RGB:return 3;case r.RGBA:return 4;case r.LUMINANCE_ALPHA:return 2;case r.ALPHA:case r.LUMINANCE:default:return 1}},validate:function(e){return e===r.DEPTH_COMPONENT||e===r.DEPTH_STENCIL||e===r.ALPHA||e===r.RGB||e===r.RGBA||e===r.LUMINANCE||e===r.LUMINANCE_ALPHA||e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5||e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1||e===r.RGB_ETC1},isColorFormat:function(e){return e===r.ALPHA||e===r.RGB||e===r.RGBA||e===r.LUMINANCE||e===r.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===r.DEPTH_COMPONENT||e===r.DEPTH_STENCIL},isCompressedFormat:function(e){return e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5||e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1||e===r.RGB_ETC1},isDXTFormat:function(e){return e===r.RGB_DXT1||e===r.RGBA_DXT1||e===r.RGBA_DXT3||e===r.RGBA_DXT5},isPVRTCFormat:function(e){return e===r.RGB_PVRTC_4BPPV1||e===r.RGB_PVRTC_2BPPV1||e===r.RGBA_PVRTC_4BPPV1||e===r.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===r.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,n){switch(e){case r.RGB_DXT1:case r.RGBA_DXT1:case r.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case r.RGBA_DXT3:case r.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case r.RGB_PVRTC_4BPPV1:case r.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case r.RGB_PVRTC_2BPPV1:case r.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(t,n,i,a){var o=r.componentsLength(t);return e.isPacked(n)&&(o=1),o*e.sizeInBytes(n)*i*a},createTypedArray:function(t,n,i,a){var o=e.sizeInBytes(n);return new(o===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:o===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:o===Float32Array.BYTES_PER_ELEMENT&&n===e.FLOAT?Float32Array:Uint32Array)(r.componentsLength(t)*i*a)},flipY:function(e,t,n,i,a){if(1===a)return e;for(var o=r.createTypedArray(t,n,i,a),s=r.componentsLength(t),u=i*s,c=0;c<a;++c)for(var l=c*a*s,f=(a-c-1)*a*s,d=0;d<u;++d)o[f+d]=e[l+d];return o}};return t(r)}),define("Core/loadKTX",["../ThirdParty/when","./Check","./CompressedTextureBuffer","./defined","./PixelFormat","./Resource","./RuntimeError"],function(e,t,n,r,i,a,o){"use strict";function s(t){var n;if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))n=e.resolve(t);else{n=a.createIfNeeded(t).fetchArrayBuffer()}if(r(n))return n.then(function(e){if(r(e))return u(e)})}function u(e){for(var t=new Uint8Array(e),a=!0,s=0;s<c.length;++s)if(c[s]!==t[s]){a=!1;break}if(!a)throw new o("Invalid KTX file.");var u,d;r(e.buffer)?(u=new DataView(e.buffer),d=e.byteOffset):(u=new DataView(e),d=0),d+=12;var m=u.getUint32(d,!0);if(d+=f,m!==l)throw new o("File is the wrong endianness.");var h=u.getUint32(d,!0);d+=f;var p=u.getUint32(d,!0);d+=f;var _=u.getUint32(d,!0);d+=f;var v=u.getUint32(d,!0);d+=f;var g=u.getUint32(d,!0);d+=f;var y=u.getUint32(d,!0);d+=f;var E=u.getUint32(d,!0);d+=f;var T=u.getUint32(d,!0);d+=f;var C=u.getUint32(d,!0);d+=f;var S=u.getUint32(d,!0);d+=f;var A=u.getUint32(d,!0);d+=f;var x=u.getUint32(d,!0);d+=f,d+=x;var w=u.getUint32(d,!0);d+=f;var R;if(R=r(e.buffer)?new Uint8Array(e.buffer,d,w):new Uint8Array(e,d,w),32849===v?v=i.RGB:32856===v&&(v=i.RGBA),!i.validate(v))throw new o("glInternalFormat is not a valid format.");if(i.isCompressedFormat(v)){if(0!==h)throw new o("glType must be zero when the texture is compressed.");if(1!==p)throw new o("The type size for compressed textures must be 1.");if(0!==_)throw new o("glFormat must be zero when the texture is compressed.")}else if(g!==_)throw new o("The base internal format must be the same as the format for uncompressed textures.");if(0!==T)throw new o("3D textures are unsupported.");if(0!==C)throw new o("Texture arrays are unsupported.");if(1!==S)throw new o("Cubemaps are unsupported.");if(A>1){var b=i.isCompressedFormat(v)?i.compressedTextureSizeInBytes(v,y,E):i.textureSizeInBytes(v,y,E);R=new Uint8Array(R.buffer,R.byteOffset,b)}return new n(v,y,E,R)}var c=[171,75,84,88,32,49,49,187,13,10,26,10],l=67305985,f=4;return s}),define("Renderer/CubeMapFace",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/PixelFormat","./PixelDatatype"],function(e,t,n,r,i,a,o){"use strict";function s(e,t,n,r,i,a,o,s,u,c){this._gl=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelFormat=i,this._pixelDatatype=a,this._size=o,this._preMultiplyAlpha=s,this._flipY=u,this._initialized=c}return r(s.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),s.prototype.copyFrom=function(e,r,i){r=t(r,0),i=t(i,0);var o=this._gl,s=this._textureTarget,u=this._targetFace;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture);var c=e.width,l=e.height,f=e.arrayBufferView,d=this._size,m=this._pixelFormat,h=this._pixelDatatype,p=this._preMultiplyAlpha,_=this._flipY,v=!1;if(!this._initialized){if(0===r&&0===i&&c===d&&l===d)n(f)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),_&&(f=a.flipY(f,m,h,d,d)),o.texImage2D(u,0,m,d,d,0,m,h,f)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,_),o.texImage2D(u,0,m,m,h,e)),v=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);var g=a.createTypedArray(m,h,d,d);o.texImage2D(u,0,m,d,d,0,m,h,g)}this._initialized=!0}v||(f?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),_&&(f=a.flipY(f,m,h,c,l)),o.texSubImage2D(u,0,r,i,c,l,m,h,f)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,_),o.texSubImage2D(u,0,r,i,m,h,e))),o.bindTexture(s,null)},s.prototype.copyFromFramebuffer=function(e,n,r,i,a,o){e=t(e,0),n=t(n,0),r=t(r,0),i=t(i,0),a=t(a,this._size),o=t(o,this._size);var s=this._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(this._targetFace,0,e,n,r,i,a,o),s.bindTexture(u,null),this._initialized=!0},s}),define("Renderer/MipmapHint",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===n.DONT_CARE||e===n.FASTEST||e===n.NICEST}};return e(n)}),define("Renderer/TextureMagnificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR}};return e(n)}),define("Renderer/TextureMinificationFilter",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR||e===n.NEAREST_MIPMAP_NEAREST||e===n.LINEAR_MIPMAP_NEAREST||e===n.NEAREST_MIPMAP_LINEAR||e===n.LINEAR_MIPMAP_LINEAR}};return e(n)}),define("Renderer/TextureWrap",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===n.CLAMP_TO_EDGE||e===n.REPEAT||e===n.MIRRORED_REPEAT}};return e(n)}),define("Renderer/Sampler",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,n,r,i,a,o,s){"use strict";function u(e){e=t(e,t.EMPTY_OBJECT);var r=t(e.wrapS,s.CLAMP_TO_EDGE),i=t(e.wrapT,s.CLAMP_TO_EDGE),u=t(e.minificationFilter,o.LINEAR),c=t(e.magnificationFilter,a.LINEAR),l=n(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=r,this._wrapT=i,this._minificationFilter=u,this._magnificationFilter=c,this._maximumAnisotropy=l}return r(u.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),u.equals=function(e,t){return e===t||n(e)&&n(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},u}),define("Renderer/CubeMap",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h){"use strict";function p(e){function r(e,t,n,r){var i=t.arrayBufferView;i?(g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1),r&&(i=s.flipY(i,m,h,l,l)),g.texImage2D(e,0,m,l,l,0,m,h,i)):(g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,r),g.texImage2D(e,0,m,m,h,t))}e=t(e,t.EMPTY_OBJECT);var i,a=e.context,o=e.source;if(n(o)){var u=[o.positiveX,o.negativeX,o.positiveY,o.negativeY,o.positiveZ,o.negativeZ];i=u[0].width,u[0].height}else i=e.width,e.height;var l=i,m=t(e.pixelFormat,s.RGBA),h=t(e.pixelDatatype,f.UNSIGNED_BYTE),p=6*s.textureSizeInBytes(m,h,l,l),_=e.preMultiplyAlpha||m===s.RGB||m===s.LUMINANCE,v=t(e.flipY,!0),g=a._gl,y=g.TEXTURE_CUBE_MAP,E=g.createTexture();g.activeTexture(g.TEXTURE0),g.bindTexture(y,E),n(o)?(r(g.TEXTURE_CUBE_MAP_POSITIVE_X,o.positiveX,_,v),r(g.TEXTURE_CUBE_MAP_NEGATIVE_X,o.negativeX,_,v),r(g.TEXTURE_CUBE_MAP_POSITIVE_Y,o.positiveY,_,v),r(g.TEXTURE_CUBE_MAP_NEGATIVE_Y,o.negativeY,_,v),r(g.TEXTURE_CUBE_MAP_POSITIVE_Z,o.positiveZ,_,v),r(g.TEXTURE_CUBE_MAP_NEGATIVE_Z,o.negativeZ,_,v)):(g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_X,0,m,l,l,0,m,h,null),g.texImage2D(g.TEXTURE_CUBE_MAP_NEGATIVE_X,0,m,l,l,0,m,h,null),g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_Y,0,m,l,l,0,m,h,null),g.texImage2D(g.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,m,l,l,0,m,h,null),g.texImage2D(g.TEXTURE_CUBE_MAP_POSITIVE_Z,0,m,l,l,0,m,h,null),g.texImage2D(g.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,m,l,l,0,m,h,null)),g.bindTexture(y,null),this._gl=g,this._textureFilterAnisotropic=a._textureFilterAnisotropic,this._textureTarget=y,this._texture=E,this._pixelFormat=m,this._pixelDatatype=h,this._size=l,this._hasMipmap=!1,this._sizeInBytes=p,this._preMultiplyAlpha=_,this._flipY=v,this._sampler=void 0;var T=n(o);this._positiveX=new c(g,E,y,g.TEXTURE_CUBE_MAP_POSITIVE_X,m,h,l,_,v,T),this._negativeX=new c(g,E,y,g.TEXTURE_CUBE_MAP_NEGATIVE_X,m,h,l,_,v,T),this._positiveY=new c(g,E,y,g.TEXTURE_CUBE_MAP_POSITIVE_Y,m,h,l,_,v,T),this._negativeY=new c(g,E,y,g.TEXTURE_CUBE_MAP_NEGATIVE_Y,m,h,l,_,v,T),this._positiveZ=new c(g,E,y,g.TEXTURE_CUBE_MAP_POSITIVE_Z,m,h,l,_,v,T),this._negativeZ=new c(g,E,y,g.TEXTURE_CUBE_MAP_NEGATIVE_Z,m,h,l,_,v,T),this.sampler=n(e.sampler)?e.sampler:new d}return r(p.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,i=t===h.NEAREST_MIPMAP_NEAREST||t===h.NEAREST_MIPMAP_LINEAR||t===h.LINEAR_MIPMAP_NEAREST||t===h.LINEAR_MIPMAP_LINEAR;this._pixelDatatype!==f.FLOAT&&this._pixelDatatype!==f.HALF_FLOAT||(t=i?h.NEAREST_MIPMAP_NEAREST:h.NEAREST,r=m.NEAREST);var a=this._gl,o=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(o,this._texture),a.texParameteri(o,a.TEXTURE_MIN_FILTER,t),a.texParameteri(o,a.TEXTURE_MAG_FILTER,r),a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT),n(this._textureFilterAnisotropic)&&a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),p.prototype.generateMipmap=function(e){e=t(e,l.DONT_CARE),this._hasMipmap=!0;var n=this._gl,r=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,e),n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture),n.generateMipmap(r),n.bindTexture(r,null)},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){return this._gl.deleteTexture(this._texture),this._positiveX=i(this._positiveX),this._negativeX=i(this._negativeX),this._positiveY=i(this._positiveY),this._negativeY=i(this._negativeY),this._positiveZ=i(this._positiveZ),
this._negativeZ=i(this._negativeZ),i(this)},p}),define("Renderer/Texture",["../Core/Cartesian2","../Core/Check","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","../Core/WebGLConstants","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_){"use strict";function v(t){t=r(t,r.EMPTY_OBJECT);var a=t.context,o=t.width,s=t.height,u=t.source;i(u)&&(i(o)||(o=r(u.videoWidth,u.width)),i(s)||(s=r(u.videoHeight,u.height)));var f=r(t.pixelFormat,c.RGBA),d=r(t.pixelDatatype,m.UNSIGNED_BYTE),p=f,_=c.isCompressedFormat(p);if(a.webgl2)if(f===c.DEPTH_STENCIL?p=l.DEPTH24_STENCIL8:f===c.DEPTH_COMPONENT&&(d===m.UNSIGNED_SHORT?p=l.DEPTH_COMPONENT16:d===m.UNSIGNED_INT&&(p=l.DEPTH_COMPONENT24)),d===m.FLOAT)switch(f){case c.RGBA:p=l.RGBA32F;break;case c.RGB:p=l.RGB32F;break;case c.RG:p=l.RG32F;break;case c.R:p=l.R32F}else if(d===m.HALF_FLOAT)switch(f){case c.RGBA:p=l.RGBA16F;break;case c.RGB:p=l.RGB16F;break;case c.RG:p=l.RG16F;break;case c.R:p=l.R16F}var v=t.preMultiplyAlpha||f===c.RGB||f===c.LUMINANCE,g=r(t.flipY,!0),y=!0,E=a._gl,T=E.TEXTURE_2D,C=E.createTexture();if(E.activeTexture(E.TEXTURE0),E.bindTexture(T,C),i(u))if(i(u.arrayBufferView)){E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1);var S=u.arrayBufferView;_?E.compressedTexImage2D(T,0,p,o,s,0,S):(g&&(S=c.flipY(S,f,d,o,s)),E.texImage2D(T,0,p,o,s,0,f,d,S))}else i(u.framebuffer)?(E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1),u.framebuffer!==a.defaultFramebuffer&&u.framebuffer._bind(),E.copyTexImage2D(T,0,p,u.xOffset,u.yOffset,o,s,0),u.framebuffer!==a.defaultFramebuffer&&u.framebuffer._unBind()):(E.pixelStorei(E.UNPACK_PREMULTIPLY_ALPHA_WEBGL,v),E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,g),E.texImage2D(T,0,p,f,d,u));else E.texImage2D(T,0,p,o,s,0,f,d,null),y=!1;E.bindTexture(T,null);var A;A=_?c.compressedTextureSizeInBytes(f,o,s):c.textureSizeInBytes(f,d,o,s),this._id=n(),this._context=a,this._textureFilterAnisotropic=a._textureFilterAnisotropic,this._textureTarget=T,this._texture=C,this._pixelFormat=f,this._pixelDatatype=d,this._width=o,this._height=s,this._dimensions=new e(o,s),this._hasMipmap=!1,this._sizeInBytes=A,this._preMultiplyAlpha=v,this._flipY=g,this._initialized=y,this._sampler=void 0,this.sampler=i(t.sampler)?t.sampler:new h}return v.fromFramebuffer=function(e){e=r(e,r.EMPTY_OBJECT);var t=e.context,n=t._gl,a=r(e.pixelFormat,c.RGB),o=r(e.framebufferXOffset,0),s=r(e.framebufferYOffset,0),u=r(e.width,n.drawingBufferWidth),l=r(e.height,n.drawingBufferHeight),f=e.framebuffer;return new v({context:t,width:u,height:l,pixelFormat:a,source:{framebuffer:i(f)?f:t.defaultFramebuffer,xOffset:o,yOffset:s,width:u,height:l}})},a(v.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,n=e.magnificationFilter,r=t===_.NEAREST_MIPMAP_NEAREST||t===_.NEAREST_MIPMAP_LINEAR||t===_.LINEAR_MIPMAP_NEAREST||t===_.LINEAR_MIPMAP_LINEAR;this._pixelDatatype!==m.FLOAT&&this._pixelDatatype!==m.HALF_FLOAT||(t=r?_.NEAREST_MIPMAP_NEAREST:_.NEAREST,n=p.NEAREST);var a=this._context._gl,o=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(o,this._texture),a.texParameteri(o,a.TEXTURE_MIN_FILTER,t),a.texParameteri(o,a.TEXTURE_MAG_FILTER,n),a.texParameteri(o,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(o,a.TEXTURE_WRAP_T,e.wrapT),i(this._textureFilterAnisotropic)&&a.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),v.prototype.copyFrom=function(e,t,n){t=r(t,0),n=r(n,0);var a=this._context._gl,o=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(o,this._texture);var s=e.width,u=e.height,l=e.arrayBufferView,f=this._width,d=this._height,m=this._pixelFormat,h=this._pixelDatatype,p=this._preMultiplyAlpha,_=this._flipY,v=!1;if(!this._initialized){if(0===t&&0===n&&s===f&&u===d)i(l)?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),_&&(l=c.flipY(l,m,h,f,d)),a.texImage2D(o,0,m,f,d,0,m,h,l)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,_),a.texImage2D(o,0,m,m,h,e)),v=!0;else{a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);var g=c.createTypedArray(m,h,f,d);a.texImage2D(o,0,m,f,d,0,m,h,g)}this._initialized=!0}v||(l?(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),_&&(l=c.flipY(l,m,h,s,u)),a.texSubImage2D(o,0,t,n,s,u,m,h,l)):(a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,_),a.texSubImage2D(o,0,t,n,m,h,e))),a.bindTexture(o,null)},v.prototype.copyFromFramebuffer=function(e,t,n,i,a,o){e=r(e,0),t=r(t,0),n=r(n,0),i=r(i,0),a=r(a,this._width),o=r(o,this._height);var s=this._context._gl,u=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture),s.copyTexSubImage2D(u,0,e,t,n,i,a,o),s.bindTexture(u,null),this._initialized=!0},v.prototype.generateMipmap=function(e){e=r(e,d.DONT_CARE),this._hasMipmap=!0;var t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),o(this)},v}),define("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n"}),define("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationContourMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float spacing;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat distanceToContour = mod(materialInput.height, spacing);\n#ifdef GL_OES_standard_derivatives\nfloat dxc = abs(dFdx(materialInput.height));\nfloat dyc = abs(dFdy(materialInput.height));\nfloat dF = max(dxc, dyc) * width;\nmaterial.alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\nmaterial.alpha = (distanceToContour < (czm_resolutionScale * width)) ? 1.0 : 0.0;\n#endif\nmaterial.diffuse = color.rgb;\nreturn material;\n}\n"}),define("Shaders/Materials/ElevationRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\nvec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/GridMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec3 halfColor = color.rgb * 0.5;\nmaterial.diffuse = halfColor;\nmaterial.emission = halfColor;\nmaterial.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nreturn material;\n}\n"}),define("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\n#ifdef GL_OES_standard_derivatives\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\nfloat base = 0.99;\n#endif\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineDashMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\nconst float maskLength = 16.0;\nmat2 rotate(float rad) {\nfloat c = cos(rad);\nfloat s = sin(rad);\nreturn mat2(\nc, s,\n-s, c\n);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\nfloat dashPosition = fract(pos.x / dashLength);\nfloat maskIndex = floor(dashPosition * maskLength);\nfloat maskTest = floor(dashPattern / pow(2.0, maskIndex));\nvec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\nif (fragColor.a < 0.005) {\ndiscard;\n}\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nmaterial.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nmaterial.alpha = clamp(0.0, 1.0, glow) * color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nmaterial.diffuse = color.rgb;\nmaterial.emission = rimColor.rgb * s;\nmaterial.alpha = mix(color.a, rimColor.a, s);\nreturn material;\n}\n"}),define("Shaders/Materials/SlopeRampMaterial",[],function(){"use strict";return"uniform sampler2D image;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 rampColor = texture2D(image, vec2(materialInput.slope, 0.5));\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n"}),define("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),define("Shaders/Materials/Water",[],function(){"use strict";return"uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n"}),define("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadCRN","../Core/loadKTX","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/Resource","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/ElevationContourMaterial","../Shaders/Materials/ElevationRampMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineDashMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/SlopeRampMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A,x,w,R,b,I,O,D,P,M,N,z){"use strict";function F(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,L(e,this),s(this,{type:{value:this.type,writable:!1}}),o(F._uniformList[this.type])||(F._uniformList[this.type]=Object.keys(this._uniforms))}function L(e,n){e=a(e,a.EMPTY_OBJECT),n._strict=a(e.strict,!1),n._count=a(e.count,0),n._template=t(a(e.fabric,a.EMPTY_OBJECT)),n._template.uniforms=t(a(n._template.uniforms,a.EMPTY_OBJECT)),n._template.materials=t(a(n._template.materials,a.EMPTY_OBJECT)),n.type=o(n._template.type)?n._template.type:i(),n.shaderSource="",n.materials={},n.uniforms={},n._uniforms={},n._translucentFunctions=[];var s,u=F._materialCache.getMaterial(n.type);if(o(u)){var c=t(u.fabric,!0);n._template=r(n._template,c,!0),s=u.translucent}V(n),o(u)||F._materialCache.addMaterial(n.type,n),k(n),W(n),j(n);var l=0===n._translucentFunctions.length||void 0;if(s=a(s,l),s=a(e.translucent,s),o(s))if("function"==typeof s){var f=function(){return s(n)};n._translucentFunctions.push(f)}else n._translucentFunctions.push(s)}function B(e,t,n,r){if(o(e))for(var i in e)if(e.hasOwnProperty(i)){var a=-1!==t.indexOf(i);(r&&!a||!r&&a)&&n(i,t)}}function U(e,t){}function G(e,t){}function V(e){var t=e._template,n=t.uniforms,r=t.materials,i=t.components;B(t,J,U,!0),B(i,Q,U,!0);var a=[];for(var o in r)r.hasOwnProperty(o)&&a.push(o);B(n,a,G,!1)}function k(e){var t=e._template.components,n=e._template.source;if(o(n))e.shaderSource+=n+"\n";else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",o(t))for(var r in t)t.hasOwnProperty(r)&&(e.shaderSource+="material."+r+" = "+t[r]+";\n");e.shaderSource+="return material;\n}\n"}}function q(e){var t;return function(n,r){var i=n.uniforms,a=i[e],s=t!==a;t=a;var u,c,l=n._textures[e];if(a instanceof HTMLVideoElement)if(a.readyState>=2){if(s&&o(l)&&(l!==r.defaultTexture&&l.destroy(),l=void 0),!o(l)||l===r.defaultTexture)return l=new g({context:r,source:a}),void(n._textures[e]=l);l.copyFrom(a)}else o(l)||(n._textures[e]=r.defaultTexture);else{if(a instanceof g&&a!==l){n._texturePaths[e]=void 0;var m=n._textures[e];return m!==n._defaultTexture&&m.destroy(),n._textures[e]=a,u=e+"Dimensions",void(i.hasOwnProperty(u)&&(c=i[u],c.x=a._width,c.y=a._height))}if(o(l)||(n._texturePaths[e]=void 0,o(n._defaultTexture)||(n._defaultTexture=r.defaultTexture),l=n._textures[e]=n._defaultTexture,u=e+"Dimensions",i.hasOwnProperty(u)&&(c=i[u],c.x=l._width,c.y=l._height)),a!==F.DefaultImageId){var h=a instanceof _;if(!o(n._texturePaths[e])||h&&a.url!==n._texturePaths[e].url||!h&&a!==n._texturePaths[e]){if("string"==typeof a||h){var p,v=h?a:_.createIfNeeded(a);p=ee.test(a)?d(v):te.test(a)?f(v):v.fetchImage(),z(p,function(t){n._loadedImages.push({id:e,image:t})})}else(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement)&&n._loadedImages.push({id:e,image:a});n._texturePaths[e]=a}}}}}function H(e){return function(t,n){var r=t.uniforms[e];if(r instanceof v){var i=t._textures[e];return i!==t._defaultTexture&&i.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=r)}if(o(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=n.defaultCubeMap),r!==F.DefaultCubeMapId){var a=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(a!==t._texturePaths[e]){var s=[_.createIfNeeded(r.positiveX).fetchImage(),_.createIfNeeded(r.negativeX).fetchImage(),_.createIfNeeded(r.positiveY).fetchImage(),_.createIfNeeded(r.negativeY).fetchImage(),_.createIfNeeded(r.positiveZ).fetchImage(),_.createIfNeeded(r.negativeZ).fetchImage()];z.all(s).then(function(n){t._loadedCubeMaps.push({id:e,images:n})}),t._texturePaths[e]=a}}}}function W(e){var t=e._template.uniforms;for(var n in t)t.hasOwnProperty(n)&&Y(e,n)}function Y(e,t){var n=(e._strict,e._template.uniforms),r=n[t],i=X(r);if("channels"===i)Z(e,t,r,!1);else{if("sampler2D"===i){var a=t+"Dimensions";K(e,a)>0&&(n[a]={type:"ivec3",x:1,y:1},Y(e,a))}if(!new RegExp("uniform\\s+"+i+"\\s+"+t+"\\s*;").test(e.shaderSource)){var o="uniform "+i+" "+t+";";e.shaderSource=o+e.shaderSource}var s=t+"_"+e._count++;if(Z(e,t,s),e.uniforms[t]=r,"sampler2D"===i)e._uniforms[s]=function(){return e._textures[t]},e._updateFunctions.push(q(t));else if("samplerCube"===i)e._uniforms[s]=function(){return e._textures[t]},e._updateFunctions.push(H(t));else if(-1!==i.indexOf("mat")){var u=new $[i];e._uniforms[s]=function(){return $[i].fromColumnMajorArray(e.uniforms[t],u)}}else e._uniforms[s]=function(){return e.uniforms[t]}}}function X(e){var t=e.type;if(!o(t)){var n=typeof e;if("number"===n)t="float";else if("boolean"===n)t="bool";else if("string"===n||e instanceof _||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===F.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===n)if(l(e))4!==e.length&&9!==e.length&&16!==e.length||(t="mat"+Math.sqrt(e.length));else{var r=0;for(var i in e)e.hasOwnProperty(i)&&(r+=1);r>=2&&r<=4?t="vec"+r:6===r&&(t="samplerCube")}}return t}function j(e){var t=e._strict,n=e._template.materials;for(var i in n)if(n.hasOwnProperty(i)){var a=new F({strict:t,fabric:n[i],count:e._count});e._count=a._count,e._uniforms=r(e._uniforms,a._uniforms,!0),e.materials[i]=a,e._translucentFunctions=e._translucentFunctions.concat(a._translucentFunctions);var o="czm_getMaterial_"+e._count++;Z(a,"czm_getMaterial",o),e.shaderSource=a.shaderSource+e.shaderSource;var s=o+"(materialInput)";Z(e,i,s)}}function Z(e,t,n,r){r=a(r,!0);var i=0,o="([\\w"+(r?".":"")+"])?",s=new RegExp(o+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(s,function(e,t,r){return t||r?e:(i+=1,n)}),i}function K(e,t,n){return Z(e,t,t,n)}F._uniformList={},F.fromType=function(e,t){var n=new F({fabric:{type:e}});if(o(t))for(var r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n},F.prototype.isTranslucent=function(){if(o(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;for(var e=!0,t=this._translucentFunctions,n=t.length,r=0;r<n;++r){var i=t[r];if(!(e="function"==typeof i?e&&i():e&&i))break}return e},F.prototype.update=function(e){var t,n,r=this._loadedImages,i=r.length;for(t=0;t<i;++t){var a=r[t];n=a.id;var s,u=a.image;s=new g(o(u.internalFormat)?{context:e,pixelFormat:u.internalFormat,width:u.width,height:u.height,source:{arrayBufferView:u.bufferView}}:{context:e,source:u}),this._textures[n]=s;var c=n+"Dimensions";if(this.uniforms.hasOwnProperty(c)){var l=this.uniforms[c];l.x=s._width,l.y=s._height}}r.length=0;var f=this._loadedCubeMaps;for(i=f.length,t=0;t<i;++t){var d=f[t];n=d.id;var m=d.images,h=new v({context:e,source:{positiveX:m[0],negativeX:m[1],positiveY:m[2],negativeY:m[3],positiveZ:m[4],negativeZ:m[5]}});this._textures[n]=h}f.length=0;var p=this._updateFunctions;for(i=p.length,t=0;t<i;++t)p[t](this,e);var _=this.materials;for(var y in _)_.hasOwnProperty(y)&&_[y].update(e)},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){var e=this._textures;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];n!==this._defaultTexture&&n.destroy()}var r=this.materials;for(var i in r)r.hasOwnProperty(i)&&r[i].destroy();return u(this)};var J=["type","materials","uniforms","components","source"],Q=["diffuse","specular","shininess","normal","emission","alpha"],$={mat2:m,mat3:h,mat4:p},ee=/\.ktx$/i,te=/\.crn$/i;return F._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},F.DefaultImageId="czm_defaultImage",F.DefaultCubeMapId="czm_defaultCubeMap",F.ColorType="Color",F._materialCache.addMaterial(F.ColorType,{fabric:{type:F.ColorType,uniforms:{color:new n(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),F.ImageType="Image",F._materialCache.addMaterial(F.ImageType,{fabric:{type:F.ImageType,uniforms:{image:F.DefaultImageId,repeat:new e(1,1),color:new n(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),F.DiffuseMapType="DiffuseMap",F._materialCache.addMaterial(F.DiffuseMapType,{fabric:{type:F.DiffuseMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),F.AlphaMapType="AlphaMap",F._materialCache.addMaterial(F.AlphaMapType,{fabric:{type:F.AlphaMapType,uniforms:{image:F.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),F.SpecularMapType="SpecularMap",F._materialCache.addMaterial(F.SpecularMapType,{fabric:{type:F.SpecularMapType,uniforms:{image:F.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),F.EmissionMapType="EmissionMap",F._materialCache.addMaterial(F.EmissionMapType,{fabric:{type:F.EmissionMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),F.BumpMapType="BumpMap",F._materialCache.addMaterial(F.BumpMapType,{fabric:{type:F.BumpMapType,uniforms:{image:F.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:y},translucent:!1}),F.NormalMapType="NormalMap",F._materialCache.addMaterial(F.NormalMapType,{fabric:{type:F.NormalMapType,uniforms:{image:F.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:w},translucent:!1}),F.GridType="Grid",F._materialCache.addMaterial(F.GridType,{fabric:{type:F.GridType,uniforms:{color:new n(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:x},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),F.StripeType="Stripe",F._materialCache.addMaterial(F.StripeType,{fabric:{type:F.StripeType,uniforms:{horizontal:!0,evenColor:new n(1,1,1,.5),oddColor:new n(0,0,1,.5),offset:0,repeat:5},source:M},translucent:function(e){
var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),F.CheckerboardType="Checkerboard",F._materialCache.addMaterial(F.CheckerboardType,{fabric:{type:F.CheckerboardType,uniforms:{lightColor:new n(1,1,1,.5),darkColor:new n(0,0,0,.5),repeat:new e(5,5)},source:E},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),F.DotType="Dot",F._materialCache.addMaterial(F.DotType,{fabric:{type:F.DotType,uniforms:{lightColor:new n(1,1,0,.75),darkColor:new n(0,1,1,.75),repeat:new e(5,5)},source:T},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),F.WaterType="Water",F._materialCache.addMaterial(F.WaterType,{fabric:{type:F.WaterType,uniforms:{baseWaterColor:new n(.2,.3,.6,1),blendColor:new n(0,1,.699,1),specularMap:F.DefaultImageId,normalMap:F.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:N},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),F.RimLightingType="RimLighting",F._materialCache.addMaterial(F.RimLightingType,{fabric:{type:F.RimLightingType,uniforms:{color:new n(1,0,0,.7),rimColor:new n(1,1,1,.4),width:.3},source:D},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),F.FadeType="Fade",F._materialCache.addMaterial(F.FadeType,{fabric:{type:F.FadeType,uniforms:{fadeInColor:new n(1,0,0,1),fadeOutColor:new n(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new e(.5,.5)},source:A},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),F.PolylineArrowType="PolylineArrow",F._materialCache.addMaterial(F.PolylineArrowType,{fabric:{type:F.PolylineArrowType,uniforms:{color:new n(1,1,1,1)},source:R},translucent:!0}),F.PolylineDashType="PolylineDash",F._materialCache.addMaterial(F.PolylineDashType,{fabric:{type:F.PolylineDashType,uniforms:{color:new n(1,0,1,1),gapColor:new n(0,0,0,0),dashLength:16,dashPattern:255},source:b},translucent:!0}),F.PolylineGlowType="PolylineGlow",F._materialCache.addMaterial(F.PolylineGlowType,{fabric:{type:F.PolylineGlowType,uniforms:{color:new n(0,.5,1,1),glowPower:.25},source:I},translucent:!0}),F.PolylineOutlineType="PolylineOutline",F._materialCache.addMaterial(F.PolylineOutlineType,{fabric:{type:F.PolylineOutlineType,uniforms:{color:new n(1,1,1,1),outlineColor:new n(1,0,0,1),outlineWidth:1},source:O},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),F.ElevationContourType="ElevationContour",F._materialCache.addMaterial(F.ElevationContourType,{fabric:{type:F.ElevationContourType,uniforms:{spacing:100,color:new n(1,0,0,1),width:1},source:C},translucent:!1}),F.ElevationRampType="ElevationRamp",F._materialCache.addMaterial(F.ElevationRampType,{fabric:{type:F.ElevationRampType,uniforms:{image:F.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:S},translucent:!1}),F.SlopeRampMaterialType="SlopeRamp",F._materialCache.addMaterial(F.SlopeRampMaterialType,{fabric:{type:F.SlopeRampMaterialType,uniforms:{image:F.DefaultImageId},source:P},translucent:!1}),F}),define("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.translucent,!0),i=c.VERTEX_FORMAT;this.material=t(n.material)?n.material:u.fromType(u.ColorType),this.translucent=r,this._vertexShaderSource=e(n.vertexShaderSource,l),this._fragmentShaderSource=e(n.fragmentShaderSource,f),this._renderState=s.getDefaultRenderState(r,!1,n.renderState),this._closed=!1,this._vertexFormat=i}var l=a+"\n"+i,f=o;return n(c.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),c.VERTEX_FORMAT=r.POSITION_AND_ST,c.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,c.prototype.isTranslucent=s.prototype.isTranslucent,c.prototype.getRenderState=s.prototype.getRenderState,c}),define("Core/GeometryAttributes",["./defaultValue"],function(e){"use strict";function t(t){t=e(t,e.EMPTY_OBJECT),this.position=t.position,this.normal=t.normal,this.st=t.st,this.bitangent=t.bitangent,this.tangent=t.tangent,this.color=t.color}return t}),define("Core/subdivideArray",["./defined","./DeveloperError"],function(e,t){"use strict";function n(e,t){for(var n=[],r=e.length,i=0;i<r;){var a=Math.ceil((r-i)/t--);n.push(e.slice(i,i+a)),i+=a}return n}return n}),define("Renderer/BufferUsage",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";var n={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===n.STREAM_DRAW||e===n.STATIC_DRAW||e===n.DYNAMIC_DRAW}};return e(n)}),define("Core/IndexDatatype",["./defined","./DeveloperError","./freezeObject","./Math","./WebGLConstants"],function(e,t,n,r,i){"use strict";var a={UNSIGNED_BYTE:i.UNSIGNED_BYTE,UNSIGNED_SHORT:i.UNSIGNED_SHORT,UNSIGNED_INT:i.UNSIGNED_INT};return a.getSizeInBytes=function(e){switch(e){case a.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case a.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case a.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}},a.validate=function(t){return e(t)&&(t===a.UNSIGNED_BYTE||t===a.UNSIGNED_SHORT||t===a.UNSIGNED_INT)},a.createTypedArray=function(e,t){return e>=r.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},a.createTypedArrayFromArrayBuffer=function(e,t,n,i){return e>=r.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,i):new Uint16Array(t,n,i)},n(a)}),define("Renderer/Buffer",["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","../Core/WebGLConstants","./BufferUsage"],function(e,t,n,r,i,a,o,s,u){"use strict";function c(e){e=t(e,t.EMPTY_OBJECT);var r=e.context._gl,i=e.bufferTarget,a=e.typedArray,o=e.sizeInBytes,s=e.usage,u=n(a);u&&(o=a.byteLength);var c=r.createBuffer();r.bindBuffer(i,c),r.bufferData(i,u?a:o,s),r.bindBuffer(i,null),this._gl=r,this._webgl2=e.context._webgl2,this._bufferTarget=i,this._sizeInBytes=o,this._usage=s,this._buffer=c,this.vertexArrayDestroyable=!0}return c.createVertexBuffer=function(e){return new c({context:e.context,bufferTarget:s.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},c.createIndexBuffer=function(e){var t=e.context,n=e.indexDatatype,i=o.getSizeInBytes(n),a=new c({context:t,bufferTarget:s.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),u=a.sizeInBytes/i;return r(a,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return i}},numberOfIndices:{get:function(){return u}}}),a},r(c.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),c.prototype._getBuffer=function(){return this._buffer},c.prototype.copyFromArrayView=function(e,n){n=t(n,0);var r=this._gl,i=this._bufferTarget;r.bindBuffer(i,this._buffer),r.bufferSubData(i,n,e),r.bindBuffer(i,null)},c.prototype.copyFromBuffer=function(e,t,n,r){var i=s.COPY_READ_BUFFER,a=s.COPY_WRITE_BUFFER,o=this._gl;o.bindBuffer(a,this._buffer),o.bindBuffer(i,e._buffer),o.copyBufferSubData(i,a,t,n,r),o.bindBuffer(a,null),o.bindBuffer(i,null)},c.prototype.getBufferData=function(e,n,r,i){n=t(n,0),r=t(r,0);var a=this._gl,o=s.COPY_READ_BUFFER;a.bindBuffer(o,this._buffer),a.getBufferSubData(o,n,e,r,i),a.bindBuffer(o,null)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),i(this)},c}),define("Renderer/VertexArray",["../Core/Check","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m){"use strict";function h(e,i,a,o){var s=r(i.vertexBuffer),u=r(i.value),c=i.value?i.value.length:i.componentsPerAttribute,l={index:n(i.index,a),enabled:n(i.enabled,!0),vertexBuffer:i.vertexBuffer,value:u?i.value.slice(0):void 0,componentsPerAttribute:c,componentDatatype:n(i.componentDatatype,t.FLOAT),normalize:n(i.normalize,!1),offsetInBytes:n(i.offsetInBytes,0),strideInBytes:n(i.strideInBytes,0),instanceDivisor:n(i.instanceDivisor,0)};if(s)l.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(o.glVertexAttribDivisor(t,this.instanceDivisor),o._vertexAttribDivisors[t]=this.instanceDivisor,o._previousDrawInstanced=!0)},l.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&o.glVertexAttribDivisor(a,0)};else{switch(l.componentsPerAttribute){case 1:l.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:l.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:l.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:l.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}l.disableVertexAttribArray=function(e){}}e.push(l)}function p(e,t,n){for(var i=0;i<t.length;++i){var a=t[i];a.enabled&&a.vertexAttrib(e)}r(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function _(e){e=n(e,n.EMPTY_OBJECT);var i,a=e.context,o=a._gl,s=e.attributes,u=e.indexBuffer,c=[],l=1,f=!1,d=!1,m=s.length;for(i=0;i<m;++i)h(c,s[i],i,a);for(m=c.length,i=0;i<m;++i){var _=c[i];if(r(_.vertexBuffer)&&0===_.instanceDivisor){var v=_.strideInBytes||_.componentsPerAttribute*t.getSizeInBytes(_.componentDatatype);l=_.vertexBuffer.sizeInBytes/v;break}}for(i=0;i<m;++i)c[i].instanceDivisor>0&&(f=!0),r(c[i].value)&&(d=!0);var g;a.vertexArrayObject&&(g=a.glCreateVertexArray(),a.glBindVertexArray(g),p(o,c,u),a.glBindVertexArray(null)),this._numberOfVertices=l,this._hasInstancedAttributes=f,this._hasConstantAttributes=d,this._context=a,this._gl=o,this._vao=g,this._attributes=c,this._indexBuffer=u}function v(e){return e.values.length/e.componentsPerAttribute}function g(e){return t.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function y(e){var n,i,a,o=[];for(i in e)e.hasOwnProperty(i)&&r(e[i])&&r(e[i].values)&&(o.push(i),e[i].componentDatatype===t.DOUBLE&&(e[i].componentDatatype=t.FLOAT,e[i].values=t.createTypedArray(t.FLOAT,e[i].values)));var s,u=o.length;if(u>0)for(s=v(e[o[0]]),n=1;n<u;++n){var c=v(e[o[n]]);if(c!==s)throw new l("Each attribute list must have the same number of vertices.  Attribute "+o[n]+" has a different number of vertices ("+c.toString()+") than attribute "+o[0]+" ("+s.toString()+").")}o.sort(function(n,r){return t.getSizeInBytes(e[r].componentDatatype)-t.getSizeInBytes(e[n].componentDatatype)});var f=0,d={};for(n=0;n<u;++n)i=o[n],a=e[i],d[i]=f,f+=g(a);if(f>0){var m=t.getSizeInBytes(e[o[0]].componentDatatype),h=f%m;0!==h&&(f+=m-h);var p=s*f,_=new ArrayBuffer(p),y={};for(n=0;n<u;++n){i=o[n];var E=t.getSizeInBytes(e[i].componentDatatype);y[i]={pointer:t.createTypedArray(e[i].componentDatatype,_),index:d[i]/E,strideInComponentType:f/E}}for(n=0;n<s;++n)for(var T=0;T<u;++T){i=o[T],a=e[i];for(var C=a.values,S=y[i],A=S.pointer,x=a.componentsPerAttribute,w=0;w<x;++w)A[S.index+w]=C[n*x+w];S.index+=S.strideInComponentType}return{buffer:_,offsetsInBytes:d,vertexSizeInBytes:f}}}function E(e){var t=e._context,n=e._hasInstancedAttributes;if(n||t._previousDrawInstanced){t._previousDrawInstanced=n;var r,i=t._vertexAttribDivisors,a=e._attributes,o=m.maximumVertexAttributes;if(n){var s=a.length;for(r=0;r<s;++r){var u=a[r];if(u.enabled){var c=u.instanceDivisor,l=u.index;c!==i[l]&&(t.glVertexAttribDivisor(l,c),i[l]=c)}}}else for(r=0;r<o;++r)i[r]>0&&(t.glVertexAttribDivisor(r,0),i[r]=0)}}function T(e,t){for(var n=e._attributes,i=n.length,a=0;a<i;++a){var o=n[a];o.enabled&&r(o.value)&&o.vertexAttrib(t)}}return _.fromGeometry=function(e){e=n(e,n.EMPTY_OBJECT);var i,a,o,l=e.context,m=n(e.geometry,n.EMPTY_OBJECT),h=n(e.bufferUsage,d.DYNAMIC_DRAW),p=n(e.attributeLocations,n.EMPTY_OBJECT),v=n(e.interleave,!1),g=e.vertexArrayAttributes,E=r(g)?g:[],T=m.attributes;if(v){var C=y(T);if(r(C)){o=f.createVertexBuffer({context:l,typedArray:C.buffer,usage:h});var S=C.offsetsInBytes,A=C.vertexSizeInBytes;for(i in T)T.hasOwnProperty(i)&&r(T[i])&&(a=T[i],r(a.values)?E.push({index:p[i],vertexBuffer:o,componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,offsetInBytes:S[i],strideInBytes:A}):E.push({index:p[i],value:a.value,componentDatatype:a.componentDatatype,normalize:a.normalize}))}}else for(i in T)if(T.hasOwnProperty(i)&&r(T[i])){a=T[i];var x=a.componentDatatype;x===t.DOUBLE&&(x=t.FLOAT),o=void 0,r(a.values)&&(o=f.createVertexBuffer({context:l,typedArray:t.createTypedArray(x,a.values),usage:h})),E.push({index:p[i],vertexBuffer:o,value:a.value,componentDatatype:x,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize})}var w,R=m.indices;return r(R)&&(w=s.computeNumberOfVertices(m)>=c.SIXTY_FOUR_KILOBYTES&&l.elementIndexUint?f.createIndexBuffer({context:l,typedArray:new Uint32Array(R),usage:h,indexDatatype:u.UNSIGNED_INT}):f.createIndexBuffer({context:l,typedArray:new Uint16Array(R),usage:h,indexDatatype:u.UNSIGNED_SHORT})),new _({context:l,attributes:E,indexBuffer:w})},i(_.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),_.prototype.getAttribute=function(e){return this._attributes[e]},_.prototype._bind=function(){r(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&E(this),this._hasConstantAttributes&&T(this,this._gl)):p(this._gl,this._attributes,this._indexBuffer)},_.prototype._unBind=function(){if(r(this._vao))this._context.glBindVertexArray(null);else{for(var e=this._attributes,t=this._gl,n=0;n<e.length;++n){var i=e[n];i.enabled&&i.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){for(var e=this._attributes,t=0;t<e.length;++t){var n=e[t].vertexBuffer;r(n)&&!n.isDestroyed()&&n.vertexArrayDestroyable&&n.destroy()}var i=this._indexBuffer;return r(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy(),r(this._vao)&&this._context.glDeleteVertexArray(this._vao),a(this)},_}),define("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Math","../Core/PixelFormat","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v){"use strict";function g(t,r,i){if(this._attributes=r,this._numberOfInstances=i,0!==r.length){var a=y(r),o=t.floatingPointTexture,s=a===m.FLOAT&&!o,u=T(r,s),c=C(u,r,s),l=Math.floor(d.maximumTextureSize/c),f=Math.min(i,l),h=c*f,p=Math.ceil(i/f),_=1/h,v=.5*_,g=1/p,E=.5*g;this._textureDimensions=new e(h,p),this._textureStep=new n(_,v,g,E),this._pixelDatatype=s?m.UNSIGNED_BYTE:a,this._packFloats=s,this._offsets=u,this._stride=c,this._texture=void 0;var S=4*h*p;this._batchValues=a!==m.FLOAT||s?new Uint8Array(S):new Float32Array(S),this._batchValuesDirty=!1}}function y(e){for(var t=!1,n=e.length,r=0;r<n;++r)if(e[r].componentDatatype!==i.UNSIGNED_BYTE){t=!0;break}return t?m.FLOAT:m.UNSIGNED_BYTE}function E(r,i){var a=r[i].componentsPerAttribute;return 2===a?e:3===a?t:4===a?n:Number}function T(e,t){for(var n=new Array(e.length),r=0,a=e.length,o=0;o<a;++o){var s=e[o],u=s.componentDatatype;n[o]=r,u!==i.UNSIGNED_BYTE&&t?r+=4:++r}return n}function C(e,t,n){var r=e.length,a=e[r-1];return t[r-1].componentDatatype!==i.UNSIGNED_BYTE&&n?a+4:a+1}function S(e,t,r){var i=n.unpack(e,t,D),a=n.unpackFloat(i);i=n.unpack(e,t+4,D);var o=n.unpackFloat(i);i=n.unpack(e,t+8,D);var s=n.unpackFloat(i);i=n.unpack(e,t+12,D);var u=n.unpackFloat(i);return n.fromElements(a,o,s,u,r)}function A(e,t,r){var i=n.packFloat(e.x,D);n.pack(i,t,r),i=n.packFloat(e.y,i),n.pack(i,t,r+4),i=n.packFloat(e.z,i),n.pack(i,t,r+8),i=n.packFloat(e.w,i),n.pack(i,t,r+12)}function x(e,t){var n=e._textureDimensions;e._texture=new p({context:t,pixelFormat:f.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:new h({minificationFilter:v.NEAREST,magnificationFilter:_.NEAREST}),flipY:!1})}function w(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}function R(e){var t=e._stride;return 1===e._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+t+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+t+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n"}function b(e){return 1===e?"float":"vec"+e}function I(e){return 1===e?".x":2===e?".xy":3===e?".xyz":""}function O(e,t){var n=e._attributes,r=n[t],a=r.componentsPerAttribute,o=r.functionName,s=b(a),u=I(a),c=e._offsets[t],l=s+" "+o+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+c+"); \n";return e._packFloats&&r.componentDatatype!==m.UNSIGNED_BYTE?l+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":l+="    vec4 textureValue = texture2D(batchTexture, st); \n",l+="    "+s+" value = textureValue"+u+"; \n",e._pixelDatatype!==m.UNSIGNED_BYTE||r.componentDatatype!==i.UNSIGNED_BYTE||r.normalize?e._pixelDatatype===m.FLOAT&&r.componentDatatype===i.UNSIGNED_BYTE&&r.normalize&&(l+="value /= 255.0; \n"):l+="value *= 255.0; \n",l+="    return value; \n} \n"}o(g.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var D=new n;if(c.supportsTypedArrays()){var P=new n;g.prototype.getBatchedAttribute=function(e,t,r){var i,o=this._attributes,s=this._offsets[t],u=this._stride,c=4*u*e+4*s;i=this._packFloats&&o[t].componentDatatype!==m.UNSIGNED_BYTE?S(this._batchValues,c,P):n.unpack(this._batchValues,c,P);var l=E(o,t);return a(l.fromCartesian4)?l.fromCartesian4(i,r):a(l.clone)?l.clone(i,r):i.x};var M=[void 0,void 0,new e,new t,new n],N=new n;return g.prototype.setBatchedAttribute=function(e,t,r){var i=this._attributes,o=M[i[t].componentsPerAttribute],s=this.getBatchedAttribute(e,t,o),u=E(this._attributes,t);if(!(a(u.equals)?u.equals(s,r):s===r)){var c=N;c.x=a(r.x)?r.x:r,c.y=a(r.y)?r.y:0,c.z=a(r.z)?r.z:0,c.w=a(r.w)?r.w:0;var l=this._offsets[t],f=this._stride,d=4*f*e+4*l;this._packFloats&&i[t].componentDatatype!==m.UNSIGNED_BYTE?A(c,this._batchValues,d):n.pack(c,this._batchValues,d),this._batchValuesDirty=!0}},g.prototype.update=function(e){a(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,a(this._texture)||x(this,e.context),w(this))},g.prototype.getUniformMapCallback=function(){var e=this;return function(t){return 0===e._attributes.length?t:r(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}},g.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(0===e.length)return function(e){return e};var t="uniform sampler2D batchTexture; \n";t+=R(this)+"\n";for(var n=e.length,r=0;r<n;++r)t+=O(this,r);return function(e){var n=e.indexOf("void main"),r=e.substring(0,n),i=e.substring(n);return r+"\n"+t+"\n"+i}},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),s(this)},g}}),define("Scene/DepthFunction",["../Core/freezeObject","../Core/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),define("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./Check","./defined","./DeveloperError","./Math"],function(e,t,n,r,i,a){"use strict";function o(e){return l[0]=e,l[0]}function s(e){return e>>1^-(1&e)}var u={};u.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){var r=n.x,i=n.y;n.x=(1-Math.abs(i))*a.signNotZero(r),n.y=(1-Math.abs(r))*a.signNotZero(i)}return n.x=a.toSNorm(n.x,t),n.y=a.toSNorm(n.y,t),n},u.octEncode=function(e,t){return u.octEncodeInRange(e,255,t)};var c=new e,l=new Uint8Array(1);u.octEncodeToCartesian4=function(e,t){return u.octEncodeInRange(e,65535,c),t.x=o(c.x*(1/256)),t.y=o(c.x),t.z=o(c.y*(1/256)),t.w=o(c.y),t},u.octDecodeInRange=function(e,n,r,i){if(i.x=a.fromSNorm(e,r),i.y=a.fromSNorm(n,r),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){var o=i.x;i.x=(1-Math.abs(i.y))*a.signNotZero(o),i.y=(1-Math.abs(o))*a.signNotZero(i.y)}return t.normalize(i,i)},u.octDecode=function(e,t,n){return u.octDecodeInRange(e,t,255,n)},u.octDecodeFromCartesian4=function(e,t){var n=e.x,r=e.y,i=e.z,a=e.w,o=256*n+r,s=256*i+a;return u.octDecodeInRange(o,s,65535,t)},u.octPackFloat=function(e){return 256*e.x+e.y};var f=new e;return u.octEncodeFloat=function(e){return u.octEncode(e,f),u.octPackFloat(f)},u.octDecodeFloat=function(e,t){var n=e/256,r=Math.floor(n),i=256*(n-r);return u.octDecode(r,i,t)},u.octPack=function(e,t,n,r){var i=u.octEncodeFloat(e),a=u.octEncodeFloat(t),o=u.octEncode(n,f);return r.x=65536*o.x+i,r.y=65536*o.y+a,r},u.octUnpack=function(e,t,n,r){var i=e.x/65536,a=Math.floor(i),o=65536*(i-a);i=e.y/65536;var s=Math.floor(i),c=65536*(i-s);u.octDecodeFloat(o,t),u.octDecodeFloat(c,n),u.octDecode(a,s,r)},u.compressTextureCoordinates=function(e){return 4096*(4095*e.x|0)+(4095*e.y|0)},u.decompressTextureCoordinates=function(e,t){var n=e/4096,r=Math.floor(n);return t.x=r/4095,t.y=(e-4096*r)/4095,t},u.zigZagDeltaDecode=function(e,t,n){for(var i=e.length,a=0,o=0,u=0,c=0;c<i;++c)a+=s(e[c]),o+=s(t[c]),e[c]=a,t[c]=o,r(n)&&(u+=s(n[c]),n[c]=u)},u}),define("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./Check","./defined","./Math"],function(e,t,n,r,i){"use strict";function a(n,a,c,l,f){r(f)||(f=new t);var d,m,h,p,_,v,g,y;if(r(a.z)){if(t.equalsEpsilon(n,a,i.EPSILON14))return t.clone(t.UNIT_X,f);if(t.equalsEpsilon(n,c,i.EPSILON14))return t.clone(t.UNIT_Y,f);if(t.equalsEpsilon(n,l,i.EPSILON14))return t.clone(t.UNIT_Z,f);d=t.subtract(c,a,o),m=t.subtract(l,a,s),h=t.subtract(n,a,u),p=t.dot(d,d),_=t.dot(d,m),v=t.dot(d,h),g=t.dot(m,m),y=t.dot(m,h)}else{if(e.equalsEpsilon(n,a,i.EPSILON14))return t.clone(t.UNIT_X,f);if(e.equalsEpsilon(n,c,i.EPSILON14))return t.clone(t.UNIT_Y,f);if(e.equalsEpsilon(n,l,i.EPSILON14))return t.clone(t.UNIT_Z,f);d=e.subtract(c,a,o),m=e.subtract(l,a,s),h=e.subtract(n,a,u),p=e.dot(d,d),_=e.dot(d,m),v=e.dot(d,h),g=e.dot(m,m),y=e.dot(m,h)}var E=p*g-_*_,T=1/E;return f.y=(g*v-_*y)*T,f.z=(p*y-_*v)*T,f.x=1-f.y-f.z,f}var o=new t,s=new t,u=new t;return a}),define("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";var r={};return r.calculateACMR=function(n){n=e(n,e.EMPTY_OBJECT);var r=n.indices,i=n.maximumIndex,a=e(n.cacheSize,24),o=r.length;if(!t(i)){i=0;for(var s=0,u=r[s];s<o;)u>i&&(i=u),++s,u=r[s]}for(var c=[],l=0;l<i+1;l++)c[l]=0;for(var f=a+1,d=0;d<o;++d)f-c[r[d]]>a&&(c[r[d]]=f,++f);return(f-a+1)/(o/3)},r.tipsify=function(n){function r(e,t,n,r){for(;t.length>=1;){var a=t[t.length-1];if(t.splice(t.length-1,1),e[a].numLiveTriangles>0)return a}for(;i<r;){if(e[i].numLiveTriangles>0)return++i-1;++i}return-1}n=e(n,e.EMPTY_OBJECT);var i,a=n.indices,o=n.maximumIndex,s=e(n.cacheSize,24),u=a.length,c=0,l=0,f=a[l],d=u;if(t(o))c=o+1;else{for(;l<d;)f>c&&(c=f),++l,f=a[l];if(-1===c)return 0;++c}var m,h=[];for(m=0;m<c;m++)h[m]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};l=0;for(var p=0;l<d;)h[a[l]].vertexTriangles.push(p),++h[a[l]].numLiveTriangles,h[a[l+1]].vertexTriangles.push(p),++h[a[l+1]].numLiveTriangles,h[a[l+2]].vertexTriangles.push(p),++h[a[l+2]].numLiveTriangles,++p,l+=3;var _=0,v=s+1;i=1;var g,y,E=[],T=[],C=0,S=[],A=u/3,x=[];for(m=0;m<A;m++)x[m]=!1;for(var w,R;-1!==_;){E=[],y=h[_],R=y.vertexTriangles.length;for(var b=0;b<R;++b)if(p=y.vertexTriangles[b],!x[p]){x[p]=!0,l=p+p+p;for(var I=0;I<3;++I)w=a[l],E.push(w),T.push(w),S[C]=w,++C,g=h[w],--g.numLiveTriangles,v-g.timeStamp>s&&(g.timeStamp=v,++v),++l}_=function(e,t,n,i,a,o,s){for(var u,c=-1,l=-1,f=0;f<n.length;){var d=n[f];i[d].numLiveTriangles&&(u=0,a-i[d].timeStamp+2*i[d].numLiveTriangles<=t&&(u=a-i[d].timeStamp),(u>l||-1===l)&&(l=u,c=d)),++f}return-1===c?r(i,o,e,s):c}(a,s,E,h,v,T,c)}return S},r}),define("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A){"use strict";function x(e,t,n,r,i){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=i,e[t++]=i,e[t]=n}function w(e){for(var t=e.length,n=t/3*6,r=_.createTypedArray(t,n),i=0,a=0;a<t;a+=3,i+=6)x(r,i,e[a],e[a+1],e[a+2]);return r}function R(e){var t=e.length;if(t>=3){var n=6*(t-2),r=_.createTypedArray(t,n);x(r,0,e[0],e[1],e[2]);for(var i=6,a=3;a<t;++a,i+=6)x(r,i,e[a-1],e[a],e[a-2]);return r}return new Uint16Array}function b(e){if(e.length>0){for(var t=e.length-1,n=6*(t-1),r=_.createTypedArray(t,n),i=e[0],a=0,o=1;o<t;++o,a+=6)x(r,a,i,e[o],e[o+1]);return r}return new Uint16Array}function I(e){var t={};for(var n in e)if(e.hasOwnProperty(n)&&c(e[n])&&c(e[n].values)){var r=e[n];t[n]=new h({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function O(e,t,n){for(var r in t)if(t.hasOwnProperty(r)&&c(t[r])&&c(t[r].values))for(var i=t[r],a=0;a<i.componentsPerAttribute;++a)e[r].values.push(i.values[n*i.componentsPerAttribute+a])}function D(e,t){if(c(t))for(var n=t.values,r=n.length,a=0;a<r;a+=3)i.unpack(n,a,ue),T.multiplyByPoint(e,ue,ue),i.pack(ue,n,a)}function P(e,t){if(c(t))for(var n=t.values,r=n.length,a=0;a<r;a+=3)i.unpack(n,a,ue),E.multiplyByVector(e,ue,ue),ue=i.normalize(ue,ue),i.pack(ue,n,a)}function M(e,t){var n,r=e.length,i={},a=e[0][t].attributes;for(n in a)if(a.hasOwnProperty(n)&&c(a[n])&&c(a[n].values)){for(var o=a[n],u=o.values.length,l=!0,f=1;f<r;++f){var d=e[f][t].attributes[n];if(!c(d)||o.componentDatatype!==d.componentDatatype||o.componentsPerAttribute!==d.componentsPerAttribute||o.normalize!==d.normalize){l=!1;break}u+=d.values.length}l&&(i[n]=new h({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:s.createTypedArray(o.componentDatatype,u)}))}return i}function N(e,t){var r,a,o,s,u,l,f,d=e.length,h=(e[0].modelMatrix,c(e[0][t].indices)),p=e[0][t].primitiveType,v=M(e,t);for(r in v)if(v.hasOwnProperty(r))for(u=v[r].values,s=0,a=0;a<d;++a)for(l=e[a][t].attributes[r].values,f=l.length,o=0;o<f;++o)u[s++]=l[o];var g;if(h){var y=0;for(a=0;a<d;++a)y+=e[a][t].indices.length;var E=m.computeNumberOfVertices(new m({attributes:v,primitiveType:S.POINTS})),T=_.createTypedArray(E,y),C=0,A=0;for(a=0;a<d;++a){var x=e[a][t].indices,w=x.length;for(s=0;s<w;++s)T[C++]=A+x[s];A+=m.computeNumberOfVertices(e[a][t])}g=T}var R,b=new i,I=0;for(a=0;a<d;++a){if(R=e[a][t].boundingSphere,!c(R)){b=void 0;break}i.add(R.center,b,b)}if(c(b))for(i.divideByScalar(b,d,b),a=0;a<d;++a){R=e[a][t].boundingSphere;var O=i.magnitude(i.subtract(R.center,b,fe))+R.radius;O>I&&(I=O)}return new m({attributes:v,indices:g,primitiveType:p,boundingSphere:c(b)?new n(b,I):void 0})}function z(e){if(c(e.indices))return e;for(var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;return e.indices=n,e}function F(e){var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,3*(t-2));n[0]=1,n[1]=0,n[2]=2;for(var r=3,i=3;i<t;++i)n[r++]=i-1,n[r++]=0,n[r++]=i;return e.indices=n,e.primitiveType=S.TRIANGLES,e}function L(e){var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,3*(t-2));n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);for(var r=6,i=3;i<t-1;i+=2)n[r++]=i,n[r++]=i-1,n[r++]=i+1,i+2<t&&(n[r++]=i,n[r++]=i+1,n[r++]=i+2);return e.indices=n,e.primitiveType=S.TRIANGLES,e}function B(e){if(c(e.indices))return e;for(var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;return e.indices=n,e}function U(e){var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,2*(t-1));n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return e.indices=n,e.primitiveType=S.LINES,e}function G(e){var t=m.computeNumberOfVertices(e),n=_.createTypedArray(t,2*t);n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=S.LINES,e}function V(e){switch(e.primitiveType){case S.TRIANGLE_FAN:return F(e);case S.TRIANGLE_STRIP:return L(e);case S.TRIANGLES:return z(e);case S.LINE_STRIP:return U(e);case S.LINE_LOOP:return G(e);case S.LINES:return B(e)}return e}function k(e,t){Math.abs(e.y)<y.EPSILON6&&(e.y=t?-y.EPSILON6:y.EPSILON6)}function q(e,t,n){if(0!==e.y&&0!==t.y&&0!==n.y)return k(e,e.y<0),k(t,t.y<0),void k(n,n.y<0);var r,i=Math.abs(e.y),a=Math.abs(t.y),o=Math.abs(n.y);r=i>a?i>o?y.sign(e.y):y.sign(n.y):a>o?y.sign(t.y):y.sign(n.y);var s=r<0;k(e,s),k(t,s),k(n,s)}function H(e,t,n,r){i.add(e,i.multiplyByScalar(i.subtract(t,e,Ae),e.y/(e.y-t.y),Ae),n),i.clone(n,r),k(n,!0),k(r,!1)}function W(e,t,n){if(!(e.x>=0||t.x>=0||n.x>=0)){q(e,t,n);var r=e.y<0,i=t.y<0,a=n.y<0,o=0;o+=r?1:0,o+=i?1:0,o+=a?1:0;var s=Ie.indices;1===o?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,r?(H(e,t,xe,Re),H(e,n,we,be),s[0]=0,s[3]=1,s[4]=2,s[6]=1):i?(H(t,n,xe,Re),H(t,e,we,be),s[0]=1,s[3]=2,s[4]=0,s[6]=2):a&&(H(n,e,xe,Re),H(n,t,we,be),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===o&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,r?i?a||(H(n,e,xe,Re),H(n,t,we,be),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(H(t,n,xe,Re),H(t,e,we,be),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(H(e,t,xe,Re),
H(e,n,we,be),s[0]=1,s[1]=2,s[3]=1,s[6]=0));var u=Ie.positions;return u[0]=e,u[1]=t,u[2]=n,u.length=3,1!==o&&2!==o||(u[3]=xe,u[4]=we,u[5]=Re,u[6]=be,u.length=7),Ie}}function Y(e,t){var r=e.attributes;if(0!==r.position.values.length){for(var i in r)if(r.hasOwnProperty(i)&&c(r[i])&&c(r[i].values)){var a=r[i];a.values=s.createTypedArray(a.componentDatatype,a.values)}var o=m.computeNumberOfVertices(e);return e.indices=_.createTypedArray(o,e.indices),t&&(e.boundingSphere=n.fromVertices(r.position.values)),e}}function X(e){var t=e.attributes,n={};for(var r in t)if(t.hasOwnProperty(r)&&c(t[r])&&c(t[r].values)){var i=t[r];n[r]=new h({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return new m({attributes:n,indices:[],primitiveType:e.primitiveType})}function j(e,t,n){var r=c(e.geometry.boundingSphere);t=Y(t,r),n=Y(n,r),c(n)&&!c(t)?e.geometry=n:!c(n)&&c(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function Z(e,t){var n=new e,r=new e,i=new e;return function(a,o,s,u,c,l,f,d){var m=e.fromArray(c,a*t,n),h=e.fromArray(c,o*t,r),p=e.fromArray(c,s*t,i);e.multiplyByScalar(m,u.x,m),e.multiplyByScalar(h,u.y,h),e.multiplyByScalar(p,u.z,p);var _=e.add(m,h,m);e.add(_,p,_),d&&e.normalize(_,_),e.pack(_,l,f*t)}}function K(e,n,r,a,o,s,u,l,f,d,m,h,p,_,v,g){if(c(s)||c(u)||c(l)||c(f)||c(d)||0!==_){var y=i.fromArray(o,3*e,Ne),E=i.fromArray(o,3*n,ze),T=i.fromArray(o,3*r,Fe),C=t(a,y,E,T,Le);if(c(s)&&De(e,n,r,C,s,h.normal.values,g,!0),c(d)){var S=i.fromArray(d,3*e,Ne),A=i.fromArray(d,3*n,ze),x=i.fromArray(d,3*r,Fe);i.multiplyByScalar(S,C.x,S),i.multiplyByScalar(A,C.y,A),i.multiplyByScalar(x,C.z,x);var w;i.equals(S,i.ZERO)&&i.equals(A,i.ZERO)&&i.equals(x,i.ZERO)?(w=Ne,w.x=0,w.y=0,w.z=0):(w=i.add(S,A,S),i.add(w,x,w),i.normalize(w,w)),i.pack(w,h.extrudeDirection.values,3*g)}if(c(m)&&Me(e,n,r,C,m,h.applyOffset.values,g),c(u)&&De(e,n,r,C,u,h.tangent.values,g,!0),c(l)&&De(e,n,r,C,l,h.bitangent.values,g,!0),c(f)&&Pe(e,n,r,C,f,h.st.values,g),_>0)for(var R=0;R<_;R++){var b=p[R];J(e,n,r,C,g,v[b],h[b])}}}function J(e,t,n,r,i,a,o){var s=a.componentsPerAttribute,u=a.values,c=o.values;switch(s){case 4:Oe(e,t,n,r,u,c,i,!1);break;case 3:De(e,t,n,r,u,c,i,!1);break;case 2:Pe(e,t,n,r,u,c,i,!1);break;default:c[i]=u[e]*r.x+u[t]*r.y+u[n]*r.z}}function Q(e,t,n,r,i,a){var o=e.position.values.length/3;if(-1!==i){var s=r[i],u=n[s];return-1===u?(n[s]=o,e.position.values.push(a.x,a.y,a.z),t.push(o),o):(t.push(u),u)}return e.position.values.push(a.x,a.y,a.z),t.push(o),o}function $(e){var t=e.geometry,n=t.attributes,r=n.position.values,a=c(n.normal)?n.normal.values:void 0,o=c(n.bitangent)?n.bitangent.values:void 0,s=c(n.tangent)?n.tangent.values:void 0,u=c(n.st)?n.st.values:void 0,l=c(n.extrudeDirection)?n.extrudeDirection.values:void 0,f=c(n.applyOffset)?n.applyOffset.values:void 0,d=t.indices,m=[];for(var h in n)n.hasOwnProperty(h)&&!Be[h]&&c(n[h])&&m.push(h);var p,_,v,g,y,E=m.length,T=X(t),C=X(t),S=[];S.length=r.length/3;var A=[];for(A.length=r.length/3,y=0;y<S.length;++y)S[y]=-1,A[y]=-1;var x=d.length;for(y=0;y<x;y+=3){var w=d[y],R=d[y+1],b=d[y+2],I=i.fromArray(r,3*w),O=i.fromArray(r,3*R),D=i.fromArray(r,3*b),P=W(I,O,D);if(c(P)&&P.positions.length>3)for(var M=P.positions,N=P.indices,z=N.length,F=0;F<z;++F){var L=N[F],B=M[L];B.y<0?(p=C.attributes,_=C.indices,v=S):(p=T.attributes,_=T.indices,v=A),g=Q(p,_,v,d,L<3?y+L:-1,B),K(w,R,b,B,r,a,s,o,u,l,f,p,m,E,n,g)}else c(P)&&(I=P.positions[0],O=P.positions[1],D=P.positions[2]),I.y<0?(p=C.attributes,_=C.indices,v=S):(p=T.attributes,_=T.indices,v=A),g=Q(p,_,v,d,y,I),K(w,R,b,I,r,a,s,o,u,l,f,p,m,E,n,g),g=Q(p,_,v,d,y+1,O),K(w,R,b,O,r,a,s,o,u,l,f,p,m,E,n,g),g=Q(p,_,v,d,y+2,D),K(w,R,b,D,r,a,s,o,u,l,f,p,m,E,n,g)}j(e,C,T)}function ee(e,t,n,r,a,o,s){if(c(s)){var u=i.fromArray(r,3*e,Ne);i.equalsEpsilon(u,n,y.EPSILON10)?o.applyOffset.values[a]=s[e]:o.applyOffset.values[a]=s[t]}}function te(e){var t,n=e.geometry,r=n.attributes,a=r.position.values,o=c(r.applyOffset)?r.applyOffset.values:void 0,s=n.indices,u=X(n),l=X(n),f=s.length,d=[];d.length=a.length/3;var m=[];for(m.length=a.length/3,t=0;t<d.length;++t)d[t]=-1,m[t]=-1;for(t=0;t<f;t+=2){var h,p=s[t],_=s[t+1],v=i.fromArray(a,3*p,Ne),E=i.fromArray(a,3*_,ze);Math.abs(v.y)<y.EPSILON6&&(v.y<0?v.y=-y.EPSILON6:v.y=y.EPSILON6),Math.abs(E.y)<y.EPSILON6&&(E.y<0?E.y=-y.EPSILON6:E.y=y.EPSILON6);var T=u.attributes,C=u.indices,S=m,A=l.attributes,x=l.indices,w=d,R=g.lineSegmentPlane(v,E,Ue,Fe);if(c(R)){var b=i.multiplyByScalar(i.UNIT_Y,5*y.EPSILON9,Ge);v.y<0&&(i.negate(b,b),T=l.attributes,C=l.indices,S=d,A=u.attributes,x=u.indices,w=m);var I=i.add(R,b,Ve);h=Q(T,C,S,s,t,v),ee(p,_,v,a,h,T,o),h=Q(T,C,S,s,-1,I),ee(p,_,I,a,h,T,o),i.negate(b,b),i.add(R,b,I),h=Q(A,x,w,s,-1,I),ee(p,_,I,a,h,A,o),h=Q(A,x,w,s,t+1,E),ee(p,_,E,a,h,A,o)}else{var O,D,P;v.y<0?(O=l.attributes,D=l.indices,P=d):(O=u.attributes,D=u.indices,P=m),h=Q(O,D,P,s,t,v),ee(p,_,v,a,h,O,o),h=Q(O,D,P,s,t+1,E),ee(p,_,E,a,h,O,o)}}j(e,l,u)}function ne(e){for(var t=e.attributes,n=t.position.values,r=t.prevPosition.values,a=t.nextPosition.values,o=n.length,s=0;s<o;s+=3){var u=i.unpack(n,s,He);if(!(u.x>0)){var c=i.unpack(r,s,We);(u.y<0&&c.y>0||u.y>0&&c.y<0)&&(s-3>0?(r[s]=n[s-3],r[s+1]=n[s-2],r[s+2]=n[s-1]):i.pack(u,r,s));var l=i.unpack(a,s,Ye);(u.y<0&&l.y>0||u.y>0&&l.y<0)&&(s+3<o?(a[s]=n[s+3],a[s+1]=n[s+4],a[s+2]=n[s+5]):i.pack(u,a,s))}}}function re(e){var t,n,o,s=e.geometry,u=s.attributes,l=u.position.values,f=u.prevPosition.values,d=u.nextPosition.values,m=u.expandAndWidth.values,h=c(u.st)?u.st.values:void 0,p=c(u.color)?u.color.values:void 0,_=X(s),v=X(s),E=!1,T=l.length/3;for(t=0;t<T;t+=4){var C=t,S=t+2,A=i.fromArray(l,3*C,He),x=i.fromArray(l,3*S,We);if(Math.abs(A.y)<Qe)for(A.y=Qe*(x.y<0?-1:1),l[3*t+1]=A.y,l[3*(t+1)+1]=A.y,n=3*C;n<3*C+12;n+=3)f[n]=l[3*t],f[n+1]=l[3*t+1],f[n+2]=l[3*t+2];if(Math.abs(x.y)<Qe)for(x.y=Qe*(A.y<0?-1:1),l[3*(t+2)+1]=x.y,l[3*(t+3)+1]=x.y,n=3*C;n<3*C+12;n+=3)d[n]=l[3*(t+2)],d[n+1]=l[3*(t+2)+1],d[n+2]=l[3*(t+2)+2];var w=_.attributes,R=_.indices,b=v.attributes,I=v.indices,O=g.lineSegmentPlane(A,x,Ue,Xe);if(c(O)){E=!0;var D=i.multiplyByScalar(i.UNIT_Y,Je,je);A.y<0&&(i.negate(D,D),w=v.attributes,R=v.indices,b=_.attributes,I=_.indices);var P=i.add(O,D,Ze);w.position.values.push(A.x,A.y,A.z,A.x,A.y,A.z),w.position.values.push(P.x,P.y,P.z),w.position.values.push(P.x,P.y,P.z),w.prevPosition.values.push(f[3*C],f[3*C+1],f[3*C+2]),w.prevPosition.values.push(f[3*C+3],f[3*C+4],f[3*C+5]),w.prevPosition.values.push(A.x,A.y,A.z,A.x,A.y,A.z),w.nextPosition.values.push(P.x,P.y,P.z),w.nextPosition.values.push(P.x,P.y,P.z),w.nextPosition.values.push(P.x,P.y,P.z),w.nextPosition.values.push(P.x,P.y,P.z),i.negate(D,D),i.add(O,D,P),b.position.values.push(P.x,P.y,P.z),b.position.values.push(P.x,P.y,P.z),b.position.values.push(x.x,x.y,x.z,x.x,x.y,x.z),b.prevPosition.values.push(P.x,P.y,P.z),b.prevPosition.values.push(P.x,P.y,P.z),b.prevPosition.values.push(P.x,P.y,P.z),b.prevPosition.values.push(P.x,P.y,P.z),b.nextPosition.values.push(x.x,x.y,x.z,x.x,x.y,x.z),b.nextPosition.values.push(d[3*S],d[3*S+1],d[3*S+2]),b.nextPosition.values.push(d[3*S+3],d[3*S+4],d[3*S+5]);var M=r.fromArray(m,2*C,ke),N=Math.abs(M.y);w.expandAndWidth.values.push(-1,N,1,N),w.expandAndWidth.values.push(-1,-N,1,-N),b.expandAndWidth.values.push(-1,N,1,N),b.expandAndWidth.values.push(-1,-N,1,-N);var z=i.magnitudeSquared(i.subtract(O,A,Ye));if(z/=i.magnitudeSquared(i.subtract(x,A,Ye)),c(p)){var F=a.fromArray(p,4*C,Ke),L=a.fromArray(p,4*S,Ke),B=y.lerp(F.x,L.x,z),U=y.lerp(F.y,L.y,z),G=y.lerp(F.z,L.z,z),V=y.lerp(F.w,L.w,z);for(n=4*C;n<4*C+8;++n)w.color.values.push(p[n]);for(w.color.values.push(B,U,G,V),w.color.values.push(B,U,G,V),b.color.values.push(B,U,G,V),b.color.values.push(B,U,G,V),n=4*S;n<4*S+8;++n)b.color.values.push(p[n])}if(c(h)){var k=r.fromArray(h,2*C,ke),q=r.fromArray(h,2*(t+3),qe),H=y.lerp(k.x,q.x,z);for(n=2*C;n<2*C+4;++n)w.st.values.push(h[n]);for(w.st.values.push(H,k.y),w.st.values.push(H,q.y),b.st.values.push(H,k.y),b.st.values.push(H,q.y),n=2*S;n<2*S+4;++n)b.st.values.push(h[n])}o=w.position.values.length/3-4,R.push(o,o+2,o+1),R.push(o+1,o+2,o+3),o=b.position.values.length/3-4,I.push(o,o+2,o+1),I.push(o+1,o+2,o+3)}else{var W,Y;for(A.y<0?(W=v.attributes,Y=v.indices):(W=_.attributes,Y=_.indices),W.position.values.push(A.x,A.y,A.z),W.position.values.push(A.x,A.y,A.z),W.position.values.push(x.x,x.y,x.z),W.position.values.push(x.x,x.y,x.z),n=3*t;n<3*t+12;++n)W.prevPosition.values.push(f[n]),W.nextPosition.values.push(d[n]);for(n=2*t;n<2*t+8;++n)W.expandAndWidth.values.push(m[n]),c(h)&&W.st.values.push(h[n]);if(c(p))for(n=4*t;n<4*t+16;++n)W.color.values.push(p[n]);o=W.position.values.length/3-4,Y.push(o,o+2,o+1),Y.push(o+1,o+2,o+3)}}E&&(ne(v),ne(_)),j(e,v,_)}var ie={};ie.toWireframe=function(e){var t=e.indices;if(c(t)){switch(e.primitiveType){case S.TRIANGLES:e.indices=w(t);break;case S.TRIANGLE_STRIP:e.indices=R(t);break;case S.TRIANGLE_FAN:e.indices=b(t)}e.primitiveType=S.LINES}return e},ie.createLineSegmentsForVectors=function(e,t,r){t=u(t,"normal"),r=u(r,1e4);for(var i=e.attributes.position.values,a=e.attributes[t].values,o=i.length,l=new Float64Array(2*o),f=0,d=0;d<o;d+=3)l[f++]=i[d],l[f++]=i[d+1],l[f++]=i[d+2],l[f++]=i[d]+a[d]*r,l[f++]=i[d+1]+a[d+1]*r,l[f++]=i[d+2]+a[d+2]*r;var p,_=e.boundingSphere;return c(_)&&(p=new n(_.center,_.radius+r)),new m({attributes:{position:new h({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:l})},primitiveType:S.LINES,boundingSphere:p})},ie.createAttributeLocations=function(e){var t,n=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],r=e.attributes,i={},a=0,o=n.length;for(t=0;t<o;++t){var s=n[t];c(r[s])&&(i[s]=a++)}for(var u in r)r.hasOwnProperty(u)&&!c(i[u])&&(i[u]=a++);return i},ie.reorderForPreVertexCache=function(e){var t=m.computeNumberOfVertices(e),n=e.indices;if(c(n)){for(var r=new Int32Array(t),i=0;i<t;i++)r[i]=-1;for(var a,o=n,u=o.length,l=_.createTypedArray(t,u),f=0,d=0,h=0;f<u;)a=r[o[f]],-1!==a?l[d]=a:(a=o[f],r[a]=h,l[d]=h,++h),++f,++d;e.indices=l;var p=e.attributes;for(var v in p)if(p.hasOwnProperty(v)&&c(p[v])&&c(p[v].values)){for(var g=p[v],y=g.values,E=0,T=g.componentsPerAttribute,C=s.createTypedArray(g.componentDatatype,h*T);E<t;){var S=r[E];if(-1!==S)for(var A=0;A<T;A++)C[T*S+A]=y[T*E+A];++E}g.values=C}}return e},ie.reorderForPostVertexCache=function(e,t){var n=e.indices;if(e.primitiveType===S.TRIANGLES&&c(n)){for(var r=n.length,i=0,a=0;a<r;a++)n[a]>i&&(i=n[a]);e.indices=A.tipsify({indices:n,maximumIndex:i,cacheSize:t})}return e},ie.fitToUnsignedShortIndices=function(e){var t=[],n=m.computeNumberOfVertices(e);if(c(e.indices)&&n>=y.SIXTY_FOUR_KILOBYTES){var r,i=[],a=[],o=0,s=I(e.attributes),u=e.indices,l=u.length;e.primitiveType===S.TRIANGLES?r=3:e.primitiveType===S.LINES?r=2:e.primitiveType===S.POINTS&&(r=1);for(var f=0;f<l;f+=r){for(var d=0;d<r;++d){var h=u[f+d],p=i[h];c(p)||(p=o++,i[h]=p,O(s,e.attributes,h)),a.push(p)}o+r>=y.SIXTY_FOUR_KILOBYTES&&(t.push(new m({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),i=[],a=[],o=0,s=I(e.attributes))}0!==a.length&&t.push(new m({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var ae=new i,oe=new o;ie.projectTo2D=function(e,t,n,r,a){var o=e.attributes[t];a=c(a)?a:new d;for(var u=a.ellipsoid,l=o.values,f=new Float64Array(l.length),m=0,p=0;p<l.length;p+=3){var _=i.fromArray(l,p,ae),v=u.cartesianToCartographic(_,oe),g=a.project(v,ae);f[m++]=g.x,f[m++]=g.y,f[m++]=g.z}return e.attributes[n]=o,e.attributes[r]=new h({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:f}),delete e.attributes[t],e};var se={high:0,low:0};ie.encodeAttribute=function(e,t,n,r){for(var i=e.attributes[t],a=i.values,o=a.length,u=new Float32Array(o),c=new Float32Array(o),l=0;l<o;++l)f.encode(a[l],se),u[l]=se.high,c[l]=se.low;var d=i.componentsPerAttribute;return e.attributes[n]=new h({componentDatatype:s.FLOAT,componentsPerAttribute:d,values:u}),e.attributes[r]=new h({componentDatatype:s.FLOAT,componentsPerAttribute:d,values:c}),delete e.attributes[t],e};var ue=new i,ce=new T,le=new E;ie.transformToWorldCoordinates=function(e){var t=e.modelMatrix;if(T.equals(t,T.IDENTITY))return e;var r=e.geometry.attributes;D(t,r.position),D(t,r.prevPosition),D(t,r.nextPosition),(c(r.normal)||c(r.tangent)||c(r.bitangent))&&(T.inverse(t,ce),T.transpose(ce,ce),T.getRotation(ce,le),P(le,r.normal),P(le,r.tangent),P(le,r.bitangent));var i=e.geometry.boundingSphere;return c(i)&&(e.geometry.boundingSphere=n.transform(i,t,i)),e.modelMatrix=T.clone(T.IDENTITY),e};var fe=new i;ie.combineInstances=function(e){for(var t=[],n=[],r=e.length,i=0;i<r;++i){var a=e[i];c(a.geometry)?t.push(a):c(a.westHemisphereGeometry)&&c(a.eastHemisphereGeometry)&&n.push(a)}var o=[];return t.length>0&&o.push(N(t,"geometry")),n.length>0&&(o.push(N(n,"westHemisphereGeometry")),o.push(N(n,"eastHemisphereGeometry"))),o};var de=new i,me=new i,he=new i,pe=new i;ie.computeNormal=function(e){var t,n=e.indices,r=e.attributes,a=r.position.values,o=r.position.values.length/3,u=n.length,c=new Array(o),l=new Array(u/3),f=new Array(u);for(t=0;t<o;t++)c[t]={indexOffset:0,count:0,currentCount:0};var d=0;for(t=0;t<u;t+=3){var m=n[t],p=n[t+1],_=n[t+2],v=3*m,g=3*p,E=3*_;me.x=a[v],me.y=a[v+1],me.z=a[v+2],he.x=a[g],he.y=a[g+1],he.z=a[g+2],pe.x=a[E],pe.y=a[E+1],pe.z=a[E+2],c[m].count++,c[p].count++,c[_].count++,i.subtract(he,me,he),i.subtract(pe,me,pe),l[d]=i.cross(he,pe,new i),d++}var T=0;for(t=0;t<o;t++)c[t].indexOffset+=T,T+=c[t].count;d=0;var C;for(t=0;t<u;t+=3){C=c[n[t]];var S=C.indexOffset+C.currentCount;f[S]=d,C.currentCount++,C=c[n[t+1]],S=C.indexOffset+C.currentCount,f[S]=d,C.currentCount++,C=c[n[t+2]],S=C.indexOffset+C.currentCount,f[S]=d,C.currentCount++,d++}var A=new Float32Array(3*o);for(t=0;t<o;t++){var x=3*t;if(C=c[t],i.clone(i.ZERO,de),C.count>0){for(d=0;d<C.count;d++)i.add(de,l[f[C.indexOffset+d]],de);i.equalsEpsilon(i.ZERO,de,y.EPSILON10)&&i.clone(l[f[C.indexOffset]],de)}i.equalsEpsilon(i.ZERO,de,y.EPSILON10)&&(de.z=1),i.normalize(de,de),A[x]=de.x,A[x+1]=de.y,A[x+2]=de.z}return e.attributes.normal=new h({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:A}),e};var _e=new i,ve=new i,ge=new i;ie.computeTangentAndBitangent=function(e){var t,n=(e.attributes,e.indices),r=e.attributes.position.values,a=e.attributes.normal.values,o=e.attributes.st.values,u=e.attributes.position.values.length/3,c=n.length,l=new Array(3*u);for(t=0;t<l.length;t++)l[t]=0;var f,d,m;for(t=0;t<c;t+=3){var p=n[t],_=n[t+1],v=n[t+2];f=3*p,d=3*_,m=3*v;var g=2*p,y=2*_,E=2*v,T=r[f],C=r[f+1],S=r[f+2],A=o[g],x=o[g+1],w=o[y+1]-x,R=o[E+1]-x,b=1/((o[y]-A)*R-(o[E]-A)*w),I=(R*(r[d]-T)-w*(r[m]-T))*b,O=(R*(r[d+1]-C)-w*(r[m+1]-C))*b,D=(R*(r[d+2]-S)-w*(r[m+2]-S))*b;l[f]+=I,l[f+1]+=O,l[f+2]+=D,l[d]+=I,l[d+1]+=O,l[d+2]+=D,l[m]+=I,l[m+1]+=O,l[m+2]+=D}var P=new Float32Array(3*u),M=new Float32Array(3*u);for(t=0;t<u;t++){f=3*t,d=f+1,m=f+2;var N=i.fromArray(a,f,_e),z=i.fromArray(l,f,ge),F=i.dot(N,z);i.multiplyByScalar(N,F,ve),i.normalize(i.subtract(z,ve,z),z),P[f]=z.x,P[d]=z.y,P[m]=z.z,i.normalize(i.cross(N,z,z),z),M[f]=z.x,M[d]=z.y,M[m]=z.z}return e.attributes.tangent=new h({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:P}),e.attributes.bitangent=new h({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:M}),e};var ye=new r,Ee=new i,Te=new i,Ce=new i,Se=new r;ie.compressVertices=function(t){var n,a,o=t.attributes.extrudeDirection;if(c(o)){var u=o.values;a=u.length/3;var l=new Float32Array(2*a),f=0;for(n=0;n<a;++n)i.fromArray(u,3*n,Ee),i.equals(Ee,i.ZERO)?f+=2:(Se=e.octEncodeInRange(Ee,65535,Se),l[f++]=Se.x,l[f++]=Se.y);return t.attributes.compressedAttributes=new h({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:l}),delete t.attributes.extrudeDirection,t}var d=t.attributes.normal,m=t.attributes.st,p=c(d),_=c(m);if(!p&&!_)return t;var v,g,y,E,T=t.attributes.tangent,C=t.attributes.bitangent,S=c(T),A=c(C);p&&(v=d.values),_&&(g=m.values),S&&(y=T.values),A&&(E=C.values),a=(p?v.length:g.length)/(p?3:2);var x=a,w=_&&p?2:1;w+=S||A?1:0,x*=w;var R=new Float32Array(x),b=0;for(n=0;n<a;++n){_&&(r.fromArray(g,2*n,ye),R[b++]=e.compressTextureCoordinates(ye));var I=3*n;p&&c(y)&&c(E)?(i.fromArray(v,I,Ee),i.fromArray(y,I,Te),i.fromArray(E,I,Ce),e.octPack(Ee,Te,Ce,ye),R[b++]=ye.x,R[b++]=ye.y):(p&&(i.fromArray(v,I,Ee),R[b++]=e.octEncodeFloat(Ee)),S&&(i.fromArray(y,I,Ee),R[b++]=e.octEncodeFloat(Ee)),A&&(i.fromArray(E,I,Ee),R[b++]=e.octEncodeFloat(Ee)))}return t.attributes.compressedAttributes=new h({componentDatatype:s.FLOAT,componentsPerAttribute:w,values:R}),p&&delete t.attributes.normal,_&&delete t.attributes.st,A&&delete t.attributes.bitangent,S&&delete t.attributes.tangent,t};var Ae=new i,xe=new i,we=new i,Re=new i,be=new i,Ie={positions:new Array(7),indices:new Array(9)},Oe=Z(a,4),De=Z(i,3),Pe=Z(r,2),Me=function(e,t,n,r,i,a,o){var s=i[e]*r.x,u=i[t]*r.y,c=i[n]*r.z;a[o]=s+u+c>y.EPSILON6?1:0},Ne=new i,ze=new i,Fe=new i,Le=new i,Be={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0},Ue=C.fromPointNormal(i.ZERO,i.UNIT_Y),Ge=new i,Ve=new i,ke=new r,qe=new r,He=new i,We=new i,Ye=new i,Xe=new i,je=new i,Ze=new i,Ke=new a,Je=5*y.EPSILON9,Qe=y.EPSILON6;return ie.splitLongitude=function(e){var t=e.geometry,r=t.boundingSphere;if(c(r)){if(r.center.x-r.radius>0||n.intersectPlane(r,C.ORIGIN_ZX_PLANE)!==v.INTERSECTING)return e}if(t.geometryType!==p.NONE)switch(t.geometryType){case p.POLYLINES:re(e);break;case p.TRIANGLES:$(e);break;case p.LINES:te(e)}else V(t),t.primitiveType===S.TRIANGLES?$(e):t.primitiveType===S.LINES&&te(e);return e},ie}),define("Core/OffsetGeometryInstanceAttribute",["./Check","./ComponentDatatype","./defaultValue","./defined","./defineProperties"],function(e,t,n,r,i){"use strict";function a(e,t,r){e=n(e,0),t=n(t,0),r=n(r,0),this.value=new Float32Array([e,t,r])}return i(a.prototype,{componentDatatype:{get:function(){return t.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}}),a.fromCartesian3=function(e){return new a(e.x,e.y,e.z)},a.toValue=function(e,t){return r(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t},a}),define("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/OffsetGeometryInstanceAttribute","../Core/WebMercatorProjection"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p){"use strict";function _(e,t,n){var i,a=!n,o=e.length;if(!a&&o>1){var s=e[0].modelMatrix;for(i=1;i<o;++i)if(!m.equals(s,e[i].modelMatrix)){a=!0;break}}if(a)for(i=0;i<o;++i)r(e[i].geometry)&&f.transformToWorldCoordinates(e[i]);else m.multiplyTransformation(t,e[0].modelMatrix,t)}function v(e,n){var r=e.attributes,i=r.position,a=i.values.length/i.componentsPerAttribute;r.batchId=new c({componentDatatype:t.FLOAT,componentsPerAttribute:1,values:new Float32Array(a)});for(var o=r.batchId.values,s=0;s<a;++s)o[s]=n}function g(e){for(var t=e.length,n=0;n<t;++n){var i=e[n];r(i.geometry)?v(i.geometry,n):r(i.westHemisphereGeometry)&&r(i.eastHemisphereGeometry)&&(v(i.westHemisphereGeometry,n),v(i.eastHemisphereGeometry,n))}}function y(n){var i,a,o=n.instances,s=n.projection,u=n.elementIndexUintSupported,c=n.scene3DOnly,l=n.vertexCacheOptimize,d=n.compressVertices,m=n.modelMatrix,h=o.length;for(i=0;i<h;++i)if(r(o[i].geometry)){o[i].geometry.primitiveType;break}if(_(o,m,c),!c)for(i=0;i<h;++i)r(o[i].geometry)&&f.splitLongitude(o[i]);if(g(o),l)for(i=0;i<h;++i){var p=o[i];r(p.geometry)?(f.reorderForPostVertexCache(p.geometry),f.reorderForPreVertexCache(p.geometry)):r(p.westHemisphereGeometry)&&r(p.eastHemisphereGeometry)&&(f.reorderForPostVertexCache(p.westHemisphereGeometry),f.reorderForPreVertexCache(p.westHemisphereGeometry),f.reorderForPostVertexCache(p.eastHemisphereGeometry),f.reorderForPreVertexCache(p.eastHemisphereGeometry))}var v=f.combineInstances(o);for(h=v.length,i=0;i<h;++i){a=v[i];var y,E=a.attributes;if(c)for(y in E)E.hasOwnProperty(y)&&E[y].componentDatatype===t.DOUBLE&&f.encodeAttribute(a,y,y+"3DHigh",y+"3DLow");else for(y in E)if(E.hasOwnProperty(y)&&E[y].componentDatatype===t.DOUBLE){var T=y+"3D",C=y+"2D";f.projectTo2D(a,y,T,C,s),r(a.boundingSphere)&&"position"===y&&(a.boundingSphereCV=e.fromVertices(a.attributes.position2D.values)),f.encodeAttribute(a,T,T+"High",T+"Low"),f.encodeAttribute(a,C,C+"High",C+"Low")}d&&f.compressVertices(a)}if(!u){var S=[];for(h=v.length,i=0;i<h;++i)a=v[i],S=S.concat(f.fitToUnsignedShortIndices(a));v=S}return v}function E(e,t,n,i){var a,o,s,u=i.length-1;if(u>=0){var c=i[u];a=c.offset+c.count,s=c.index,o=n[s].indices.length}else a=0,s=0,o=n[s].indices.length;for(var l=e.length,f=0;f<l;++f){var d=e[f],m=d[t];if(r(m)){var h=m.indices.length;a+h>o&&(a=0,o=n[++s].indices.length),i.push({index:s,offset:a,count:h}),a+=h}}}function T(e,t){var n=[];return E(e,"geometry",t,n),E(e,"westHemisphereGeometry",t,n),E(e,"eastHemisphereGeometry",t,n),n}function C(e,t){var n=e.attributes;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];r(a)&&r(a.values)&&t.push(a.values.buffer)}r(e.indices)&&t.push(e.indices.buffer)}function S(e,t){for(var n=e.length,r=0;r<n;++r)C(e[r],t)}function A(t){for(var n=1,i=t.length,a=0;a<i;a++){var o=t[a];if(++n,r(o)){var s=o.attributes;n+=7+2*e.packedLength+(r(o.indices)?o.indices.length:0);for(var u in s)if(s.hasOwnProperty(u)&&r(s[u])){var c=s[u];n+=5+c.values.length}}}return n}function x(e,t){var n=e.length,i=new Float64Array(1+19*n),a=0;i[a++]=n;for(var o=0;o<n;o++){var s=e[o];if(m.pack(s.modelMatrix,i,a),a+=m.packedLength,r(s.attributes)&&r(s.attributes.offset)){var u=s.attributes.offset.value;i[a]=u[0],i[a+1]=u[1],i[a+2]=u[2]}a+=3}return t.push(i.buffer),i}function w(e){for(var t=e,n=new Array(t[0]),i=0,a=1;a<t.length;){var o,s=m.unpack(t,a);a+=m.packedLength,r(t[a])&&(o={offset:new h(t[a],t[a+1],t[a+2])}),a+=3,n[i++]={modelMatrix:s,attributes:o}}return n}function R(t){var n=t.length,i=1+(e.packedLength+1)*n,a=new Float32Array(i),o=0;a[o++]=n;for(var s=0;s<n;++s){var u=t[s];r(u)?(a[o++]=1,e.pack(t[s],a,o)):a[o++]=0,o+=e.packedLength}return a}function b(t){for(var n=new Array(t[0]),r=0,i=1;i<t.length;)1===t[i++]&&(n[r]=e.unpack(t,i)),++r,i+=e.packedLength;return n}if(!o.supportsTypedArrays())return{};var I={};return I.combineGeometry=function(t){var n,i,a,o,s=t.instances,u=s.length,c=!1;u>0&&(n=y(t),n.length>0&&(i=f.createAttributeLocations(n[0]),t.createPickOffsets&&(a=T(s,n))),r(s[0].attributes)&&r(s[0].attributes.offset)&&(o=new Array(u),c=!0));for(var l=new Array(u),d=new Array(u),m=0;m<u;++m){var h=s[m],p=h.geometry;r(p)&&(l[m]=p.boundingSphere,d[m]=p.boundingSphereCV,c&&(o[m]=h.geometry.offsetAttribute));var _=h.eastHemisphereGeometry,v=h.westHemisphereGeometry;r(_)&&r(v)&&(r(_.boundingSphere)&&r(v.boundingSphere)&&(l[m]=e.union(_.boundingSphere,v.boundingSphere)),r(_.boundingSphereCV)&&r(v.boundingSphereCV)&&(d[m]=e.union(_.boundingSphereCV,v.boundingSphereCV)))}return{geometries:n,modelMatrix:t.modelMatrix,attributeLocations:i,pickOffsets:a,offsetInstanceExtend:o,boundingSpheres:l,boundingSpheresCV:d}},I.packCreateGeometryResults=function(t,i){var a=new Float64Array(A(t)),o=[],s={},u=t.length,c=0;a[c++]=u;for(var l=0;l<u;l++){var f=t[l],d=r(f);if(a[c++]=d?1:0,d){a[c++]=f.primitiveType,a[c++]=f.geometryType,a[c++]=n(f.offsetAttribute,-1);var m=r(f.boundingSphere)?1:0;a[c++]=m,m&&e.pack(f.boundingSphere,a,c),c+=e.packedLength;var h=r(f.boundingSphereCV)?1:0;a[c++]=h,h&&e.pack(f.boundingSphereCV,a,c),c+=e.packedLength;var p=f.attributes,_=[];for(var v in p)p.hasOwnProperty(v)&&r(p[v])&&(_.push(v),r(s[v])||(s[v]=o.length,o.push(v)));a[c++]=_.length;for(var g=0;g<_.length;g++){var y=_[g],E=p[y];a[c++]=s[y],a[c++]=E.componentDatatype,a[c++]=E.componentsPerAttribute,a[c++]=E.normalize?1:0,a[c++]=E.values.length,a.set(E.values,c),c+=E.values.length}var T=r(f.indices)?f.indices.length:0;a[c++]=T,T>0&&(a.set(f.indices,c),c+=T)}}return i.push(a.buffer),{stringTable:o,packedData:a}},I.unpackCreateGeometryResults=function(n){for(var r,i=n.stringTable,a=n.packedData,o=new Array(a[0]),s=0,f=1;f<a.length;){if(1===a[f++]){var m=a[f++],h=a[f++],p=a[f++];-1===p&&(p=void 0);var _,v;1===a[f++]&&(_=e.unpack(a,f)),f+=e.packedLength;1===a[f++]&&(v=e.unpack(a,f)),f+=e.packedLength;var g,y,E,T=new l,C=a[f++];for(r=0;r<C;r++){var S=i[a[f++]],A=a[f++];E=a[f++];var x=0!==a[f++];g=a[f++],y=t.createTypedArray(A,g);for(var w=0;w<g;w++)y[w]=a[f++];T[S]=new c({componentDatatype:A,componentsPerAttribute:E,normalize:x,values:y})}var R;if((g=a[f++])>0){var b=y.length/E;for(R=d.createTypedArray(b,g),r=0;r<g;r++)R[r]=a[f++]}o[s++]=new u({primitiveType:m,geometryType:h,boundingSphere:_,boundingSphereCV:v,indices:R,attributes:T,offsetAttribute:p})}else o[s++]=void 0}return o},I.packCombineGeometryParameters=function(e,t){for(var n=e.createGeometryResults,r=n.length,i=0;i<r;i++)t.push(n[i].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:x(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},I.unpackCombineGeometryParameters=function(e){for(var t=w(e.packedInstances),n=e.createGeometryResults,r=n.length,i=0,o=0;o<r;o++)for(var u=I.unpackCreateGeometryResults(n[o]),c=u.length,l=0;l<c;l++){var f=u[l],d=t[i];d.geometry=f,++i}var h=a.clone(e.ellipsoid);return{instances:t,ellipsoid:h,projection:e.isGeographic?new s(h):new p(h),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:m.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},I.packCombineGeometryResults=function(e,t){r(e.geometries)&&S(e.geometries,t);var n=R(e.boundingSpheres),i=R(e.boundingSpheresCV);return t.push(n.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:i}},I.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:b(e.boundingSpheres),boundingSpheresCV:b(e.boundingSpheresCV)}},I}),define("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";return e({READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6})}),define("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};return t.getMorphTime=function(e){if(e===t.SCENE3D)return 1;if(e!==t.MORPHING)return 0},e(t)}),define("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var t={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4};return t.castShadows=function(e){return e===t.ENABLED||e===t.CAST_ONLY},t.receiveShadows=function(e){return e===t.ENABLED||e===t.RECEIVE_ONLY},t.fromCastReceive=function(e,n){return e&&n?t.ENABLED:e?t.CAST_ONLY:n?t.RECEIVE_ONLY:t.DISABLED},e(t)}),define("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryOffsetAttribute","../Core/Intersect","../Core/isArray","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./DepthFunction","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A,x,w,R,b,I,O,D,P,M,N,z,F,L,B,U,G,V,k){"use strict";function q(e){e=c(e,c.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=C.clone(c(e.modelMatrix,C.IDENTITY)),this._modelMatrix=new C,this.show=c(e.show,!0),this._vertexCacheOptimize=c(e.vertexCacheOptimize,!1),this._interleave=c(e.interleave,!1),this._releaseGeometryInstances=c(e.releaseGeometryInstances,!0),this._allowPicking=c(e.allowPicking,!0),this._asynchronous=c(e.asynchronous,!0),this._compressVertices=c(e.compressVertices,!0),this.cull=c(e.cull,!0),this.debugShowBoundingVolume=c(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=c(e.shadows,k.DISABLED),this._translucent=void 0,this._state=G.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=z.defer(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function H(e){var t,n=e.length,r=[],i=e[0].attributes;for(t in i)if(i.hasOwnProperty(t)&&l(i[t])){for(var a=i[t],o=!0,s=1;s<n;++s){var u=e[s].attributes[t];if(!l(u)||a.componentDatatype!==u.componentDatatype||a.componentsPerAttribute!==u.componentsPerAttribute||a.normalize!==u.normalize){o=!1;break}}o&&r.push(t)}return r}function W(e){var i=e.length;return 1===i?e[0]:2===i?t.unpack(e,0,Ee):3===i?n.unpack(e,0,Te):4===i?r.unpack(e,0,Ce):void 0}function Y(e,t){var n=e.geometryInstances,r=T(n)?n:[n],i=r.length;if(0!==i){var a,s,f,d,m=H(r),h=m.length,p=[],_={},v={},g=r[0],y=g.attributes;for(s=0;s<h;++s)f=m[s],d=y[f],_[f]=s,p.push({functionName:"czm_batchTable_"+f,componentDatatype:d.componentDatatype,
componentsPerAttribute:d.componentsPerAttribute,normalize:d.normalize});-1!==m.indexOf("distanceDisplayCondition")&&(p.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:u.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:u.FLOAT,componentsPerAttribute:1}),v.center3DHigh=p.length-5,v.center3DLow=p.length-4,v.center2DHigh=p.length-3,v.center2DLow=p.length-2,v.radius=p.length-1),-1!==m.indexOf("offset")&&(p.push({functionName:"czm_batchTable_offset2D",componentDatatype:u.FLOAT,componentsPerAttribute:3}),a=p.length-1),p.push({functionName:"czm_batchTable_pickColor",componentDatatype:u.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});var E=p.length,C=new F(t,p,i);for(s=0;s<i;++s){var S=r[s];y=S.attributes;for(var A=0;A<h;++A){f=m[A],d=y[f];var x=W(d.value),w=_[f];C.setBatchedAttribute(s,w,x)}var R={primitive:c(S.pickPrimitive,e)};l(S.id)&&(R.id=S.id);var b=t.createPickId(R);e._pickIds.push(b);var I=b.color,O=Ce;O.x=o.floatToByte(I.red),O.y=o.floatToByte(I.green),O.z=o.floatToByte(I.blue),O.w=o.floatToByte(I.alpha),C.setBatchedAttribute(s,E-1,O)}e._batchTable=C,e._batchTableAttributeIndices=_,e._batchTableBoundingSphereAttributeIndices=v,e._batchTableOffsetAttribute2DIndex=a}}function X(e){var t;return t=T(e.values)?e.values.slice(0):new e.values.constructor(e.values),new v({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function j(t){var n=t.attributes,r=new g;for(var i in n)n.hasOwnProperty(i)&&l(n[i])&&(r[i]=X(n[i]));var a;if(l(t.indices)){var o=t.indices;a=T(o)?o.slice(0):new o.constructor(o)}return new _({attributes:r,indices:a,primitiveType:t.primitiveType,boundingSphere:e.clone(t.boundingSphere)})}function Z(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:C.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}function K(e){return M.replaceMain(e,"czm_non_pick_main")+"\nvarying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}"}function J(e){return"varying vec4 v_pickColor;\n"+e}function Q(e,t){if(!e.compressVertices)return t;var n=-1!==t.search(/attribute\s+vec3\s+normal;/g),r=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!n&&!r)return t;var i=-1!==t.search(/attribute\s+vec3\s+tangent;/g),a=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),o=r&&n?2:1;o+=i||a?1:0;var s=o>1?"vec"+o:"float",u="compressedAttributes",c="attribute "+s+" "+u+";",l="",f="";if(r){l+="vec2 st;\n";f+="    st = czm_decompressTextureCoordinates("+(o>1?u+".x":u)+");\n"}n&&i&&a?(l+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",f+="    czm_octDecode("+u+"."+(r?"yz":"xy")+", normal, tangent, bitangent);\n"):(n&&(l+="vec3 normal;\n",f+="    normal = czm_octDecode("+u+(o>1?"."+(r?"y":"x"):"")+");\n"),i&&(l+="vec3 tangent;\n",f+="    tangent = czm_octDecode("+u+"."+(r&&n?"z":"y")+");\n"),a&&(l+="vec3 bitangent;\n",f+="    bitangent = czm_octDecode("+u+"."+(r&&n?"z":"y")+");\n"));var d=t;return d=d.replace(/attribute\s+vec3\s+normal;/g,""),d=d.replace(/attribute\s+vec2\s+st;/g,""),d=d.replace(/attribute\s+vec3\s+tangent;/g,""),d=d.replace(/attribute\s+vec3\s+bitangent;/g,""),d=M.replaceMain(d,"czm_non_compressed_main"),[c,l,d,"void main() \n{ \n"+f+"    czm_non_compressed_main(); \n}"].join("\n")}function $(e){var t=M.replaceMain(e,"czm_non_depth_clamp_main");return t+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n    vec4 position = gl_Position;\n    v_WindowZ = (0.5 * (position.z / position.w) + 0.5) * position.w;\n    position.z = min(position.z, position.w);\n    gl_Position = position;\n}\n"}function ee(e){var t=M.replaceMain(e,"czm_non_depth_clamp_main");return t+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\n    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n",t="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+t}function te(e,t){e.vertexAttributes}function ne(e,t){return function(){return e[t]}}function re(e,t){var n,r,i,a,o=e._instanceIds;if(e._state===G.READY){n=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s=e._numberOfInstances=n.length,u=[],f=[];for(i=0;i<s;++i)r=n[i].geometry,o.push(n[i].id),f.push({moduleName:r._workerName,geometry:r});if(!l(Ae))for(Ae=new Array(xe),i=0;i<xe;i++)Ae[i]=new w("createGeometry",Number.POSITIVE_INFINITY);var d;for(f=x(f,xe),i=0;i<f.length;i++){var m=0,h=f[i],p=h.length;for(a=0;a<p;++a)d=h[a],r=d.geometry,l(r.constructor.pack)&&(d.offset=m,m+=c(r.constructor.packedLength,r.packedLength));var _;if(m>0){var v=new Float64Array(m);for(_=[v.buffer],a=0;a<p;++a)d=h[a],r=d.geometry,l(r.constructor.pack)&&(r.constructor.pack(r,v,d.offset),d.geometry=v)}u.push(Ae[i].scheduleTask({subTasks:f[i]},_))}e._state=G.CREATING,z.all(u,function(t){e._createGeometryResults=t,e._state=G.CREATED}).otherwise(function(n){ye(e,t,G.FAILED,n)})}else if(e._state===G.CREATED){var g=[];n=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var y=t.scene3DOnly,E=t.mapProjection,S=we.scheduleTask(U.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:E.ellipsoid,projection:E,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:y,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},g),g);e._createGeometryResults=void 0,e._state=G.COMBINING,z(S,function(n){var r=U.unpackCombineGeometryResults(n);e._geometries=r.geometries,e._attributeLocations=r.attributeLocations,e.modelMatrix=C.clone(r.modelMatrix,e.modelMatrix),e._pickOffsets=r.pickOffsets,e._offsetInstanceExtend=r.offsetInstanceExtend,e._instanceBoundingSpheres=r.boundingSpheres,e._instanceBoundingSpheresCV=r.boundingSpheresCV,l(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=G.COMBINED):ye(e,t,G.FAILED,void 0)}).otherwise(function(n){ye(e,t,G.FAILED,n)})}}function ie(e,t){var n,r,i=T(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=i.length,o=new Array(a),s=e._instanceIds,u=0;for(r=0;r<a;r++){n=i[r];var c,f=n.geometry;c=l(f.attributes)&&l(f.primitiveType)?j(f):f.constructor.createGeometry(f),o[u++]=Z(n,c),s.push(n.id)}o.length=u;var d=t.scene3DOnly,m=t.mapProjection,h=U.combineGeometry({instances:o,ellipsoid:m.ellipsoid,projection:m,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:d,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=h.geometries,e._attributeLocations=h.attributeLocations,e.modelMatrix=C.clone(h.modelMatrix,e.modelMatrix),e._pickOffsets=h.pickOffsets,e._offsetInstanceExtend=h.offsetInstanceExtend,e._instanceBoundingSpheres=h.boundingSpheres,e._instanceBoundingSpheresCV=h.boundingSpheresCV,l(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=G.COMBINED):ye(e,t,G.FAILED,void 0)}function ae(t,r){var i=t._batchTableAttributeIndices.offset;if(!t._recomputeBoundingSpheres||!l(i))return void(t._recomputeBoundingSpheres=!1);var a,o=t._offsetInstanceExtend,s=t._instanceBoundingSpheres,u=s.length,c=t._tempBoundingSpheres;if(!l(c)){for(c=new Array(u),a=0;a<u;a++)c[a]=new e;t._tempBoundingSpheres=c}for(a=0;a<u;++a){var f=c[a],d=t._batchTable.getBatchedAttribute(a,i,new n);f=s[a].clone(f),he(f,d,o[a])}var m=[],h=[],p=[];for(a=0;a<u;++a){var _=c[a];_.center.x-_.radius>0||e.intersectPlane(_,S.ORIGIN_ZX_PLANE)!==E.INTERSECTING?m.push(_):(h.push(_),p.push(_))}var v=m[0],g=p[0],y=h[0];for(a=1;a<m.length;a++)v=e.union(v,m[a]);for(a=1;a<p.length;a++)g=e.union(g,p[a]);for(a=1;a<h.length;a++)y=e.union(y,h[a]);var T=[];for(l(v)&&T.push(v),l(g)&&T.push(g),l(y)&&T.push(y),a=0;a<T.length;a++){var C=T[a].clone(t._boundingSpheres[a]);t._boundingSpheres[a]=C,t._boundingSphereCV[a]=e.projectTo2D(C,r.mapProjection,t._boundingSphereCV[a])}q._updateBoundingVolumes(t,r,t.modelMatrix,!0),t._recomputeBoundingSpheres=!1}function oe(t,n){if(l(t._batchTableAttributeIndices.distanceDisplayCondition)&&!t._batchTableBoundingSpheresUpdated){for(var r=t._batchTableBoundingSphereAttributeIndices,i=r.center3DHigh,a=r.center3DLow,o=r.center2DHigh,s=r.center2DLow,u=r.radius,c=n.mapProjection,f=c.ellipsoid,d=t._batchTable,m=t._instanceBoundingSpheres,p=m.length,_=0;_<p;++_){var v=m[_];if(l(v)){var g=t.modelMatrix;l(g)&&(v=e.transform(v,g,Oe));var y=v.center,E=v.radius,T=h.fromCartesian(y,Re);if(d.setBatchedAttribute(_,i,T.high),d.setBatchedAttribute(_,a,T.low),!n.scene3DOnly){var C=f.cartesianToCartographic(y,be),S=c.project(C,Ie);T=h.fromCartesian(S,Re),d.setBatchedAttribute(_,o,T.high),d.setBatchedAttribute(_,s,T.low)}d.setBatchedAttribute(_,u,E)}}t._batchTableBoundingSpheresUpdated=!0}}function se(t,r){if(l(t._batchTableAttributeIndices.offset)&&!t._batchTableOffsetsUpdated&&!r.scene3DOnly){for(var i=t._batchTableOffsetAttribute2DIndex,a=r.mapProjection,o=a.ellipsoid,s=t._batchTable,u=t._instanceBoundingSpheres,c=u.length,f=0;f<c;++f){var d=u[f];if(l(d)){var m=s.getBatchedAttribute(f,t._batchTableAttributeIndices.offset);if(n.equals(m,n.ZERO))s.setBatchedAttribute(f,i,n.ZERO);else{var h=t.modelMatrix;l(h)&&(d=e.transform(d,h,Oe));var p=d.center;p=o.scaleToGeodeticSurface(p,Pe);var _=o.cartesianToCartographic(p,be),v=a.project(_,Ie),g=n.add(m,p,De);_=o.cartesianToCartographic(g,_);var y=a.project(_,De),E=n.subtract(y,v,De),T=E.x;E.x=E.z,E.z=E.y,E.y=T,s.setBatchedAttribute(f,i,E)}}}t._batchTableOffsetsUpdated=!0}}function ue(t,n){for(var r=t._attributeLocations,i=t._geometries,a=n.scene3DOnly,o=n.context,s=[],u=i.length,c=0;c<u;++c){var f=i[c];if(s.push(N.fromGeometry({context:o,geometry:f,attributeLocations:r,bufferUsage:R.STATIC_DRAW,interleave:t._interleave})),l(t._createBoundingVolumeFunction))t._createBoundingVolumeFunction(n,f);else if(t._boundingSpheres.push(e.clone(f.boundingSphere)),t._boundingSphereWC.push(new e),!a){var d=f.boundingSphereCV.center,m=d.x,h=d.y,p=d.z;d.x=p,d.y=m,d.z=h,t._boundingSphereCV.push(e.clone(f.boundingSphereCV)),t._boundingSphere2D.push(new e),t._boundingSphereMorph.push(new e)}}t._va=s,t._primitiveType=i[0].primitiveType,t.releaseGeometryInstances&&(t.geometryInstances=void 0),t._geometries=void 0,ye(t,n,G.COMPLETE,void 0)}function ce(e,t,n,r){var i,o=n.getRenderState();r?(i=a(o,!1),i.cull={enabled:!0,face:L.BACK},e._frontFaceRS=D.fromCache(i),i.cull.face=L.FRONT,e._backFaceRS=D.fromCache(i)):(e._frontFaceRS=D.fromCache(o),e._backFaceRS=e._frontFaceRS),i=a(o,!1),l(e._depthFailAppearance)&&(i.depthTest.enabled=!1),l(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),i=a(o,!1),i.depthTest.func=B.GREATER,r?(i.cull={enabled:!0,face:L.BACK},e._frontFaceDepthFailRS=D.fromCache(i),i.cull.face=L.FRONT,e._backFaceDepthFailRS=D.fromCache(i)):(e._frontFaceDepthFailRS=D.fromCache(i),e._backFaceDepthFailRS=e._frontFaceRS))}function le(e,t,n){var r=t.context,i=e._attributeLocations,a=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);a=q._appendOffsetToShader(e,a),a=q._appendShowToShader(e,a),a=q._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=K(a),a=q._updateColorAttribute(e,a,!1),a=Q(e,a),a=q._modifyShaderPosition(e,a,t.scene3DOnly);var o=n.getFragmentShaderSource();o=J(o),e._sp=P.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:i}),te(e._sp,i),l(e._depthFailAppearance)&&(a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),a=q._appendShowToShader(e,a),a=q._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly),a=K(a),a=q._updateColorAttribute(e,a,!0),a=Q(e,a),a=q._modifyShaderPosition(e,a,t.scene3DOnly),a=$(a),o=e._depthFailAppearance.getFragmentShaderSource(),o=J(o),o=ee(o),e._spDepthFail=P.replaceCache({context:r,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:i}),te(e._spDepthFail,i))}function fe(e,t,n,r){var i=l(n)?n._uniforms:void 0,a={},o=t.uniforms;if(l(o))for(var u in o)o.hasOwnProperty(u)&&(a[u]=ne(o,u));var c=s(a,i);return c=e._batchTable.getUniformMapCallback()(c),l(e.rtcCenter)&&(c.u_modifiedModelView=function(){var t=r.context.uniformState.view;return C.multiply(t,e._modelMatrix,Me),C.multiplyByPoint(Me,e.rtcCenter,Ne),C.setTranslation(Me,Ne,Me),Me}),c}function de(e,t,n,r,i,a,o,s){var u,c=fe(e,t,n,s);l(e._depthFailAppearance)&&(u=fe(e,e._depthFailAppearance,e._depthFailAppearance.material,s));var f=r?O.TRANSLUCENT:O.OPAQUE,d=i?2:1;d*=l(e._depthFailAppearance)?2:1,a.length=e._va.length*d;for(var m=a.length,h=0,p=0;p<m;++p){var _;i&&(_=a[p],l(_)||(_=a[p]=new I({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[h],_.renderState=e._backFaceRS,_.shaderProgram=e._sp,_.uniformMap=c,_.pass=f,++p),_=a[p],l(_)||(_=a[p]=new I({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[h],_.renderState=e._frontFaceRS,_.shaderProgram=e._sp,_.uniformMap=c,_.pass=f,l(e._depthFailAppearance)&&(i&&(++p,_=a[p],l(_)||(_=a[p]=new I({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[h],_.renderState=e._backFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=u,_.pass=f),++p,_=a[p],l(_)||(_=a[p]=new I({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[h],_.renderState=e._frontFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=u,_.pass=f),++h}}function me(e,t,n,r,i,a,o,s){q._updateBoundingVolumes(e,t,i);var u;t.mode===V.SCENE3D?u=e._boundingSphereWC:t.mode===V.COLUMBUS_VIEW?u=e._boundingSphereCV:t.mode===V.SCENE2D&&l(e._boundingSphere2D)?u=e._boundingSphere2D:l(e._boundingSphereMorph)&&(u=e._boundingSphereMorph);var c=t.commandList,f=t.passes;if(f.render||f.pick){var d=e.allowPicking,m=k.castShadows(e.shadows),h=k.receiveShadows(e.shadows),p=n.length,_=s?2:1;_*=l(e._depthFailAppearance)?2:1;for(var v=0;v<p;++v){var g=Math.floor(v/_),y=n[v];y.modelMatrix=i,y.boundingVolume=u[g],y.cull=a,y.debugShowBoundingVolume=o,y.castShadows=m,y.receiveShadows=h,y.pickId=d?"v_pickColor":void 0,c.push(y)}}}function he(t,r,i){if(i===y.TOP){var a=e.clone(t,ze),o=e.clone(t,Fe);o.center=n.add(o.center,r,o.center),t=e.union(a,o,t)}else i===y.ALL&&(t.center=n.add(t.center,r,t.center));return t}function pe(e,t,n){return function(){var r=e.getBatchedAttribute(t,n),i=e.attributes[n],a=i.componentsPerAttribute,o=u.createTypedArray(i.componentDatatype,a);return l(r.constructor.pack)?r.constructor.pack(r,o,0):o[0]=r,o}}function _e(e,t,n,r,i){return function(a){var o=W(a);e.setBatchedAttribute(t,n,o),"offset"===i&&(r._recomputeBoundingSpheres=!0,r._batchTableOffsetsUpdated=!1)}}function ve(t,r,i){r.boundingSphere={get:function(){var a=t._instanceBoundingSpheres[i];if(l(a)){a=a.clone();var o=t.modelMatrix,s=r.offset;l(s)&&he(a,n.fromArray(s.get(),0,Le),t._offsetInstanceExtend[i]),l(o)&&(a=e.transform(a,o))}return a}},r.boundingSphereCV={get:function(){return t._instanceBoundingSpheresCV[i]}}}function ge(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}function ye(e,t,n,r){e._error=r,e._state=n,t.afterRender.push(function(){e._ready=e._state===G.COMPLETE||e._state===G.FAILED,l(r)?e._readyPromise.reject(r):e._readyPromise.resolve(e)})}f(q.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var Ee=new t,Te=new n,Ce=new r,Se=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;q._modifyShaderPosition=function(e,t,n){for(var r,i="",a="",o="";null!==(r=Se.exec(t));){var s=r[1],u="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==u&&(i+=u+";\n"),l(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),i+="uniform mat4 u_modifiedModelView;\n",a+="attribute vec4 position;\n",o+=u+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?o+=u+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(a+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",o+=u+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[i,a,t,o].join("\n")},q._appendShowToShader=function(e,t){if(!l(e._batchTableAttributeIndices.show))return t;return M.replaceMain(t,"czm_non_show_main")+"\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}"},q._updateColorAttribute=function(e,t,n){if(!l(e._batchTableAttributeIndices.color)&&!l(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;var r=t;return r=r.replace(/attribute\s+vec4\s+color;/g,""),r=n?r.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):r.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2")},q._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2")},q._appendOffsetToShader=function(e,t){if(!l(e._batchTableAttributeIndices.offset))return t;var n="attribute float batchId;\n";n+="attribute float applyOffset;";var r=t.replace(/attribute\s+float\s+batchId;/g,n),i="vec4 $1 = czm_computePosition();\n";return i+="    if (czm_sceneMode == czm_sceneMode3D)\n",i+="    {\n",i+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",i+="    }\n",i+="    else\n",i+="    {\n",i+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",i+="    }\n",r=r.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,i)},q._appendDistanceDisplayConditionToShader=function(e,t,n){if(!l(e._batchTableAttributeIndices.distanceDisplayCondition))return t;var r=M.replaceMain(t,"czm_non_distanceDisplayCondition_main"),i="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return i+=n?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",i+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}",r+"\n"+i};var Ae,xe=Math.max(p.hardwareConcurrency-1,1),we=new w("combineGeometry",Number.POSITIVE_INFINITY),Re=new h,be=new i,Ie=new n,Oe=new e,De=new n,Pe=new n,Me=new C,Ne=new n;q._updateBoundingVolumes=function(t,n,r,i){var a,o,s;if(i||!C.equals(r,t._modelMatrix))for(C.clone(r,t._modelMatrix),o=t._boundingSpheres.length,a=0;a<o;++a)s=t._boundingSpheres[a],l(s)&&(t._boundingSphereWC[a]=e.transform(s,r,t._boundingSphereWC[a]),n.scene3DOnly||(t._boundingSphere2D[a]=e.clone(t._boundingSphereCV[a],t._boundingSphere2D[a]),t._boundingSphere2D[a].center.x=0,t._boundingSphereMorph[a]=e.union(t._boundingSphereWC[a],t._boundingSphereCV[a])));var u=t.appearance.pixelSize;if(l(u))for(o=t._boundingSpheres.length,a=0;a<o;++a){s=t._boundingSpheres[a];var c=t._boundingSphereWC[a],f=n.camera.getPixelSize(s,n.context.drawingBufferWidth,n.context.drawingBufferHeight),d=f*u;c.radius=s.radius+d}},q.prototype.update=function(e){if(!(!l(this.geometryInstances)&&0===this._va.length||l(this.geometryInstances)&&T(this.geometryInstances)&&0===this.geometryInstances.length||!l(this.appearance)||e.mode!==V.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)){if(l(this._error))throw this._error;if(this._state!==G.FAILED){var t=e.context;if(l(this._batchTable)||Y(this,t),this._batchTable.attributes.length>0){if(0===b.maximumVertexTextureImageUnits)throw new A("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==G.COMPLETE&&this._state!==G.COMBINED&&(this.asynchronous?re(this,e):ie(this,e)),this._state===G.COMBINED&&(oe(this,e),se(this,e),ue(this,e)),this.show&&this._state===G.COMPLETE){this._batchTableOffsetsUpdated||se(this,e),this._recomputeBoundingSpheres&&ae(this,e);var n=this.appearance,r=n.material,i=!1,a=!1;this._appearance!==n?(this._appearance=n,this._material=r,i=!0,a=!0):this._material!==r&&(this._material=r,a=!0);var o=this.depthFailAppearance,s=l(o)?o.material:void 0;this._depthFailAppearance!==o?(this._depthFailAppearance=o,this._depthFailMaterial=s,i=!0,a=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,a=!0);var u=this._appearance.isTranslucent();this._translucent!==u&&(this._translucent=u,i=!0),l(this._material)&&this._material.update(t);var f=n.closed&&u;if(i){c(this._createRenderStatesFunction,ce)(this,t,n,f)}if(a){c(this._createShaderProgramFunction,le)(this,e,n)}if(i||a){c(this._createCommandsFunction,de)(this,n,r,u,f,this._colorCommands,this._pickCommands,e)}c(this._updateAndQueueCommandsFunction,me)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,f)}}}};var ze=new e,Fe=new e,Le=new n;return q.prototype.getGeometryInstanceAttributes=function(e){for(var t=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,i=r.length,a=0;a<i;++a){var o=(n+a)%i;if(e===r[o]){t=o;break}}if(-1!==t){var s=this._perInstanceAttributeCache[t];if(l(s))return s;var u=this._batchTable,c=this._batchTableAttributeIndices;s={};var d={};for(var m in c)if(c.hasOwnProperty(m)){var h=c[m];d[m]={get:pe(u,t,h)};var p=!0,_=this._readOnlyInstanceAttributes;if(p&&l(_)){i=_.length;for(var v=0;v<i;++v)if(m===_[v]){p=!1;break}}p&&(d[m].set=_e(u,t,h,this,m))}return ve(this,d,t),ge(this,d,t),f(s,d),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=s,s}},q.prototype.isDestroyed=function(){return!1},q.prototype.destroy=function(){var e,t;this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy();var n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;var r=this._pickIds;for(e=r.length,t=0;t<e;++t)r[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,d(this)},q}),define("Scene/GroundPolylinePrimitive",["../Core/ApproximateTerrainHeights","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryInstanceAttribute","../Core/GroundPolylineGeometry","../Core/isArray","../Shaders/PolylineShadowVolumeVS","../Shaders/PolylineShadowVolumeFS","../Shaders/PolylineShadowVolumeMorphVS","../Shaders/PolylineShadowVolumeMorphFS","../Renderer/DrawCommand","../Renderer/Pass","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../ThirdParty/when","./BlendingState","./CullFace","./PolylineColorAppearance","./PolylineMaterialAppearance","./Primitive","./SceneMode"],function(e,t,n,r,i,a,o,s,u,c,l,f,d,m,h,p,_,v,g,y,E,T,C,S,A,x,w){"use strict";function R(e){e=n(e,n.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;var t=e.appearance;r(t)||(t=new A),this.appearance=t,this.show=n(e.show,!0),this.debugShowBoundingVolume=n(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=n(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:n(e.interleave,!1),releaseGeometryInstances:n(e.releaseGeometryInstances,!0),allowPicking:n(e.allowPicking,!0),asynchronous:n(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1,this._readyPromise=E.defer(),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=v.fromCache({cull:{enabled:!0},blending:T.ALPHA_BLEND,depthMask:!1}),this._renderStateMorph=v.fromCache({cull:{enabled:!0,face:C.FRONT},depthTest:{enabled:!0},blending:T.ALPHA_BLEND,depthMask:!1})}function b(t,n,i){var a=n.context,o=t._primitive,s=o._attributeLocations,u=o._batchTable.getVertexShaderCallback()(f);u=x._appendShowToShader(o,u),u=x._appendDistanceDisplayConditionToShader(o,u),u=x._modifyShaderPosition(t,u,n.scene3DOnly);var c=o._batchTable.getVertexShaderCallback()(m);c=x._appendShowToShader(o,c),c=x._appendDistanceDisplayConditionToShader(o,c),c=x._modifyShaderPosition(t,c,n.scene3DOnly);var l=o._batchTable.getVertexShaderCallback()(d),p=["ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT","GLOBE_MINIMUM_ALTITUDE "+n.mapProjection.ellipsoid.minimumRadius.toFixed(1)],_="",v="";r(i.material)?(v=r(i.material)?i.material.shaderSource:"",-1!==v.search(/varying\s+float\s+v_polylineAngle;/g)&&p.push("ANGLE_VARYING"),-1!==v.search(/varying\s+float\s+v_width;/g)&&p.push("WIDTH_VARYING")):_="PER_INSTANCE_COLOR",p.push(_);var E=t.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",_]:[_],T=new y({defines:p,sources:[u]}),C=new y({defines:E,sources:[v,l]});t._sp=g.replaceCache({context:a,shaderProgram:o._sp,vertexShaderSource:T,fragmentShaderSource:C,attributeLocations:s});var S=a.shaderCache.getDerivedShaderProgram(t._sp,"2dColor");if(!r(S)){var A=new y({defines:p.concat(["COLUMBUS_VIEW_2D"]),sources:[u]});S=a.shaderCache.createDerivedShaderProgram(t._sp,"2dColor",{context:a,shaderProgram:t._sp2D,vertexShaderSource:A,fragmentShaderSource:C,attributeLocations:s})}t._sp2D=S;var w=a.shaderCache.getDerivedShaderProgram(t._sp,"MorphColor");if(!r(w)){var R=new y({defines:p.concat(["MAX_TERRAIN_HEIGHT "+e._defaultMaxTerrainHeight.toFixed(1)]),sources:[c]});l=o._batchTable.getVertexShaderCallback()(h);var b=new y({defines:E,sources:[v,l]});w=a.shaderCache.createDerivedShaderProgram(t._sp,"MorphColor",{context:a,shaderProgram:t._spMorph,vertexShaderSource:R,fragmentShaderSource:b,attributeLocations:s})}t._spMorph=w}function I(e,t,n,i,a,o){var s=e._primitive,u=s._va.length;a.length=u,o.length=u;var c,l,f=t instanceof S,d=f?{}:n._uniforms,m=s._batchTable.getUniformMapCallback()(d),h=_.TERRAIN_CLASSIFICATION;for(c=0;c<u;c++){var v=s._va[c];l=a[c],r(l)||(l=a[c]=new p({owner:e,primitiveType:s._primitiveType})),l.vertexArray=v,l.renderState=e._renderState,l.shaderProgram=e._sp,l.uniformMap=m,l.pass=h,l.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";var g=l.derivedCommands.color2D;r(g)||(g=p.shallowClone(l),l.derivedCommands.color2D=g),g.vertexArray=v,g.renderState=e._renderState,g.shaderProgram=e._sp2D,g.uniformMap=m,g.pass=h,g.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)",g=l.derivedCommands.colorMorph,r(g)||(g=p.shallowClone(l),l.derivedCommands.colorMorph=g),g.vertexArray=v,g.renderState=e._renderStateMorph,g.shaderProgram=e._spMorph,g.uniformMap=m,g.pass=h,g.pickId="czm_batchTable_pickColor(v_batchId)"}}function O(e,t,n,i,a,o,s){var u=e._primitive;x._updateBoundingVolumes(u,t,a);var c;t.mode===w.SCENE3D?c=u._boundingSphereWC:t.mode===w.COLUMBUS_VIEW?c=u._boundingSphereCV:t.mode===w.SCENE2D&&r(u._boundingSphere2D)?c=u._boundingSphere2D:r(u._boundingSphereMorph)&&(c=u._boundingSphereMorph);var l=t.commandList,f=t.passes;if(f.render||f.pick&&u.allowPicking)for(var d=n.length,m=0;m<d;++m){var h=n[m];t.mode===w.MORPHING&&h.shaderProgram!==e._spMorph?h=h.derivedCommands.colorMorph:t.mode!==w.SCENE3D&&h.shaderProgram!==e._sp2D&&(h=h.derivedCommands.color2D),h.modelMatrix=a,h.boundingVolume=c[m],h.cull=o,h.debugShowBoundingVolume=s,l.push(h)}}return i(R.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}}),R._initialized=!1,R._initPromise=void 0,R.initializeTerrainHeights=function(){var t=R._initPromise;return r(t)?t:(R._initPromise=e.initialize().then(function(){R._initialized=!0}),R._initPromise)},R.prototype.update=function(e){if(r(this._primitive)||r(this.geometryInstances)){if(!R._initialized)return void R.initializeTerrainHeights();var n,i=this,a=this._primitiveOptions;if(!r(this._primitive)){var f,d=l(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],m=d.length,h=new Array(m);for(n=0;n<m;++n)if(f=d[n].attributes,!r(f)||!r(f.color)){this._hasPerInstanceColors=!1;break}for(n=0;n<m;++n){var p=d[n];f={};var _=p.attributes;for(var v in _)_.hasOwnProperty(v)&&(f[v]=_[v]);r(f.width)||(f.width=new u({componentDatatype:t.UNSIGNED_BYTE,componentsPerAttribute:1,value:[p.geometry.width]})),p.geometry._scene3DOnly=e.scene3DOnly,c.setProjectionAndEllipsoid(p.geometry,e.mapProjection),h[n]=new s({geometry:p.geometry,attributes:f,id:p.id})}a.geometryInstances=h,a.appearance=this.appearance,a._createShaderProgramFunction=function(e,t,n){b(i,t,n)},a._createCommandsFunction=function(e,t,n,r,a,o,s){
I(i,t,n,r,o,s)},a._updateAndQueueCommandsFunction=function(e,t,n,r,a,o,s,u){O(i,t,n,r,a,o,s)},this._primitive=new x(a),this._primitive.readyPromise.then(function(e){i._ready=!0,i.releaseGeometryInstances&&(i.geometryInstances=void 0);var t=e._error;r(t)?i._readyPromise.reject(t):i._readyPromise.resolve(i)})}if(this.appearance instanceof S&&!this._hasPerInstanceColors)throw new o("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}},R.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},R.isSupported=function(e){return e.frameState.context.depthTexture},R.prototype.isDestroyed=function(){return!1},R.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,a(this)},R}),define("Workers/createGroundPolylineGeometry",["../Core/defined","../Core/GroundPolylineGeometry","../Scene/GroundPolylinePrimitive"],function(e,t,n){"use strict";function r(r,i){return n.initializeTerrainHeights().then(function(){return e(i)&&(r=t.unpack(r,i)),t.createGeometry(r)})}return r})}();